<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Team: Zakari, Kimia, Law &amp; Sukhman" />


<title>Sports Betting Analysis</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />
<!-- Gambling Themed Favicon (Slot Machine Emoji) -->
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŽ°</text></svg>">

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Slot Machine</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="home.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="data.html">Data Processing</a>
</li>
<li>
  <a href="analysis.html">Analysis</a>
</li>
<li>
  <a href="flexdashboard.html">Shiny</a>
</li>
<li>
  <a href="report.html">Project Report</a>
</li>
<li>
  <a href="about.html">About Us</a>
</li>
<li>
  <a href="https://github.com/zakbillo/sports-betting">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Sports Betting Analysis</h1>
<h4 class="author">Team: Zakari, Kimia, Law &amp; Sukhman</h4>
<h4 class="date">2025 Data Science I (P8105)</h4>

</div>


<style type="text/css">
/* General styling for website compatibility */
body {
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
h1, h2, h3 {
color: #2c3e50;
font-weight: 600;
}
.main-container {
max-width: 1500px;
margin-left: auto;
margin-right: auto;
}
</style>
<div id="exploratory-data-analysis" class="section level1">
<h1>Exploratory Data Analysis</h1>
<div id="import-data" class="section level2">
<h2>Import Data</h2>
<pre class="r"><code>total_state_revenue = read_csv(&quot;data/total_state_revenue.csv&quot;)
model_clean_2024 = read_csv(&quot;data/model_clean_2024.csv&quot;)
demographics_2024 = read_csv(&quot;data/demographics_2024.csv&quot;)

# Pre-calculate yearly revenue summary for the Revenue by Year plot
yearly_revenue_summary = total_state_revenue |&gt; 
  group_by(Year) |&gt; 
  summarize(Total_Revenue = sum(Revenue, na.rm = TRUE))

# Pre-calculate data for Growth by State plot
top_states = total_state_revenue |&gt; 
  filter(Year == 2024) |&gt; 
  slice_max(Revenue, n = 5) |&gt; 
  pull(State)

state_growth_plot_data = total_state_revenue |&gt; 
  mutate(
    State_Group = ifelse(State %in% top_states, State, &quot;All Other&quot;)
  ) |&gt; 
  group_by(Year, State_Group) |&gt; 
  summarize(Revenue = sum(Revenue, na.rm = TRUE), .groups = &quot;drop&quot;) |&gt; 
  mutate(State_Group = fct_reorder(State_Group, Revenue, .desc = TRUE))</code></pre>
</div>
</div>
<div id="gambling-visuals" class="section level1 tabset">
<h1 class="tabset">Gambling Visuals</h1>
<div id="revenue-by-year" class="section level2">
<h2>Revenue by Year</h2>
<pre class="r"><code># Plotly bar chart showing total revenue by year
plot_ly(
  data = yearly_revenue_summary |&gt; mutate(Year = as.factor(Year)),
  x = ~Year,
  y = ~Total_Revenue, 
  type = &quot;bar&quot;, 
  color = ~Year,
  # Use dollar format for text labels
  text = ~scales::dollar(Total_Revenue / 1e9, accuracy = 0.01, suffix = &quot;B&quot;),
  textposition = &quot;outside&quot;,
  hoverinfo = &quot;x+y+text&quot;
) |&gt; 
  layout(
    title = &quot;Total US Gambling Revenue (2018-2024)&quot;,
    xaxis = list(
      title = &quot;Year&quot;
    ),
    yaxis = list(
      title = &quot;Total Revenue&quot;,
      tickformat = &quot;$,&quot;
    ),
    showlegend = FALSE
  )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-0a0f0dc27d37f1963fc9" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-0a0f0dc27d37f1963fc9">{"x":{"visdat":{"26044c57b515":["function () ","plotlyVisDat"]},"cur_data":"26044c57b515","attrs":{"26044c57b515":{"x":{},"y":{},"text":{},"textposition":"outside","hoverinfo":"x+y+text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total US Gambling Revenue (2018-2024)","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2018","2019","2020","2021","2022","2023","2024"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Total Revenue","tickformat":"$,"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2018"],"y":[112745560],"text":"$0.11B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2018","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019"],"y":[558594169],"text":"$0.56B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2019","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020"],"y":[1541789027],"text":"$1.54B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2020","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2021"],"y":[4291686811],"text":"$4.29B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2021","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2022"],"y":[7603794087],"text":"$7.60B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2022","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2023"],"y":[11121558986],"text":"$11.12B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2023","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2024"],"y":[13924115452],"text":"$13.92B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2024","marker":{"color":"rgba(229,196,148,1)","line":{"color":"rgba(229,196,148,1)"}},"textfont":{"color":"rgba(229,196,148,1)"},"error_y":{"color":"rgba(229,196,148,1)"},"error_x":{"color":"rgba(229,196,148,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="growth-by-state" class="section level2">
<h2>Growth by State</h2>
<pre class="r"><code># Plotly stacked bar chart showing revenue growth by state over time
state_growth_plot_data |&gt; 
  plot_ly(
    x = ~Year,
    y = ~Revenue, 
    type = &quot;bar&quot;, 
    color = ~State_Group,
    text = ~scales::dollar(Revenue),
    hoverinfo = &quot;x+y+text&quot;
  ) |&gt; 
  layout(
    title = &quot;US Gambling Revenue Growth by State&quot;,
    xaxis = list(
      title = &quot;Year&quot;,
      tickvals = 2018:2024
    ),
    yaxis = list(
      title = &quot;Revenue&quot;,
      tickformat = &quot;$,&quot;
    ),
    barmode = &quot;stack&quot;,
    showlegend = TRUE 
  )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-1df763acd5c66e2f2ec3" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-1df763acd5c66e2f2ec3">{"x":{"visdat":{"26042fb4ef19":["function () ","plotlyVisDat"]},"cur_data":"26042fb4ef19","attrs":{"26042fb4ef19":{"x":{},"y":{},"text":{},"hoverinfo":"x+y+text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"US Gambling Revenue Growth by State","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","tickvals":[2018,2019,2020,2021,2022,2023,2024]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Revenue","tickformat":"$,"},"barmode":"stack","showlegend":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[16206578,147469423,679812733,2160290082,3668429838,5267109657,7220936855],"text":["$16,206,578","$147,469,423","$679,812,733","$2,160,290,082","$3,668,429,838","$5,267,109,657","$7,220,936,855"],"hoverinfo":["x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text"],"type":"bar","name":"All Other","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[0,0,193841046,810891340,1215977220,1535383261,1866642282],"text":["$0","$0","$193,841,046","$810,891,340","$1,215,977,220","$1,535,383,261","$1,866,642,282"],"hoverinfo":["x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text"],"type":"bar","name":"Illinois","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[94022393,299398035,398231302,814981641,762954971,1006681602,1094630610],"text":["$94,022,393","$299,398,035","$398,231,302","$814,981,641","$762,954,971","$1,006,681,602","$1,094,630,610"],"hoverinfo":["x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text"],"type":"bar","name":"New Jersey","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[2516589,111726711,269903946,505523748,597364960,686915514,778420570],"text":["$2,516,589","$111,726,711","$269,903,946","$505,523,748","$597,364,960","$686,915,514","$778,420,570"],"hoverinfo":["x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text"],"type":"bar","name":"Pennsylvania","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[0,0,0,0,1359067098,1689883800,2059297238],"text":["$0","$0","$0","$0","$1,359,067,098","$1,689,883,800","$2,059,297,238"],"hoverinfo":["x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text"],"type":"bar","name":"New York","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[0,0,0,0,0,935585152,904187897],"text":["$0","$0","$0","$0","$0","$935,585,152","$904,187,897"],"hoverinfo":["x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text"],"type":"bar","name":"Ohio","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="market-rank-shifts" class="section level2">
<h2>Market Rank Shifts</h2>
<pre class="r"><code># Plotly bar chart showing 2024 Revenue by State, ranked by Revenue (descending)
revenue_2024 = total_state_revenue |&gt; 
  filter(Year == 2024, Revenue &gt; 0) |&gt;
  mutate(
    State = fct_reorder(State, Revenue, .desc = TRUE),
    Rank = min_rank(desc(Revenue))
  )

ordered_states = as.character(revenue_2024$State)

revenue_2024 |&gt; 
  plot_ly(
    x = ~State,
    y = ~Revenue, 
    type = &quot;bar&quot;, 
    color = ~State,
    text = ~paste0(&quot;Rank &quot;, Rank, &quot;: &quot;, scales::dollar(Revenue, accuracy = 0.01)),
    hoverinfo = &quot;text&quot;
  ) |&gt; 
  layout(
    title = &quot;Gambling Revenue and Market Rank (2024)&quot;,
    xaxis = list(
      title = &quot;State (Ranked by Revenue)&quot;,
      tickangle = 90,        
      tickmode = &quot;array&quot;,           
      tickvals = ordered_states,  
      ticktext = ordered_states
      ),
    yaxis = list(
      title = &quot;Revenue&quot;,
      tickformat = &quot;$,&quot;
    ),
    showlegend = FALSE
  )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-8cc0b9d133189c99d5d2" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-8cc0b9d133189c99d5d2">{"x":{"visdat":{"26046feea09d":["function () ","plotlyVisDat"]},"cur_data":"26046feea09d","attrs":{"26046feea09d":{"x":{},"y":{},"text":{},"hoverinfo":"text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Gambling Revenue and Market Rank (2024)","xaxis":{"domain":[0,1],"automargin":true,"title":"State (Ranked by Revenue)","tickangle":90,"tickmode":"array","tickvals":["Arizona","Arkansas","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","Washington D.C.","West Virginia","Wyoming"],"ticktext":["Arizona","Arkansas","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","Washington D.C.","West Virginia","Wyoming"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Revenue","tickformat":"$,"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["New York"],"y":[2059297238],"text":"Rank 1: $2,059,297,238.00","hoverinfo":"text","type":"bar","name":"New York","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Illinois"],"y":[1866642282],"text":"Rank 2: $1,866,642,282.00","hoverinfo":"text","type":"bar","name":"Illinois","marker":{"color":"rgba(149,185,151,1)","line":{"color":"rgba(149,185,151,1)"}},"textfont":{"color":"rgba(149,185,151,1)"},"error_y":{"color":"rgba(149,185,151,1)"},"error_x":{"color":"rgba(149,185,151,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Jersey"],"y":[1094630610],"text":"Rank 3: $1,094,630,610.00","hoverinfo":"text","type":"bar","name":"New Jersey","marker":{"color":"rgba(183,175,136,1)","line":{"color":"rgba(183,175,136,1)"}},"textfont":{"color":"rgba(183,175,136,1)"},"error_y":{"color":"rgba(183,175,136,1)"},"error_x":{"color":"rgba(183,175,136,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Ohio"],"y":[904187897],"text":"Rank 4: $904,187,897.00","hoverinfo":"text","type":"bar","name":"Ohio","marker":{"color":"rgba(211,164,122,1)","line":{"color":"rgba(211,164,122,1)"}},"textfont":{"color":"rgba(211,164,122,1)"},"error_y":{"color":"rgba(211,164,122,1)"},"error_x":{"color":"rgba(211,164,122,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Pennsylvania"],"y":[778420570],"text":"Rank 5: $778,420,570.00","hoverinfo":"text","type":"bar","name":"Pennsylvania","marker":{"color":"rgba(236,151,108,1)","line":{"color":"rgba(236,151,108,1)"}},"textfont":{"color":"rgba(236,151,108,1)"},"error_y":{"color":"rgba(236,151,108,1)"},"error_x":{"color":"rgba(236,151,108,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Massachusetts"],"y":[670694019],"text":"Rank 6: $670,694,019.00","hoverinfo":"text","type":"bar","name":"Massachusetts","marker":{"color":"rgba(247,142,105,1)","line":{"color":"rgba(247,142,105,1)"}},"textfont":{"color":"rgba(247,142,105,1)"},"error_y":{"color":"rgba(247,142,105,1)"},"error_x":{"color":"rgba(247,142,105,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maryland"],"y":[629812059],"text":"Rank 7: $629,812,059.00","hoverinfo":"text","type":"bar","name":"Maryland","marker":{"color":"rgba(229,147,127,1)","line":{"color":"rgba(229,147,127,1)"}},"textfont":{"color":"rgba(229,147,127,1)"},"error_y":{"color":"rgba(229,147,127,1)"},"error_x":{"color":"rgba(229,147,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Virginia"],"y":[615044067],"text":"Rank 8: $615,044,067.00","hoverinfo":"text","type":"bar","name":"Virginia","marker":{"color":"rgba(209,151,149,1)","line":{"color":"rgba(209,151,149,1)"}},"textfont":{"color":"rgba(209,151,149,1)"},"error_y":{"color":"rgba(209,151,149,1)"},"error_x":{"color":"rgba(209,151,149,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["North Carolina"],"y":[583645811],"text":"Rank 9: $583,645,811.00","hoverinfo":"text","type":"bar","name":"North Carolina","marker":{"color":"rgba(185,155,171,1)","line":{"color":"rgba(185,155,171,1)"}},"textfont":{"color":"rgba(185,155,171,1)"},"error_y":{"color":"rgba(185,155,171,1)"},"error_x":{"color":"rgba(185,155,171,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Tennessee"],"y":[485802815],"text":"Rank 10: $485,802,815.00","hoverinfo":"text","type":"bar","name":"Tennessee","marker":{"color":"rgba(156,159,194,1)","line":{"color":"rgba(156,159,194,1)"}},"textfont":{"color":"rgba(156,159,194,1)"},"error_y":{"color":"rgba(156,159,194,1)"},"error_x":{"color":"rgba(156,159,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Indiana"],"y":[484278308],"text":"Rank 11: $484,278,308.00","hoverinfo":"text","type":"bar","name":"Indiana","marker":{"color":"rgba(154,158,202,1)","line":{"color":"rgba(154,158,202,1)"}},"textfont":{"color":"rgba(154,158,202,1)"},"error_y":{"color":"rgba(154,158,202,1)"},"error_x":{"color":"rgba(154,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nevada"],"y":[482121000],"text":"Rank 12: $482,121,000.00","hoverinfo":"text","type":"bar","name":"Nevada","marker":{"color":"rgba(175,154,200,1)","line":{"color":"rgba(175,154,200,1)"}},"textfont":{"color":"rgba(175,154,200,1)"},"error_y":{"color":"rgba(175,154,200,1)"},"error_x":{"color":"rgba(175,154,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Michigan"],"y":[481495654],"text":"Rank 13: $481,495,654.00","hoverinfo":"text","type":"bar","name":"Michigan","marker":{"color":"rgba(194,150,199,1)","line":{"color":"rgba(194,150,199,1)"}},"textfont":{"color":"rgba(194,150,199,1)"},"error_y":{"color":"rgba(194,150,199,1)"},"error_x":{"color":"rgba(194,150,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Colorado"],"y":[475176731],"text":"Rank 14: $475,176,731.00","hoverinfo":"text","type":"bar","name":"Colorado","marker":{"color":"rgba(212,145,197,1)","line":{"color":"rgba(212,145,197,1)"}},"textfont":{"color":"rgba(212,145,197,1)"},"error_y":{"color":"rgba(212,145,197,1)"},"error_x":{"color":"rgba(212,145,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Louisiana"],"y":[461224426],"text":"Rank 15: $461,224,426.00","hoverinfo":"text","type":"bar","name":"Louisiana","marker":{"color":"rgba(229,139,195,1)","line":{"color":"rgba(229,139,195,1)"}},"textfont":{"color":"rgba(229,139,195,1)"},"error_y":{"color":"rgba(229,139,195,1)"},"error_x":{"color":"rgba(229,139,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Arizona"],"y":[427397087],"text":"Rank 16: $427,397,087.00","hoverinfo":"text","type":"bar","name":"Arizona","marker":{"color":"rgba(223,155,177,1)","line":{"color":"rgba(223,155,177,1)"}},"textfont":{"color":"rgba(223,155,177,1)"},"error_y":{"color":"rgba(223,155,177,1)"},"error_x":{"color":"rgba(223,155,177,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kentucky"],"y":[272086697],"text":"Rank 17: $272,086,697.00","hoverinfo":"text","type":"bar","name":"Kentucky","marker":{"color":"rgba(212,172,155,1)","line":{"color":"rgba(212,172,155,1)"}},"textfont":{"color":"rgba(212,172,155,1)"},"error_y":{"color":"rgba(212,172,155,1)"},"error_x":{"color":"rgba(212,172,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Iowa"],"y":[218482781],"text":"Rank 18: $218,482,781.00","hoverinfo":"text","type":"bar","name":"Iowa","marker":{"color":"rgba(198,188,132,1)","line":{"color":"rgba(198,188,132,1)"}},"textfont":{"color":"rgba(198,188,132,1)"},"error_y":{"color":"rgba(198,188,132,1)"},"error_x":{"color":"rgba(198,188,132,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Connecticut"],"y":[187349516],"text":"Rank 19: $187,349,516.00","hoverinfo":"text","type":"bar","name":"Connecticut","marker":{"color":"rgba(182,204,108,1)","line":{"color":"rgba(182,204,108,1)"}},"textfont":{"color":"rgba(182,204,108,1)"},"error_y":{"color":"rgba(182,204,108,1)"},"error_x":{"color":"rgba(182,204,108,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kansas"],"y":[145263244],"text":"Rank 20: $145,263,244.00","hoverinfo":"text","type":"bar","name":"Kansas","marker":{"color":"rgba(169,216,83,1)","line":{"color":"rgba(169,216,83,1)"}},"textfont":{"color":"rgba(169,216,83,1)"},"error_y":{"color":"rgba(169,216,83,1)"},"error_x":{"color":"rgba(169,216,83,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Arkansas"],"y":[107275202],"text":"Rank 21: $107,275,202.00","hoverinfo":"text","type":"bar","name":"Arkansas","marker":{"color":"rgba(190,217,76,1)","line":{"color":"rgba(190,217,76,1)"}},"textfont":{"color":"rgba(190,217,76,1)"},"error_y":{"color":"rgba(190,217,76,1)"},"error_x":{"color":"rgba(190,217,76,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Oregon"],"y":[80932000],"text":"Rank 22: $80,932,000.00","hoverinfo":"text","type":"bar","name":"Oregon","marker":{"color":"rgba(209,217,69,1)","line":{"color":"rgba(209,217,69,1)"}},"textfont":{"color":"rgba(209,217,69,1)"},"error_y":{"color":"rgba(209,217,69,1)"},"error_x":{"color":"rgba(209,217,69,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Hampshire"],"y":[78996303],"text":"Rank 23: $78,996,303.00","hoverinfo":"text","type":"bar","name":"New Hampshire","marker":{"color":"rgba(227,217,62,1)","line":{"color":"rgba(227,217,62,1)"}},"textfont":{"color":"rgba(227,217,62,1)"},"error_y":{"color":"rgba(227,217,62,1)"},"error_x":{"color":"rgba(227,217,62,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["West Virginia"],"y":[65866101],"text":"Rank 24: $65,866,101.00","hoverinfo":"text","type":"bar","name":"West Virginia","marker":{"color":"rgba(245,217,53,1)","line":{"color":"rgba(245,217,53,1)"}},"textfont":{"color":"rgba(245,217,53,1)"},"error_y":{"color":"rgba(245,217,53,1)"},"error_x":{"color":"rgba(245,217,53,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maine"],"y":[55388488],"text":"Rank 25: $55,388,488.00","hoverinfo":"text","type":"bar","name":"Maine","marker":{"color":"rgba(253,215,61,1)","line":{"color":"rgba(253,215,61,1)"}},"textfont":{"color":"rgba(253,215,61,1)"},"error_y":{"color":"rgba(253,215,61,1)"},"error_x":{"color":"rgba(253,215,61,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Washington D.C."],"y":[53717642],"text":"Rank 26: $53,717,642.00","hoverinfo":"text","type":"bar","name":"Washington D.C.","marker":{"color":"rgba(248,210,86,1)","line":{"color":"rgba(248,210,86,1)"}},"textfont":{"color":"rgba(248,210,86,1)"},"error_y":{"color":"rgba(248,210,86,1)"},"error_x":{"color":"rgba(248,210,86,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mississippi"],"y":[43344188],"text":"Rank 27: $43,344,188.00","hoverinfo":"text","type":"bar","name":"Mississippi","marker":{"color":"rgba(243,206,107,1)","line":{"color":"rgba(243,206,107,1)"}},"textfont":{"color":"rgba(243,206,107,1)"},"error_y":{"color":"rgba(243,206,107,1)"},"error_x":{"color":"rgba(243,206,107,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Rhode Island"],"y":[38051914],"text":"Rank 28: $38,051,914.00","hoverinfo":"text","type":"bar","name":"Rhode Island","marker":{"color":"rgba(237,202,125,1)","line":{"color":"rgba(237,202,125,1)"}},"textfont":{"color":"rgba(237,202,125,1)"},"error_y":{"color":"rgba(237,202,125,1)"},"error_x":{"color":"rgba(237,202,125,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Vermont"],"y":[27347988],"text":"Rank 29: $27,347,988.00","hoverinfo":"text","type":"bar","name":"Vermont","marker":{"color":"rgba(231,197,143,1)","line":{"color":"rgba(231,197,143,1)"}},"textfont":{"color":"rgba(231,197,143,1)"},"error_y":{"color":"rgba(231,197,143,1)"},"error_x":{"color":"rgba(231,197,143,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Wyoming"],"y":[22810652],"text":"Rank 30: $22,810,652.00","hoverinfo":"text","type":"bar","name":"Wyoming","marker":{"color":"rgba(222,193,153,1)","line":{"color":"rgba(222,193,153,1)"}},"textfont":{"color":"rgba(222,193,153,1)"},"error_y":{"color":"rgba(222,193,153,1)"},"error_x":{"color":"rgba(222,193,153,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Delaware"],"y":[14585100],"text":"Rank 31: $14,585,100.00","hoverinfo":"text","type":"bar","name":"Delaware","marker":{"color":"rgba(212,190,160,1)","line":{"color":"rgba(212,190,160,1)"}},"textfont":{"color":"rgba(212,190,160,1)"},"error_y":{"color":"rgba(212,190,160,1)"},"error_x":{"color":"rgba(212,190,160,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montana"],"y":[7186894],"text":"Rank 32: $7,186,894.00","hoverinfo":"text","type":"bar","name":"Montana","marker":{"color":"rgba(201,186,166,1)","line":{"color":"rgba(201,186,166,1)"}},"textfont":{"color":"rgba(201,186,166,1)"},"error_y":{"color":"rgba(201,186,166,1)"},"error_x":{"color":"rgba(201,186,166,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nebraska"],"y":[4639250],"text":"Rank 33: $4,639,250.00","hoverinfo":"text","type":"bar","name":"Nebraska","marker":{"color":"rgba(190,183,173,1)","line":{"color":"rgba(190,183,173,1)"}},"textfont":{"color":"rgba(190,183,173,1)"},"error_y":{"color":"rgba(190,183,173,1)"},"error_x":{"color":"rgba(190,183,173,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["South Dakota"],"y":[920918],"text":"Rank 34: $920,918.00","hoverinfo":"text","type":"bar","name":"South Dakota","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="demographic-visuals" class="section level1 tabset">
<h1 class="tabset">Demographic Visuals</h1>
<div id="population" class="section level2">
<h2>Population</h2>
<pre class="r"><code># Order by Revenue (descending), not population
population_plot_data = 
  model_clean_2024 |&gt; 
  filter(State != &quot;Washington D.C.&quot;) |&gt; 
    mutate(
      State = as.factor(State),
      State = fct_reorder(State, Revenue, .desc = TRUE) # Ordering by Revenue
    )

ordered_states = as.character(population_plot_data$State)

population_plot = 
  population_plot_data |&gt; 
  plot_ly(
    x = ~State,
    y = ~total_pop, 
    type = &quot;bar&quot;, 
    color = ~State,
    text = ~scales::comma(total_pop),
    textposition = &quot;outside&quot;,
    hoverinfo = &quot;x+y+text&quot;
    ) |&gt; 
  layout(
    title = &quot;Total Population by State (2024)&quot;,
    xaxis = list(
      title = &quot;State (sorted by descending 2024 Revenue)&quot;,
      tickangle = 90,        
      tickmode = &quot;array&quot;,           
      tickvals = ordered_states,  
      ticktext = ordered_states
      ),
    yaxis = list(
      title = &quot;Total Population&quot;
    ),
    showlegend = FALSE
  )

population_plot</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-906cd43fbaaaf7f0b4b4" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-906cd43fbaaaf7f0b4b4">{"x":{"visdat":{"260439fe37db":["function () ","plotlyVisDat"]},"cur_data":"260439fe37db","attrs":{"260439fe37db":{"x":{},"y":{},"text":{},"textposition":"outside","hoverinfo":"x+y+text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total Population by State (2024)","xaxis":{"domain":[0,1],"automargin":true,"title":"State (sorted by descending 2024 Revenue)","tickangle":90,"tickmode":"array","tickvals":["Arizona","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","West Virginia","Wyoming"],"ticktext":["Arizona","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","West Virginia","Wyoming"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Total Population"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["New York"],"y":[19867248],"text":"19,867,248","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New York","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Illinois"],"y":[12710158],"text":"12,710,158","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Illinois","marker":{"color":"rgba(153,184,149,1)","line":{"color":"rgba(153,184,149,1)"}},"textfont":{"color":"rgba(153,184,149,1)"},"error_y":{"color":"rgba(153,184,149,1)"},"error_x":{"color":"rgba(153,184,149,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Jersey"],"y":[9500851],"text":"9,500,851","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Jersey","marker":{"color":"rgba(189,173,133,1)","line":{"color":"rgba(189,173,133,1)"}},"textfont":{"color":"rgba(189,173,133,1)"},"error_y":{"color":"rgba(189,173,133,1)"},"error_x":{"color":"rgba(189,173,133,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Ohio"],"y":[11883304],"text":"11,883,304","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Ohio","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Pennsylvania"],"y":[13078751],"text":"13,078,751","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Pennsylvania","marker":{"color":"rgba(245,146,102,1)","line":{"color":"rgba(245,146,102,1)"}},"textfont":{"color":"rgba(245,146,102,1)"},"error_y":{"color":"rgba(245,146,102,1)"},"error_x":{"color":"rgba(245,146,102,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Massachusetts"],"y":[7136171],"text":"7,136,171","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Massachusetts","marker":{"color":"rgba(238,145,116,1)","line":{"color":"rgba(238,145,116,1)"}},"textfont":{"color":"rgba(238,145,116,1)"},"error_y":{"color":"rgba(238,145,116,1)"},"error_x":{"color":"rgba(238,145,116,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maryland"],"y":[6263220],"text":"6,263,220","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maryland","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Virginia"],"y":[8811195],"text":"8,811,195","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Virginia","marker":{"color":"rgba(193,154,165,1)","line":{"color":"rgba(193,154,165,1)"}},"textfont":{"color":"rgba(193,154,165,1)"},"error_y":{"color":"rgba(193,154,165,1)"},"error_x":{"color":"rgba(193,154,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["North Carolina"],"y":[11046024],"text":"11,046,024","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"North Carolina","marker":{"color":"rgba(162,158,189,1)","line":{"color":"rgba(162,158,189,1)"}},"textfont":{"color":"rgba(162,158,189,1)"},"error_y":{"color":"rgba(162,158,189,1)"},"error_x":{"color":"rgba(162,158,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Tennessee"],"y":[7227750],"text":"7,227,750","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Tennessee","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Indiana"],"y":[6924275],"text":"6,924,275","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Indiana","marker":{"color":"rgba(175,154,200,1)","line":{"color":"rgba(175,154,200,1)"}},"textfont":{"color":"rgba(175,154,200,1)"},"error_y":{"color":"rgba(175,154,200,1)"},"error_x":{"color":"rgba(175,154,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nevada"],"y":[3267467],"text":"3,267,467","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Nevada","marker":{"color":"rgba(196,149,198,1)","line":{"color":"rgba(196,149,198,1)"}},"textfont":{"color":"rgba(196,149,198,1)"},"error_y":{"color":"rgba(196,149,198,1)"},"error_x":{"color":"rgba(196,149,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Michigan"],"y":[10140459],"text":"10,140,459","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Michigan","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Colorado"],"y":[5957494],"text":"5,957,494","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Colorado","marker":{"color":"rgba(230,141,192,1)","line":{"color":"rgba(230,141,192,1)"}},"textfont":{"color":"rgba(230,141,192,1)"},"error_y":{"color":"rgba(230,141,192,1)"},"error_x":{"color":"rgba(230,141,192,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Louisiana"],"y":[4597740],"text":"4,597,740","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Louisiana","marker":{"color":"rgba(219,162,168,1)","line":{"color":"rgba(219,162,168,1)"}},"textfont":{"color":"rgba(219,162,168,1)"},"error_y":{"color":"rgba(219,162,168,1)"},"error_x":{"color":"rgba(219,162,168,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Arizona"],"y":[7582384],"text":"7,582,384","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Arizona","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kentucky"],"y":[4588372],"text":"4,588,372","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kentucky","marker":{"color":"rgba(189,198,118,1)","line":{"color":"rgba(189,198,118,1)"}},"textfont":{"color":"rgba(189,198,118,1)"},"error_y":{"color":"rgba(189,198,118,1)"},"error_x":{"color":"rgba(189,198,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Iowa"],"y":[3241488],"text":"3,241,488","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Iowa","marker":{"color":"rgba(169,214,89,1)","line":{"color":"rgba(169,214,89,1)"}},"textfont":{"color":"rgba(169,214,89,1)"},"error_y":{"color":"rgba(169,214,89,1)"},"error_x":{"color":"rgba(169,214,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Connecticut"],"y":[3675069],"text":"3,675,069","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Connecticut","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kansas"],"y":[2970606],"text":"2,970,606","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kansas","marker":{"color":"rgba(207,217,70,1)","line":{"color":"rgba(207,217,70,1)"}},"textfont":{"color":"rgba(207,217,70,1)"},"error_y":{"color":"rgba(207,217,70,1)"},"error_x":{"color":"rgba(207,217,70,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Oregon"],"y":[4272371],"text":"4,272,371","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Oregon","marker":{"color":"rgba(227,217,62,1)","line":{"color":"rgba(227,217,62,1)"}},"textfont":{"color":"rgba(227,217,62,1)"},"error_y":{"color":"rgba(227,217,62,1)"},"error_x":{"color":"rgba(227,217,62,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Hampshire"],"y":[1409032],"text":"1,409,032","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Hampshire","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["West Virginia"],"y":[1769979],"text":"1,769,979","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"West Virginia","marker":{"color":"rgba(252,214,66,1)","line":{"color":"rgba(252,214,66,1)"}},"textfont":{"color":"rgba(252,214,66,1)"},"error_y":{"color":"rgba(252,214,66,1)"},"error_x":{"color":"rgba(252,214,66,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maine"],"y":[1405012],"text":"1,405,012","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maine","marker":{"color":"rgba(247,209,92,1)","line":{"color":"rgba(247,209,92,1)"}},"textfont":{"color":"rgba(247,209,92,1)"},"error_y":{"color":"rgba(247,209,92,1)"},"error_x":{"color":"rgba(247,209,92,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mississippi"],"y":[2943045],"text":"2,943,045","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Mississippi","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Rhode Island"],"y":[1112308],"text":"1,112,308","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Rhode Island","marker":{"color":"rgba(234,199,134,1)","line":{"color":"rgba(234,199,134,1)"}},"textfont":{"color":"rgba(234,199,134,1)"},"error_y":{"color":"rgba(234,199,134,1)"},"error_x":{"color":"rgba(234,199,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Vermont"],"y":[648493],"text":"648,493","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Vermont","marker":{"color":"rgba(226,195,150,1)","line":{"color":"rgba(226,195,150,1)"}},"textfont":{"color":"rgba(226,195,150,1)"},"error_y":{"color":"rgba(226,195,150,1)"},"error_x":{"color":"rgba(226,195,150,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Wyoming"],"y":[587618],"text":"587,618","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Wyoming","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Delaware"],"y":[1051917],"text":"1,051,917","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Delaware","marker":{"color":"rgba(204,187,165,1)","line":{"color":"rgba(204,187,165,1)"}},"textfont":{"color":"rgba(204,187,165,1)"},"error_y":{"color":"rgba(204,187,165,1)"},"error_x":{"color":"rgba(204,187,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montana"],"y":[1137233],"text":"1,137,233","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Montana","marker":{"color":"rgba(192,183,172,1)","line":{"color":"rgba(192,183,172,1)"}},"textfont":{"color":"rgba(192,183,172,1)"},"error_y":{"color":"rgba(192,183,172,1)"},"error_x":{"color":"rgba(192,183,172,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["South Dakota"],"y":[924669],"text":"924,669","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"South Dakota","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="revenue" class="section level2">
<h2>Revenue</h2>
<pre class="r"><code># Order by Revenue (descending), not population
revenue_plot_data = 
  model_clean_2024 |&gt; 
  filter(State != &quot;Washington D.C.&quot;) |&gt; 
    mutate(
      State = as.factor(State),
      State = fct_reorder(State, Revenue, .desc = TRUE) # Ordering by Revenue
    )

ordered_states = as.character(revenue_plot_data$State)

revenue_plot = 
  revenue_plot_data |&gt; 
  plot_ly(
    x = ~State,
    y = ~Revenue, 
    type = &quot;bar&quot;, 
    color = ~State,
    text = ~scales::dollar(Revenue),
    textposition = &quot;outside&quot;,
    hoverinfo = &quot;x+y+text&quot;
    ) |&gt; 
  layout(
    title = &quot;Gambling Revenue by State (2024)&quot;,
    xaxis = list(
      title = &quot;State (sorted by descending 2024 Revenue)&quot;,
      tickangle = 90,        
      tickmode = &quot;array&quot;,           
      tickvals = ordered_states,  
      ticktext = ordered_states
      ),
    yaxis = list(
      title = &quot;Revenue&quot;,
      tickformat = &quot;$,&quot;
    ),
    showlegend = FALSE
  )

revenue_plot</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-cdd1fdb5e68dc22ed6cd" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-cdd1fdb5e68dc22ed6cd">{"x":{"visdat":{"26042f635e4b":["function () ","plotlyVisDat"]},"cur_data":"26042f635e4b","attrs":{"26042f635e4b":{"x":{},"y":{},"text":{},"textposition":"outside","hoverinfo":"x+y+text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Gambling Revenue by State (2024)","xaxis":{"domain":[0,1],"automargin":true,"title":"State (sorted by descending 2024 Revenue)","tickangle":90,"tickmode":"array","tickvals":["Arizona","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","West Virginia","Wyoming"],"ticktext":["Arizona","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","West Virginia","Wyoming"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Revenue","tickformat":"$,"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["New York"],"y":[2059297238],"text":"$2,059,297,238","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New York","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Illinois"],"y":[1866642282],"text":"$1,866,642,282","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Illinois","marker":{"color":"rgba(153,184,149,1)","line":{"color":"rgba(153,184,149,1)"}},"textfont":{"color":"rgba(153,184,149,1)"},"error_y":{"color":"rgba(153,184,149,1)"},"error_x":{"color":"rgba(153,184,149,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Jersey"],"y":[1094630610],"text":"$1,094,630,610","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Jersey","marker":{"color":"rgba(189,173,133,1)","line":{"color":"rgba(189,173,133,1)"}},"textfont":{"color":"rgba(189,173,133,1)"},"error_y":{"color":"rgba(189,173,133,1)"},"error_x":{"color":"rgba(189,173,133,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Ohio"],"y":[904187897],"text":"$904,187,897","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Ohio","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Pennsylvania"],"y":[778420570],"text":"$778,420,570","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Pennsylvania","marker":{"color":"rgba(245,146,102,1)","line":{"color":"rgba(245,146,102,1)"}},"textfont":{"color":"rgba(245,146,102,1)"},"error_y":{"color":"rgba(245,146,102,1)"},"error_x":{"color":"rgba(245,146,102,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Massachusetts"],"y":[670694019],"text":"$670,694,019","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Massachusetts","marker":{"color":"rgba(238,145,116,1)","line":{"color":"rgba(238,145,116,1)"}},"textfont":{"color":"rgba(238,145,116,1)"},"error_y":{"color":"rgba(238,145,116,1)"},"error_x":{"color":"rgba(238,145,116,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maryland"],"y":[629812059],"text":"$629,812,059","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maryland","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Virginia"],"y":[615044067],"text":"$615,044,067","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Virginia","marker":{"color":"rgba(193,154,165,1)","line":{"color":"rgba(193,154,165,1)"}},"textfont":{"color":"rgba(193,154,165,1)"},"error_y":{"color":"rgba(193,154,165,1)"},"error_x":{"color":"rgba(193,154,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["North Carolina"],"y":[583645811],"text":"$583,645,811","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"North Carolina","marker":{"color":"rgba(162,158,189,1)","line":{"color":"rgba(162,158,189,1)"}},"textfont":{"color":"rgba(162,158,189,1)"},"error_y":{"color":"rgba(162,158,189,1)"},"error_x":{"color":"rgba(162,158,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Tennessee"],"y":[485802815],"text":"$485,802,815","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Tennessee","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Indiana"],"y":[484278308],"text":"$484,278,308","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Indiana","marker":{"color":"rgba(175,154,200,1)","line":{"color":"rgba(175,154,200,1)"}},"textfont":{"color":"rgba(175,154,200,1)"},"error_y":{"color":"rgba(175,154,200,1)"},"error_x":{"color":"rgba(175,154,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nevada"],"y":[482121000],"text":"$482,121,000","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Nevada","marker":{"color":"rgba(196,149,198,1)","line":{"color":"rgba(196,149,198,1)"}},"textfont":{"color":"rgba(196,149,198,1)"},"error_y":{"color":"rgba(196,149,198,1)"},"error_x":{"color":"rgba(196,149,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Michigan"],"y":[481495654],"text":"$481,495,654","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Michigan","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Colorado"],"y":[475176731],"text":"$475,176,731","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Colorado","marker":{"color":"rgba(230,141,192,1)","line":{"color":"rgba(230,141,192,1)"}},"textfont":{"color":"rgba(230,141,192,1)"},"error_y":{"color":"rgba(230,141,192,1)"},"error_x":{"color":"rgba(230,141,192,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Louisiana"],"y":[461224426],"text":"$461,224,426","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Louisiana","marker":{"color":"rgba(219,162,168,1)","line":{"color":"rgba(219,162,168,1)"}},"textfont":{"color":"rgba(219,162,168,1)"},"error_y":{"color":"rgba(219,162,168,1)"},"error_x":{"color":"rgba(219,162,168,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Arizona"],"y":[427397087],"text":"$427,397,087","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Arizona","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kentucky"],"y":[272086697],"text":"$272,086,697","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kentucky","marker":{"color":"rgba(189,198,118,1)","line":{"color":"rgba(189,198,118,1)"}},"textfont":{"color":"rgba(189,198,118,1)"},"error_y":{"color":"rgba(189,198,118,1)"},"error_x":{"color":"rgba(189,198,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Iowa"],"y":[218482781],"text":"$218,482,781","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Iowa","marker":{"color":"rgba(169,214,89,1)","line":{"color":"rgba(169,214,89,1)"}},"textfont":{"color":"rgba(169,214,89,1)"},"error_y":{"color":"rgba(169,214,89,1)"},"error_x":{"color":"rgba(169,214,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Connecticut"],"y":[187349516],"text":"$187,349,516","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Connecticut","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kansas"],"y":[145263244],"text":"$145,263,244","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kansas","marker":{"color":"rgba(207,217,70,1)","line":{"color":"rgba(207,217,70,1)"}},"textfont":{"color":"rgba(207,217,70,1)"},"error_y":{"color":"rgba(207,217,70,1)"},"error_x":{"color":"rgba(207,217,70,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Oregon"],"y":[80932000],"text":"$80,932,000","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Oregon","marker":{"color":"rgba(227,217,62,1)","line":{"color":"rgba(227,217,62,1)"}},"textfont":{"color":"rgba(227,217,62,1)"},"error_y":{"color":"rgba(227,217,62,1)"},"error_x":{"color":"rgba(227,217,62,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Hampshire"],"y":[78996303],"text":"$78,996,303","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Hampshire","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["West Virginia"],"y":[65866101],"text":"$65,866,101","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"West Virginia","marker":{"color":"rgba(252,214,66,1)","line":{"color":"rgba(252,214,66,1)"}},"textfont":{"color":"rgba(252,214,66,1)"},"error_y":{"color":"rgba(252,214,66,1)"},"error_x":{"color":"rgba(252,214,66,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maine"],"y":[55388488],"text":"$55,388,488","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maine","marker":{"color":"rgba(247,209,92,1)","line":{"color":"rgba(247,209,92,1)"}},"textfont":{"color":"rgba(247,209,92,1)"},"error_y":{"color":"rgba(247,209,92,1)"},"error_x":{"color":"rgba(247,209,92,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mississippi"],"y":[43344188],"text":"$43,344,188","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Mississippi","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Rhode Island"],"y":[38051914],"text":"$38,051,914","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Rhode Island","marker":{"color":"rgba(234,199,134,1)","line":{"color":"rgba(234,199,134,1)"}},"textfont":{"color":"rgba(234,199,134,1)"},"error_y":{"color":"rgba(234,199,134,1)"},"error_x":{"color":"rgba(234,199,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Vermont"],"y":[27347988],"text":"$27,347,988","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Vermont","marker":{"color":"rgba(226,195,150,1)","line":{"color":"rgba(226,195,150,1)"}},"textfont":{"color":"rgba(226,195,150,1)"},"error_y":{"color":"rgba(226,195,150,1)"},"error_x":{"color":"rgba(226,195,150,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Wyoming"],"y":[22810652],"text":"$22,810,652","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Wyoming","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Delaware"],"y":[14585100],"text":"$14,585,100","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Delaware","marker":{"color":"rgba(204,187,165,1)","line":{"color":"rgba(204,187,165,1)"}},"textfont":{"color":"rgba(204,187,165,1)"},"error_y":{"color":"rgba(204,187,165,1)"},"error_x":{"color":"rgba(204,187,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montana"],"y":[7186894],"text":"$7,186,894","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Montana","marker":{"color":"rgba(192,183,172,1)","line":{"color":"rgba(192,183,172,1)"}},"textfont":{"color":"rgba(192,183,172,1)"},"error_y":{"color":"rgba(192,183,172,1)"},"error_x":{"color":"rgba(192,183,172,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["South Dakota"],"y":[920918],"text":"$920,918","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"South Dakota","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="comparison" class="section level2">
<h2>Comparison</h2>
<pre class="r"><code># Use the Plotly objects created in the previous chunks
combined_revenue_population = 
  subplot(
    population_plot, 
    revenue_plot, 
    nrows = 2,      
    shareX = TRUE,    
    shareY = FALSE,
    titleY = TRUE,
    titleX = TRUE
  ) |&gt; 
  layout(
    title = &quot;Population vs Revenue Comparison by State (Sorted by Revenue)&quot;,
    showlegend = FALSE
  )

combined_revenue_population</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-42ff36b8fb135f811409" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-42ff36b8fb135f811409">{"x":{"data":[{"x":["New York"],"y":[19867248],"text":"19,867,248","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New York","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Illinois"],"y":[12710158],"text":"12,710,158","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Illinois","marker":{"color":"rgba(153,184,149,1)","line":{"color":"rgba(153,184,149,1)"}},"textfont":{"color":"rgba(153,184,149,1)"},"error_y":{"color":"rgba(153,184,149,1)"},"error_x":{"color":"rgba(153,184,149,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Jersey"],"y":[9500851],"text":"9,500,851","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Jersey","marker":{"color":"rgba(189,173,133,1)","line":{"color":"rgba(189,173,133,1)"}},"textfont":{"color":"rgba(189,173,133,1)"},"error_y":{"color":"rgba(189,173,133,1)"},"error_x":{"color":"rgba(189,173,133,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Ohio"],"y":[11883304],"text":"11,883,304","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Ohio","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Pennsylvania"],"y":[13078751],"text":"13,078,751","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Pennsylvania","marker":{"color":"rgba(245,146,102,1)","line":{"color":"rgba(245,146,102,1)"}},"textfont":{"color":"rgba(245,146,102,1)"},"error_y":{"color":"rgba(245,146,102,1)"},"error_x":{"color":"rgba(245,146,102,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Massachusetts"],"y":[7136171],"text":"7,136,171","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Massachusetts","marker":{"color":"rgba(238,145,116,1)","line":{"color":"rgba(238,145,116,1)"}},"textfont":{"color":"rgba(238,145,116,1)"},"error_y":{"color":"rgba(238,145,116,1)"},"error_x":{"color":"rgba(238,145,116,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maryland"],"y":[6263220],"text":"6,263,220","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maryland","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Virginia"],"y":[8811195],"text":"8,811,195","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Virginia","marker":{"color":"rgba(193,154,165,1)","line":{"color":"rgba(193,154,165,1)"}},"textfont":{"color":"rgba(193,154,165,1)"},"error_y":{"color":"rgba(193,154,165,1)"},"error_x":{"color":"rgba(193,154,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["North Carolina"],"y":[11046024],"text":"11,046,024","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"North Carolina","marker":{"color":"rgba(162,158,189,1)","line":{"color":"rgba(162,158,189,1)"}},"textfont":{"color":"rgba(162,158,189,1)"},"error_y":{"color":"rgba(162,158,189,1)"},"error_x":{"color":"rgba(162,158,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Tennessee"],"y":[7227750],"text":"7,227,750","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Tennessee","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Indiana"],"y":[6924275],"text":"6,924,275","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Indiana","marker":{"color":"rgba(175,154,200,1)","line":{"color":"rgba(175,154,200,1)"}},"textfont":{"color":"rgba(175,154,200,1)"},"error_y":{"color":"rgba(175,154,200,1)"},"error_x":{"color":"rgba(175,154,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nevada"],"y":[3267467],"text":"3,267,467","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Nevada","marker":{"color":"rgba(196,149,198,1)","line":{"color":"rgba(196,149,198,1)"}},"textfont":{"color":"rgba(196,149,198,1)"},"error_y":{"color":"rgba(196,149,198,1)"},"error_x":{"color":"rgba(196,149,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Michigan"],"y":[10140459],"text":"10,140,459","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Michigan","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Colorado"],"y":[5957494],"text":"5,957,494","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Colorado","marker":{"color":"rgba(230,141,192,1)","line":{"color":"rgba(230,141,192,1)"}},"textfont":{"color":"rgba(230,141,192,1)"},"error_y":{"color":"rgba(230,141,192,1)"},"error_x":{"color":"rgba(230,141,192,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Louisiana"],"y":[4597740],"text":"4,597,740","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Louisiana","marker":{"color":"rgba(219,162,168,1)","line":{"color":"rgba(219,162,168,1)"}},"textfont":{"color":"rgba(219,162,168,1)"},"error_y":{"color":"rgba(219,162,168,1)"},"error_x":{"color":"rgba(219,162,168,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Arizona"],"y":[7582384],"text":"7,582,384","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Arizona","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kentucky"],"y":[4588372],"text":"4,588,372","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kentucky","marker":{"color":"rgba(189,198,118,1)","line":{"color":"rgba(189,198,118,1)"}},"textfont":{"color":"rgba(189,198,118,1)"},"error_y":{"color":"rgba(189,198,118,1)"},"error_x":{"color":"rgba(189,198,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Iowa"],"y":[3241488],"text":"3,241,488","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Iowa","marker":{"color":"rgba(169,214,89,1)","line":{"color":"rgba(169,214,89,1)"}},"textfont":{"color":"rgba(169,214,89,1)"},"error_y":{"color":"rgba(169,214,89,1)"},"error_x":{"color":"rgba(169,214,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Connecticut"],"y":[3675069],"text":"3,675,069","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Connecticut","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kansas"],"y":[2970606],"text":"2,970,606","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kansas","marker":{"color":"rgba(207,217,70,1)","line":{"color":"rgba(207,217,70,1)"}},"textfont":{"color":"rgba(207,217,70,1)"},"error_y":{"color":"rgba(207,217,70,1)"},"error_x":{"color":"rgba(207,217,70,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Oregon"],"y":[4272371],"text":"4,272,371","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Oregon","marker":{"color":"rgba(227,217,62,1)","line":{"color":"rgba(227,217,62,1)"}},"textfont":{"color":"rgba(227,217,62,1)"},"error_y":{"color":"rgba(227,217,62,1)"},"error_x":{"color":"rgba(227,217,62,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Hampshire"],"y":[1409032],"text":"1,409,032","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Hampshire","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["West Virginia"],"y":[1769979],"text":"1,769,979","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"West Virginia","marker":{"color":"rgba(252,214,66,1)","line":{"color":"rgba(252,214,66,1)"}},"textfont":{"color":"rgba(252,214,66,1)"},"error_y":{"color":"rgba(252,214,66,1)"},"error_x":{"color":"rgba(252,214,66,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maine"],"y":[1405012],"text":"1,405,012","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maine","marker":{"color":"rgba(247,209,92,1)","line":{"color":"rgba(247,209,92,1)"}},"textfont":{"color":"rgba(247,209,92,1)"},"error_y":{"color":"rgba(247,209,92,1)"},"error_x":{"color":"rgba(247,209,92,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mississippi"],"y":[2943045],"text":"2,943,045","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Mississippi","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Rhode Island"],"y":[1112308],"text":"1,112,308","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Rhode Island","marker":{"color":"rgba(234,199,134,1)","line":{"color":"rgba(234,199,134,1)"}},"textfont":{"color":"rgba(234,199,134,1)"},"error_y":{"color":"rgba(234,199,134,1)"},"error_x":{"color":"rgba(234,199,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Vermont"],"y":[648493],"text":"648,493","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Vermont","marker":{"color":"rgba(226,195,150,1)","line":{"color":"rgba(226,195,150,1)"}},"textfont":{"color":"rgba(226,195,150,1)"},"error_y":{"color":"rgba(226,195,150,1)"},"error_x":{"color":"rgba(226,195,150,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Wyoming"],"y":[587618],"text":"587,618","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Wyoming","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Delaware"],"y":[1051917],"text":"1,051,917","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Delaware","marker":{"color":"rgba(204,187,165,1)","line":{"color":"rgba(204,187,165,1)"}},"textfont":{"color":"rgba(204,187,165,1)"},"error_y":{"color":"rgba(204,187,165,1)"},"error_x":{"color":"rgba(204,187,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montana"],"y":[1137233],"text":"1,137,233","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Montana","marker":{"color":"rgba(192,183,172,1)","line":{"color":"rgba(192,183,172,1)"}},"textfont":{"color":"rgba(192,183,172,1)"},"error_y":{"color":"rgba(192,183,172,1)"},"error_x":{"color":"rgba(192,183,172,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["South Dakota"],"y":[924669],"text":"924,669","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"South Dakota","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New York"],"y":[2059297238],"text":"$2,059,297,238","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New York","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Illinois"],"y":[1866642282],"text":"$1,866,642,282","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Illinois","marker":{"color":"rgba(153,184,149,1)","line":{"color":"rgba(153,184,149,1)"}},"textfont":{"color":"rgba(153,184,149,1)"},"error_y":{"color":"rgba(153,184,149,1)"},"error_x":{"color":"rgba(153,184,149,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["New Jersey"],"y":[1094630610],"text":"$1,094,630,610","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Jersey","marker":{"color":"rgba(189,173,133,1)","line":{"color":"rgba(189,173,133,1)"}},"textfont":{"color":"rgba(189,173,133,1)"},"error_y":{"color":"rgba(189,173,133,1)"},"error_x":{"color":"rgba(189,173,133,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Ohio"],"y":[904187897],"text":"$904,187,897","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Ohio","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Pennsylvania"],"y":[778420570],"text":"$778,420,570","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Pennsylvania","marker":{"color":"rgba(245,146,102,1)","line":{"color":"rgba(245,146,102,1)"}},"textfont":{"color":"rgba(245,146,102,1)"},"error_y":{"color":"rgba(245,146,102,1)"},"error_x":{"color":"rgba(245,146,102,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Massachusetts"],"y":[670694019],"text":"$670,694,019","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Massachusetts","marker":{"color":"rgba(238,145,116,1)","line":{"color":"rgba(238,145,116,1)"}},"textfont":{"color":"rgba(238,145,116,1)"},"error_y":{"color":"rgba(238,145,116,1)"},"error_x":{"color":"rgba(238,145,116,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Maryland"],"y":[629812059],"text":"$629,812,059","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maryland","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Virginia"],"y":[615044067],"text":"$615,044,067","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Virginia","marker":{"color":"rgba(193,154,165,1)","line":{"color":"rgba(193,154,165,1)"}},"textfont":{"color":"rgba(193,154,165,1)"},"error_y":{"color":"rgba(193,154,165,1)"},"error_x":{"color":"rgba(193,154,165,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["North Carolina"],"y":[583645811],"text":"$583,645,811","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"North Carolina","marker":{"color":"rgba(162,158,189,1)","line":{"color":"rgba(162,158,189,1)"}},"textfont":{"color":"rgba(162,158,189,1)"},"error_y":{"color":"rgba(162,158,189,1)"},"error_x":{"color":"rgba(162,158,189,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Tennessee"],"y":[485802815],"text":"$485,802,815","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Tennessee","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Indiana"],"y":[484278308],"text":"$484,278,308","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Indiana","marker":{"color":"rgba(175,154,200,1)","line":{"color":"rgba(175,154,200,1)"}},"textfont":{"color":"rgba(175,154,200,1)"},"error_y":{"color":"rgba(175,154,200,1)"},"error_x":{"color":"rgba(175,154,200,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Nevada"],"y":[482121000],"text":"$482,121,000","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Nevada","marker":{"color":"rgba(196,149,198,1)","line":{"color":"rgba(196,149,198,1)"}},"textfont":{"color":"rgba(196,149,198,1)"},"error_y":{"color":"rgba(196,149,198,1)"},"error_x":{"color":"rgba(196,149,198,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Michigan"],"y":[481495654],"text":"$481,495,654","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Michigan","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Colorado"],"y":[475176731],"text":"$475,176,731","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Colorado","marker":{"color":"rgba(230,141,192,1)","line":{"color":"rgba(230,141,192,1)"}},"textfont":{"color":"rgba(230,141,192,1)"},"error_y":{"color":"rgba(230,141,192,1)"},"error_x":{"color":"rgba(230,141,192,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Louisiana"],"y":[461224426],"text":"$461,224,426","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Louisiana","marker":{"color":"rgba(219,162,168,1)","line":{"color":"rgba(219,162,168,1)"}},"textfont":{"color":"rgba(219,162,168,1)"},"error_y":{"color":"rgba(219,162,168,1)"},"error_x":{"color":"rgba(219,162,168,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Arizona"],"y":[427397087],"text":"$427,397,087","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Arizona","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Kentucky"],"y":[272086697],"text":"$272,086,697","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kentucky","marker":{"color":"rgba(189,198,118,1)","line":{"color":"rgba(189,198,118,1)"}},"textfont":{"color":"rgba(189,198,118,1)"},"error_y":{"color":"rgba(189,198,118,1)"},"error_x":{"color":"rgba(189,198,118,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Iowa"],"y":[218482781],"text":"$218,482,781","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Iowa","marker":{"color":"rgba(169,214,89,1)","line":{"color":"rgba(169,214,89,1)"}},"textfont":{"color":"rgba(169,214,89,1)"},"error_y":{"color":"rgba(169,214,89,1)"},"error_x":{"color":"rgba(169,214,89,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Connecticut"],"y":[187349516],"text":"$187,349,516","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Connecticut","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Kansas"],"y":[145263244],"text":"$145,263,244","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kansas","marker":{"color":"rgba(207,217,70,1)","line":{"color":"rgba(207,217,70,1)"}},"textfont":{"color":"rgba(207,217,70,1)"},"error_y":{"color":"rgba(207,217,70,1)"},"error_x":{"color":"rgba(207,217,70,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Oregon"],"y":[80932000],"text":"$80,932,000","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Oregon","marker":{"color":"rgba(227,217,62,1)","line":{"color":"rgba(227,217,62,1)"}},"textfont":{"color":"rgba(227,217,62,1)"},"error_y":{"color":"rgba(227,217,62,1)"},"error_x":{"color":"rgba(227,217,62,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["New Hampshire"],"y":[78996303],"text":"$78,996,303","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Hampshire","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["West Virginia"],"y":[65866101],"text":"$65,866,101","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"West Virginia","marker":{"color":"rgba(252,214,66,1)","line":{"color":"rgba(252,214,66,1)"}},"textfont":{"color":"rgba(252,214,66,1)"},"error_y":{"color":"rgba(252,214,66,1)"},"error_x":{"color":"rgba(252,214,66,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Maine"],"y":[55388488],"text":"$55,388,488","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maine","marker":{"color":"rgba(247,209,92,1)","line":{"color":"rgba(247,209,92,1)"}},"textfont":{"color":"rgba(247,209,92,1)"},"error_y":{"color":"rgba(247,209,92,1)"},"error_x":{"color":"rgba(247,209,92,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Mississippi"],"y":[43344188],"text":"$43,344,188","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Mississippi","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Rhode Island"],"y":[38051914],"text":"$38,051,914","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Rhode Island","marker":{"color":"rgba(234,199,134,1)","line":{"color":"rgba(234,199,134,1)"}},"textfont":{"color":"rgba(234,199,134,1)"},"error_y":{"color":"rgba(234,199,134,1)"},"error_x":{"color":"rgba(234,199,134,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Vermont"],"y":[27347988],"text":"$27,347,988","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Vermont","marker":{"color":"rgba(226,195,150,1)","line":{"color":"rgba(226,195,150,1)"}},"textfont":{"color":"rgba(226,195,150,1)"},"error_y":{"color":"rgba(226,195,150,1)"},"error_x":{"color":"rgba(226,195,150,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Wyoming"],"y":[22810652],"text":"$22,810,652","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Wyoming","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Delaware"],"y":[14585100],"text":"$14,585,100","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Delaware","marker":{"color":"rgba(204,187,165,1)","line":{"color":"rgba(204,187,165,1)"}},"textfont":{"color":"rgba(204,187,165,1)"},"error_y":{"color":"rgba(204,187,165,1)"},"error_x":{"color":"rgba(204,187,165,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Montana"],"y":[7186894],"text":"$7,186,894","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Montana","marker":{"color":"rgba(192,183,172,1)","line":{"color":"rgba(192,183,172,1)"}},"textfont":{"color":"rgba(192,183,172,1)"},"error_y":{"color":"rgba(192,183,172,1)"},"error_x":{"color":"rgba(192,183,172,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["South Dakota"],"y":[920918],"text":"$920,918","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"South Dakota","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"State (sorted by descending 2024 Revenue)","tickangle":90,"tickmode":"array","tickvals":["Arizona","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","West Virginia","Wyoming"],"ticktext":["Arizona","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","West Virginia","Wyoming"],"anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"Revenue","tickformat":"$,","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"Total Population","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Population vs Revenue Comparison by State (Sorted by Revenue)","showlegend":false,"hovermode":"closest"},"attrs":{"260439fe37db":{"x":{},"y":{},"text":{},"textposition":"outside","hoverinfo":"x+y+text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"26042f635e4b":{"x":{},"y":{},"text":{},"textposition":"outside","hoverinfo":"x+y+text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="racial-makeup" class="section level2">
<h2>Racial Makeup</h2>
<pre class="r"><code>race_plot_data = 
  model_clean_2024 |&gt; 
  filter(State != &quot;Washington D.C.&quot;) |&gt; 
  select(State, Revenue, pct_white, pct_black, pct_asian, pct_hispanic) |&gt; 
  pivot_longer(
    cols = pct_white:pct_hispanic,
    names_to = &quot;race&quot;,
    values_to = &quot;percentage&quot;
  ) |&gt; 
  mutate(
      State = as.factor(State),
      State = fct_reorder(State, Revenue, .desc = TRUE),
      race = factor(race,
                  levels = c(&quot;pct_white&quot;, &quot;pct_black&quot;, &quot;pct_asian&quot;, &quot;pct_hispanic&quot;),
                  labels = c(&quot;% White&quot;, &quot;% Black&quot;, &quot;% Asian&quot;, &quot;% Hispanic&quot;))
  )

race_plot_data |&gt; 
  plot_ly(
    x = ~State,
    y = ~percentage,
    color = ~race,
    type = &#39;scatter&#39;,
    mode = &#39;lines+markers&#39;,
    # Format hover text to two decimal places
    text = ~paste(State, &quot;: &quot;, sprintf(&quot;%.2f%%&quot;, percentage)),
    hoverinfo = &#39;text&#39;,         
    line = list(width = 2)
  ) |&gt; 
  layout(
    title = &quot;Racial Makeup by State (2024)&quot;,    
    xaxis = list(
      title = &quot;State (sorted by descending 2024 Revenue)&quot;,
      tickangle = 90            
    ),
    yaxis = list(
      title = &quot;Percentage of Population&quot;, 
      # Assuming percentage values are stored as raw percents (e.g., 50.5 for 50.5%)
      tickformat = &quot;.1f%&quot;
    ),
    showlegend = TRUE,
    font = list(size = 13)
  )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-b873fcb3d7dc7369979f" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-b873fcb3d7dc7369979f">{"x":{"visdat":{"26042a77b128":["function () ","plotlyVisDat"]},"cur_data":"26042a77b128","attrs":{"26042a77b128":{"x":{},"y":{},"mode":"lines+markers","text":{},"hoverinfo":"text","line":{"width":2},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Racial Makeup by State (2024)","xaxis":{"domain":[0,1],"automargin":true,"title":"State (sorted by descending 2024 Revenue)","tickangle":90,"type":"category","categoryorder":"array","categoryarray":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Percentage of Population","tickformat":".1f%"},"showlegend":true,"font":{"size":13},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Arizona","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","West Virginia","Wyoming"],"y":[0.57312752822858903,0.69359885213480699,0.63697987711251103,0.58165805857306196,0.60189629428682201,0.76012607818147004,0.83172604680319695,0.75049871978983396,0.81427312345206504,0.56421372239404599,0.89681653964521302,0.46899358476949599,0.66718258292857602,0.73043853340366505,0.55563676396385397,0.84627160836873405,0.48017960089574002,0.87559260541989103,0.52336227565299198,0.54330297784574899,0.60837754833775504,0.75988050124780104,0.73484442245301296,0.73495565440461397,0.68538570252124398,0.79927736303477204,0.71959102071875802,0.90105829978118501,0.59293920972126901,0.89395297910314198,0.83302757914155101],"mode":"lines+markers","text":["Arizona :  0.57%","Colorado :  0.69%","Connecticut :  0.64%","Delaware :  0.58%","Illinois :  0.60%","Indiana :  0.76%","Iowa :  0.83%","Kansas :  0.75%","Kentucky :  0.81%","Louisiana :  0.56%","Maine :  0.90%","Maryland :  0.47%","Massachusetts :  0.67%","Michigan :  0.73%","Mississippi :  0.56%","Montana :  0.85%","Nevada :  0.48%","New Hampshire :  0.88%","New Jersey :  0.52%","New York :  0.54%","North Carolina :  0.61%","Ohio :  0.76%","Oregon :  0.73%","Pennsylvania :  0.73%","Rhode Island :  0.69%","South Dakota :  0.80%","Tennessee :  0.72%","Vermont :  0.90%","Virginia :  0.59%","West Virginia :  0.89%","Wyoming :  0.83%"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"rgba(102,194,165,1)","width":2},"type":"scatter","name":"% White","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Arizona","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","West Virginia","Wyoming"],"y":[0.047592947020356699,0.042512338241549201,0.10757838832413801,0.22039286369552,0.13215421869657301,0.091196406844037806,0.041514267521582701,0.053426809209972601,0.071121304026787693,0.30411267274791498,0.020814768841832001,0.291403144069664,0.068592806982904403,0.13016738196959299,0.35880219296680799,0.0030908353872953001,0.095148933409273898,0.015097598918974201,0.12901139066384701,0.14235122046093099,0.19820045656247001,0.121569051839455,0.019374721905003101,0.105373058941179,0.055527785469492302,0.020277526336451201,0.149972121337899,0.0096778222741031907,0.18221194741462399,0.032174958007976401,0.0078265131428921497],"mode":"lines+markers","text":["Arizona :  0.05%","Colorado :  0.04%","Connecticut :  0.11%","Delaware :  0.22%","Illinois :  0.13%","Indiana :  0.09%","Iowa :  0.04%","Kansas :  0.05%","Kentucky :  0.07%","Louisiana :  0.30%","Maine :  0.02%","Maryland :  0.29%","Massachusetts :  0.07%","Michigan :  0.13%","Mississippi :  0.36%","Montana :  0.00%","Nevada :  0.10%","New Hampshire :  0.02%","New Jersey :  0.13%","New York :  0.14%","North Carolina :  0.20%","Ohio :  0.12%","Oregon :  0.02%","Pennsylvania :  0.11%","Rhode Island :  0.06%","South Dakota :  0.02%","Tennessee :  0.15%","Vermont :  0.01%","Virginia :  0.18%","West Virginia :  0.03%","Wyoming :  0.01%"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"rgba(252,141,98,1)","width":2},"type":"scatter","name":"% Black","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Arizona","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","West Virginia","Wyoming"],"y":[0.039926229006602698,0.034834445489999699,0.048035560692874103,0.048310845817683301,0.063933430253187998,0.027088612165172499,0.025885951143425501,0.030271264516398302,0.018778119995501701,0.018233088430402802,0.013376398208698599,0.069358093760078704,0.077293411270553905,0.0374693098211826,0.0123141168415706,0.0082700730633036498,0.094512048629718404,0.0268602842234953,0.10665023585781901,0.095325281085734695,0.036272146430244998,0.027620012077449199,0.0494404629185995,0.0417672910815413,0.037539062921421,0.017061240292472201,0.020193559544809898,0.020575395570962201,0.071753717855523605,0.0070627956602875002,0.0099009900990098994],"mode":"lines+markers","text":["Arizona :  0.04%","Colorado :  0.03%","Connecticut :  0.05%","Delaware :  0.05%","Illinois :  0.06%","Indiana :  0.03%","Iowa :  0.03%","Kansas :  0.03%","Kentucky :  0.02%","Louisiana :  0.02%","Maine :  0.01%","Maryland :  0.07%","Massachusetts :  0.08%","Michigan :  0.04%","Mississippi :  0.01%","Montana :  0.01%","Nevada :  0.09%","New Hampshire :  0.03%","New Jersey :  0.11%","New York :  0.10%","North Carolina :  0.04%","Ohio :  0.03%","Oregon :  0.05%","Pennsylvania :  0.04%","Rhode Island :  0.04%","South Dakota :  0.02%","Tennessee :  0.02%","Vermont :  0.02%","Virginia :  0.07%","West Virginia :  0.01%","Wyoming :  0.01%"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"rgba(141,160,203,1)","width":2},"type":"scatter","name":"% Asian","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Arizona","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","West Virginia","Wyoming"],"y":[0.32122627922827401,0.23213586115235699,0.19232455227371201,0.116751606828295,0.193763759663727,0.0904955392441808,0.078119678369933804,0.142315069719781,0.055060923569405403,0.077783432729993399,0.023394106242509,0.13267105418618499,0.13996231312282201,0.061321780404614799,0.040274273753884197,0.048807939973602603,0.30587210215129901,0.0503267491440932,0.23465940051054399,0.20230723449971499,0.119913735476222,0.051074431824684401,0.15512229626125601,0.094245773162896104,0.18787601995130801,0.048608745399705201,0.078425374424959393,0.0268329804639372,0.115515886324159,0.023165246593321202,0.110667134090515],"mode":"lines+markers","text":["Arizona :  0.32%","Colorado :  0.23%","Connecticut :  0.19%","Delaware :  0.12%","Illinois :  0.19%","Indiana :  0.09%","Iowa :  0.08%","Kansas :  0.14%","Kentucky :  0.06%","Louisiana :  0.08%","Maine :  0.02%","Maryland :  0.13%","Massachusetts :  0.14%","Michigan :  0.06%","Mississippi :  0.04%","Montana :  0.05%","Nevada :  0.31%","New Hampshire :  0.05%","New Jersey :  0.23%","New York :  0.20%","North Carolina :  0.12%","Ohio :  0.05%","Oregon :  0.16%","Pennsylvania :  0.09%","Rhode Island :  0.19%","South Dakota :  0.05%","Tennessee :  0.08%","Vermont :  0.03%","Virginia :  0.12%","West Virginia :  0.02%","Wyoming :  0.11%"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"rgba(231,138,195,1)","width":2},"type":"scatter","name":"% Hispanic","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="economic-stats" class="section level2">
<h2>Economic Stats</h2>
<pre class="r"><code>economic_plot_data = 
  model_clean_2024 |&gt; 
    filter(State != &quot;Washington D.C.&quot;) |&gt; 
    select(State, Revenue, unemployment_rate, pct_poverty) |&gt; 
    pivot_longer(
      cols = c(&quot;pct_poverty&quot;, &quot;unemployment_rate&quot;),
      names_to = &quot;measure&quot;,
      values_to = &quot;percentage&quot;
    ) |&gt; 
    mutate(
        State = as.factor(State),
        State = fct_reorder(State, Revenue, .desc = TRUE),
        measure = factor(measure,
                    levels = c(&quot;pct_poverty&quot;, &quot;unemployment_rate&quot;),
                    labels = c(&quot;% in Poverty&quot;, &quot;% Unemployed&quot;))
    )

economic_plot_data |&gt; 
  plot_ly(
    x = ~State,
    y = ~percentage,
    color = ~measure,
    type = &#39;scatter&#39;,
    mode = &#39;lines+markers&#39;,
    # Format hover text to two decimal places
    text = ~paste(State, &quot;: &quot;, sprintf(&quot;%.2f%%&quot;, percentage)),
    hoverinfo = &#39;text&#39;,         
    line = list(width = 2)
  ) |&gt; 
  layout(
    title = &quot;Poverty &amp; Unemployment by State (2024)&quot;,    
    xaxis = list(
      title = &quot;State (sorted by descending 2024 Revenue)&quot;,
      tickangle = 90            
    ),
    yaxis = list(
      title = &quot;Percentage of Population&quot;, 
      # Assuming percentage values are stored as raw percents (e.g., 5.5 for 5.5%)
      tickformat = &quot;.1f%&quot;
    ),
    showlegend = TRUE,
    font = list(size = 13)
  )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-4599af4436a03617c2e2" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-4599af4436a03617c2e2">{"x":{"visdat":{"26042e2ac03e":["function () ","plotlyVisDat"]},"cur_data":"26042e2ac03e","attrs":{"26042e2ac03e":{"x":{},"y":{},"mode":"lines+markers","text":{},"hoverinfo":"text","line":{"width":2},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Poverty & Unemployment by State (2024)","xaxis":{"domain":[0,1],"automargin":true,"title":"State (sorted by descending 2024 Revenue)","tickangle":90,"type":"category","categoryorder":"array","categoryarray":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Percentage of Population","tickformat":".1f%"},"showlegend":true,"font":{"size":13},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Arizona","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","West Virginia","Wyoming"],"y":[0.116805302577693,0.096011668699054198,0.10195636795853,0.095937176933724999,0.115789212711916,0.122276666904688,0.1133853317804,0.108541075711762,0.15555882731262799,0.18687793455590701,0.10598586639857301,0.090648953011687794,0.097188245112582894,0.13445265492470501,0.17812326777482301,0.102255698611753,0.11578105072867501,0.072048082719815901,0.091957993636379104,0.13971302310467301,0.125482468770931,0.12672748044722501,0.117864210641138,0.115776120959588,0.121662252898198,0.10411901484783199,0.134601236749816,0.090159396590621804,0.097491173585547999,0.16736124000602401,0.10095231141522],"mode":"lines+markers","text":["Arizona :  0.12%","Colorado :  0.10%","Connecticut :  0.10%","Delaware :  0.10%","Illinois :  0.12%","Indiana :  0.12%","Iowa :  0.11%","Kansas :  0.11%","Kentucky :  0.16%","Louisiana :  0.19%","Maine :  0.11%","Maryland :  0.09%","Massachusetts :  0.10%","Michigan :  0.13%","Mississippi :  0.18%","Montana :  0.10%","Nevada :  0.12%","New Hampshire :  0.07%","New Jersey :  0.09%","New York :  0.14%","North Carolina :  0.13%","Ohio :  0.13%","Oregon :  0.12%","Pennsylvania :  0.12%","Rhode Island :  0.12%","South Dakota :  0.10%","Tennessee :  0.13%","Vermont :  0.09%","Virginia :  0.10%","West Virginia :  0.17%","Wyoming :  0.10%"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"rgba(102,194,165,1)","width":2},"type":"scatter","name":"% in Poverty","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Arizona","Colorado","Connecticut","Delaware","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Mississippi","Montana","Nevada","New Hampshire","New Jersey","New York","North Carolina","Ohio","Oregon","Pennsylvania","Rhode Island","South Dakota","Tennessee","Vermont","Virginia","West Virginia","Wyoming"],"y":[0.045637548016821898,0.042770318157260498,0.049482889745232503,0.051067189839202803,0.051274607770050502,0.040963569793122601,0.031819046666200203,0.036714328173470201,0.048706068993665502,0.051515239241408502,0.027231558189705098,0.043456375838926198,0.040706371215408002,0.044997010233710701,0.046047512310693997,0.029626135877790099,0.0628302798451012,0.027765141176113801,0.054064165521133703,0.053222478733459602,0.039885912529005099,0.039911548884883699,0.048540222510555599,0.043452420240770902,0.050414644261615203,0.0280759936503443,0.042269914198456097,0.026674037344768999,0.036202912799668301,0.046344915416549601,0.034279547663393403],"mode":"lines+markers","text":["Arizona :  0.05%","Colorado :  0.04%","Connecticut :  0.05%","Delaware :  0.05%","Illinois :  0.05%","Indiana :  0.04%","Iowa :  0.03%","Kansas :  0.04%","Kentucky :  0.05%","Louisiana :  0.05%","Maine :  0.03%","Maryland :  0.04%","Massachusetts :  0.04%","Michigan :  0.04%","Mississippi :  0.05%","Montana :  0.03%","Nevada :  0.06%","New Hampshire :  0.03%","New Jersey :  0.05%","New York :  0.05%","North Carolina :  0.04%","Ohio :  0.04%","Oregon :  0.05%","Pennsylvania :  0.04%","Rhode Island :  0.05%","South Dakota :  0.03%","Tennessee :  0.04%","Vermont :  0.03%","Virginia :  0.04%","West Virginia :  0.05%","Wyoming :  0.03%"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"rgba(141,160,203,1)","width":2},"type":"scatter","name":"% Unemployed","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="predictive-modeling" class="section level1">
<h1>Predictive Modeling</h1>
<div id="model-setup" class="section level2">
<h2>Model Setup</h2>
<p>We begin by building our training dataset, fitting a standard linear
model for comparison, and handling missing values.</p>
<pre class="r"><code># Build training dataset
training_data &lt;- model_clean_2024 |&gt;
  select(
    State, Revenue, total_pop, median_income, 
    pct_bachelors, pct_age_20_34, pct_urban, pct_poverty
  ) |&gt;
  drop_na()

# Fit Linear Model for later comparison
fit_lm &lt;- lm(
  Revenue ~ total_pop + median_income + pct_bachelors +
    pct_age_20_34 + pct_urban + pct_poverty,
  data = training_data
)

# Prepare Illegal States Data
states_no_gambling &lt;- demographics_2024 |&gt;
  anti_join(training_data, by = &quot;State&quot;)

newdata_illegal &lt;- states_no_gambling |&gt;
  select(
    State, total_pop, median_income, pct_bachelors, 
    pct_age_20_34, pct_urban, pct_poverty
  ) |&gt;
  drop_na()</code></pre>
</div>
<div id="lasso-regression" class="section level2">
<h2>LASSO Regression</h2>
<p>We implement a LASSO regression to handle multicollinearity and
perform feature selection.</p>
<pre class="r"><code># Build design matrix
X_train &lt;- model.matrix(
  Revenue ~ total_pop + median_income + pct_bachelors +
    pct_age_20_34 + pct_urban + pct_poverty,
  data = training_data)[, -1]

y_train &lt;- training_data$Revenue

set.seed(123)

# Cross-validated LASSO
lasso_cv &lt;- cv.glmnet(X_train, y_train, alpha = 1, nfolds = 5, standardize = TRUE)
lasso_model &lt;- glmnet(X_train, y_train, alpha = 1, lambda = lasso_cv$lambda.min, standardize = TRUE)

# Predictions for non-gambling states
X_new &lt;- model.matrix(
  ~ total_pop + median_income + pct_bachelors +
    pct_age_20_34 + pct_urban + pct_poverty,
  data = newdata_illegal)[, -1]

pred_illegal_lasso &lt;- newdata_illegal |&gt;
  mutate(
    predicted_revenue_lasso = as.numeric(predict(lasso_model, newx = X_new)),
    predicted_revenue_lasso = pmax(predicted_revenue_lasso, 0) # Remove negative predictions
  ) |&gt;
  arrange(desc(predicted_revenue_lasso))</code></pre>
</div>
<div id="prediction-results" class="section level2">
<h2>Prediction Results</h2>
<pre class="r"><code>pred_table &lt;- pred_illegal_lasso |&gt;
  mutate(
    Predicted_Revenue = scales::dollar(predicted_revenue_lasso),
    Population = scales::comma(total_pop),
    Median_Income = scales::dollar(median_income)
  ) |&gt;
  select(
    State, Population, Median_Income, pct_bachelors, 
    pct_age_20_34, pct_urban, pct_poverty, Predicted_Revenue
  )

kable(pred_table, format = &quot;html&quot;, 
      caption = &quot;Predicted Annual Gambling Revenue for Non-Legal States (LASSO Model)&quot;) |&gt;
  kable_styling(full_width = FALSE, bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;))</code></pre>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Predicted Annual Gambling Revenue for Non-Legal States (LASSO Model)
</caption>
<thead>
<tr>
<th style="text-align:left;">
State
</th>
<th style="text-align:left;">
Population
</th>
<th style="text-align:left;">
Median_Income
</th>
<th style="text-align:right;">
pct_bachelors
</th>
<th style="text-align:right;">
pct_age_20_34
</th>
<th style="text-align:right;">
pct_urban
</th>
<th style="text-align:right;">
pct_poverty
</th>
<th style="text-align:left;">
Predicted_Revenue
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:left;">
39,431,263
</td>
<td style="text-align:left;">
$100,149
</td>
<td style="text-align:right;">
0.3812365
</td>
<td style="text-align:right;">
0.0652504
</td>
<td style="text-align:right;">
0.9423663
</td>
<td style="text-align:right;">
0.1180257
</td>
<td style="text-align:left;">
$3,611,645,904
</td>
</tr>
<tr>
<td style="text-align:left;">
Texas
</td>
<td style="text-align:left;">
31,290,831
</td>
<td style="text-align:left;">
$79,721
</td>
<td style="text-align:right;">
0.3516383
</td>
<td style="text-align:right;">
0.0694787
</td>
<td style="text-align:right;">
0.8372028
</td>
<td style="text-align:right;">
0.1340909
</td>
<td style="text-align:left;">
$2,765,125,447
</td>
</tr>
<tr>
<td style="text-align:left;">
Florida
</td>
<td style="text-align:left;">
23,372,215
</td>
<td style="text-align:left;">
$77,735
</td>
<td style="text-align:right;">
0.3583638
</td>
<td style="text-align:right;">
0.0582353
</td>
<td style="text-align:right;">
0.9153419
</td>
<td style="text-align:right;">
0.1204723
</td>
<td style="text-align:left;">
$2,135,268,431
</td>
</tr>
<tr>
<td style="text-align:left;">
Georgia
</td>
<td style="text-align:left;">
11,180,878
</td>
<td style="text-align:left;">
$79,991
</td>
<td style="text-align:right;">
0.3631028
</td>
<td style="text-align:right;">
0.0673810
</td>
<td style="text-align:right;">
0.7406697
</td>
<td style="text-align:right;">
0.1258716
</td>
<td style="text-align:left;">
$922,707,171
</td>
</tr>
<tr>
<td style="text-align:left;">
Washington
</td>
<td style="text-align:left;">
7,958,180
</td>
<td style="text-align:left;">
$99,389
</td>
<td style="text-align:right;">
0.4101713
</td>
<td style="text-align:right;">
0.0616117
</td>
<td style="text-align:right;">
0.8337185
</td>
<td style="text-align:right;">
0.0993223
</td>
<td style="text-align:left;">
$736,907,744
</td>
</tr>
<tr>
<td style="text-align:left;">
Minnesota
</td>
<td style="text-align:left;">
5,793,151
</td>
<td style="text-align:left;">
$87,117
</td>
<td style="text-align:right;">
0.4003043
</td>
<td style="text-align:right;">
0.0634185
</td>
<td style="text-align:right;">
0.7187871
</td>
<td style="text-align:right;">
0.0933292
</td>
<td style="text-align:left;">
$471,813,698
</td>
</tr>
<tr>
<td style="text-align:left;">
Missouri
</td>
<td style="text-align:left;">
6,245,466
</td>
<td style="text-align:left;">
$71,589
</td>
<td style="text-align:right;">
0.3347161
</td>
<td style="text-align:right;">
0.0670586
</td>
<td style="text-align:right;">
0.6946748
</td>
<td style="text-align:right;">
0.1226321
</td>
<td style="text-align:left;">
$443,937,391
</td>
</tr>
<tr>
<td style="text-align:left;">
Wisconsin
</td>
<td style="text-align:left;">
5,960,975
</td>
<td style="text-align:left;">
$77,488
</td>
<td style="text-align:right;">
0.3455598
</td>
<td style="text-align:right;">
0.0673242
</td>
<td style="text-align:right;">
0.6708314
</td>
<td style="text-align:right;">
0.1032844
</td>
<td style="text-align:left;">
$425,197,336
</td>
</tr>
<tr>
<td style="text-align:left;">
South Carolina
</td>
<td style="text-align:left;">
5,478,831
</td>
<td style="text-align:left;">
$72,350
</td>
<td style="text-align:right;">
0.3333325
</td>
<td style="text-align:right;">
0.0634482
</td>
<td style="text-align:right;">
0.6794803
</td>
<td style="text-align:right;">
0.1325996
</td>
<td style="text-align:left;">
$398,844,164
</td>
</tr>
<tr>
<td style="text-align:left;">
Alabama
</td>
<td style="text-align:left;">
5,157,699
</td>
<td style="text-align:left;">
$66,659
</td>
<td style="text-align:right;">
0.2985358
</td>
<td style="text-align:right;">
0.0643101
</td>
<td style="text-align:right;">
0.5773724
</td>
<td style="text-align:right;">
0.1518804
</td>
<td style="text-align:left;">
$327,792,352
</td>
</tr>
<tr>
<td style="text-align:left;">
Oklahoma
</td>
<td style="text-align:left;">
4,095,393
</td>
<td style="text-align:left;">
$66,148
</td>
<td style="text-align:right;">
0.2931934
</td>
<td style="text-align:right;">
0.0701015
</td>
<td style="text-align:right;">
0.6462195
</td>
<td style="text-align:right;">
0.1490811
</td>
<td style="text-align:left;">
$201,795,708
</td>
</tr>
<tr>
<td style="text-align:left;">
Hawaii
</td>
<td style="text-align:left;">
1,446,146
</td>
<td style="text-align:left;">
$100,745
</td>
<td style="text-align:right;">
0.3775749
</td>
<td style="text-align:right;">
0.0586905
</td>
<td style="text-align:right;">
0.8606301
</td>
<td style="text-align:right;">
0.0998640
</td>
<td style="text-align:left;">
$172,063,243
</td>
</tr>
<tr>
<td style="text-align:left;">
Utah
</td>
<td style="text-align:left;">
3,503,613
</td>
<td style="text-align:left;">
$96,658
</td>
<td style="text-align:right;">
0.3911757
</td>
<td style="text-align:right;">
0.0874363
</td>
<td style="text-align:right;">
0.8978141
</td>
<td style="text-align:right;">
0.0832570
</td>
<td style="text-align:left;">
$148,267,944
</td>
</tr>
<tr>
<td style="text-align:left;">
Puerto Rico
</td>
<td style="text-align:left;">
3,203,295
</td>
<td style="text-align:left;">
$27,213
</td>
<td style="text-align:right;">
0.2969966
</td>
<td style="text-align:right;">
0.0663738
</td>
<td style="text-align:right;">
0.9187534
</td>
<td style="text-align:right;">
0.3730844
</td>
<td style="text-align:left;">
$111,180,446
</td>
</tr>
<tr>
<td style="text-align:left;">
Arkansas
</td>
<td style="text-align:left;">
3,088,354
</td>
<td style="text-align:left;">
$62,106
</td>
<td style="text-align:right;">
0.2711732
</td>
<td style="text-align:right;">
0.0664785
</td>
<td style="text-align:right;">
0.5547613
</td>
<td style="text-align:right;">
0.1553574
</td>
<td style="text-align:left;">
$107,040,120
</td>
</tr>
<tr>
<td style="text-align:left;">
New Mexico
</td>
<td style="text-align:left;">
2,130,256
</td>
<td style="text-align:left;">
$67,816
</td>
<td style="text-align:right;">
0.3178310
</td>
<td style="text-align:right;">
0.0681773
</td>
<td style="text-align:right;">
0.7454714
</td>
<td style="text-align:right;">
0.1641940
</td>
<td style="text-align:left;">
$61,324,867
</td>
</tr>
<tr>
<td style="text-align:left;">
Idaho
</td>
<td style="text-align:left;">
2,001,619
</td>
<td style="text-align:left;">
$81,166
</td>
<td style="text-align:right;">
0.3302656
</td>
<td style="text-align:right;">
0.0708042
</td>
<td style="text-align:right;">
0.6924218
</td>
<td style="text-align:right;">
0.1046070
</td>
<td style="text-align:left;">
$51,404,787
</td>
</tr>
<tr>
<td style="text-align:left;">
District of Columbia
</td>
<td style="text-align:left;">
702,250
</td>
<td style="text-align:left;">
$109,707
</td>
<td style="text-align:right;">
0.6546496
</td>
<td style="text-align:right;">
0.0729740
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
0.1731169
</td>
<td style="text-align:left;">
$51,027,257
</td>
</tr>
<tr>
<td style="text-align:left;">
Nebraska
</td>
<td style="text-align:left;">
2,005,466
</td>
<td style="text-align:left;">
$76,376
</td>
<td style="text-align:right;">
0.3535887
</td>
<td style="text-align:right;">
0.0714562
</td>
<td style="text-align:right;">
0.7300536
</td>
<td style="text-align:right;">
0.1087362
</td>
<td style="text-align:left;">
$43,401,693
</td>
</tr>
<tr>
<td style="text-align:left;">
Alaska
</td>
<td style="text-align:left;">
740,133
</td>
<td style="text-align:left;">
$95,665
</td>
<td style="text-align:right;">
0.3275460
</td>
<td style="text-align:right;">
0.0682283
</td>
<td style="text-align:right;">
0.6489949
</td>
<td style="text-align:right;">
0.1016680
</td>
<td style="text-align:left;">
$0
</td>
</tr>
<tr>
<td style="text-align:left;">
North Dakota
</td>
<td style="text-align:left;">
796,568
</td>
<td style="text-align:left;">
$77,871
</td>
<td style="text-align:right;">
0.3395173
</td>
<td style="text-align:right;">
0.0773305
</td>
<td style="text-align:right;">
0.6096684
</td>
<td style="text-align:right;">
0.1112829
</td>
<td style="text-align:left;">
$0
</td>
</tr>
</tbody>
</table>
<p><em>This table presents the predicted gambling revenue for each state
that has not yet legalized sports betting. Using the LASSO model, we
estimated annual revenue based on demographic characteristics, including
population size, educational attainment, urbanization, and poverty
rates. The table shows that states like California, Texas, and Florida
have demographic profiles similar to those of current high-revenue
states, suggesting substantial untapped market potential if legalization
were pursued.</em></p>
</div>
<div id="visualizing-predictions" class="section level2">
<h2>Visualizing Predictions</h2>
<pre class="r"><code>pred_illegal_lasso_plot &lt;- pred_illegal_lasso |&gt;
  mutate(State = factor(State, levels = State)) # Maintain sorted order

ggplot(pred_illegal_lasso_plot, aes(x = State, y = predicted_revenue_lasso)) +
  geom_col(fill = &quot;steelblue&quot;) +
  coord_flip() +
  scale_y_continuous(labels = scales::dollar) +
  labs(
    title = &quot;Predicted Annual Gambling Revenue (if legalized)&quot;,
    subtitle = &quot;LASSO model predictions for states without legal sports gambling&quot;,
    x = &quot;&quot;,
    y = &quot;Predicted Revenue&quot;
  ) +
  theme_minimal(base_size = 13)</code></pre>
<p><img src="analysis_files/figure-html/visualizing-predictions-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>This bar chart visualizes predicted gambling revenue for each
non-legal state, ranked from highest to lowest. Large states with urban
populations and strong young-adult demographics (such as California,
Texas, and Florida) show the highest predicted revenue, reinforcing the
idea that demographic scale influences potential market size. Smaller or
more rural states are projected to generate minimal revenue.</em></p>
</div>
<div id="distribution-of-predictions" class="section level2">
<h2>Distribution of Predictions</h2>
<pre class="r"><code>compare_df &lt;- tibble(
  group = c(rep(&quot;Actual Revenue (Legal States)&quot;, nrow(training_data)),
            rep(&quot;Predicted Revenue (Non-Legal States)&quot;, nrow(pred_illegal_lasso))),
  revenue = c(training_data$Revenue,
              pred_illegal_lasso$predicted_revenue_lasso)
)

ggplot(compare_df, aes(x = revenue, fill = group)) +
  geom_density(alpha = 0.4) +
  scale_x_continuous(labels = scales::dollar) +
  labs(
    title = &quot;Distribution of Actual vs Predicted Gambling Revenue&quot;,
    # Set the x-axis title 
    x = &quot;Revenue&quot;,
    y = &quot;Density&quot;,
    fill = &quot;&quot;
  ) +
  theme_minimal(base_size = 13)</code></pre>
<p><img src="analysis_files/figure-html/distribution-predictions-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>This density plot compares the distribution of observed gambling
revenue in legalized states with the predicted revenue for non-legal
states. The predicted values span a wider range, with some states
projecting higher revenue than current legal markets. This suggests that
expansion into a few large states could dramatically reshape the
national gambling landscape.</em></p>
</div>
<div id="population-vs-revenue-comparison" class="section level2">
<h2>Population vs Revenue Comparison</h2>
<pre class="r"><code>scatter_df &lt;- bind_rows(
  training_data |&gt; mutate(type = &quot;Actual Revenue&quot;),
  pred_illegal_lasso |&gt; 
    mutate(Revenue = predicted_revenue_lasso,
           type = &quot;Predicted Revenue&quot;)
)

ggplot(scatter_df, aes(x = total_pop, y = Revenue, color = type)) +
  geom_point(size = 3, alpha = 0.7) +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::dollar) +
  labs(
    title = &quot;Population vs Gambling Revenue&quot;,
    subtitle = &quot;Comparing actual and predicted states&quot;,
    x = &quot;Total Population&quot;,
    y = &quot;Revenue&quot;,
    color = &quot;&quot;
  ) +
  theme_minimal(base_size = 13)</code></pre>
<p><img src="analysis_files/figure-html/population-revenue-comparison-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>Here we compare how population relates to revenue in both actual
and predicted markets. Larger states show higher revenue but the plot
also shows that population alone does not fully explain gambling
revenue.</em></p>
</div>
<div id="distribution-statistics" class="section level2">
<h2>Distribution Statistics</h2>
<pre class="r"><code>summary_table &lt;- tibble(
  Metric = c(&quot;Min&quot;, &quot;1st Quartile&quot;, &quot;Median&quot;, &quot;Mean&quot;, &quot;3rd Quartile&quot;, &quot;Max&quot;),
  Actual_Revenue = summary(training_data$Revenue)[c(1,2,3,4,5,6)],
  Predicted_Revenue = summary(pred_illegal_lasso$predicted_revenue_lasso)[c(1,2,3,4,5,6)]
)

kable(summary_table, format = &quot;html&quot;, caption = &quot;Distribution Comparison: Actual vs Predicted Revenue&quot;) |&gt;
  kable_styling(full_width = FALSE, bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Distribution Comparison: Actual vs Predicted Revenue
</caption>
<thead>
<tr>
<th style="text-align:left;">
Metric
</th>
<th style="text-align:right;">
Actual_Revenue
</th>
<th style="text-align:right;">
Predicted_Revenue
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Min
</td>
<td style="text-align:right;">
920918
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
1st Quartile
</td>
<td style="text-align:right;">
60627294
</td>
<td style="text-align:right;">
61324867
</td>
</tr>
<tr>
<td style="text-align:left;">
Median
</td>
<td style="text-align:right;">
427397087
</td>
<td style="text-align:right;">
201795708
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean
</td>
<td style="text-align:right;">
443822044
</td>
<td style="text-align:right;">
627940272
</td>
</tr>
<tr>
<td style="text-align:left;">
3rd Quartile
</td>
<td style="text-align:right;">
599344939
</td>
<td style="text-align:right;">
471813698
</td>
</tr>
<tr>
<td style="text-align:left;">
Max
</td>
<td style="text-align:right;">
2059297238
</td>
<td style="text-align:right;">
3611645904
</td>
</tr>
</tbody>
</table>
<p><em>This table summarizes the distribution of actual versus predicted
revenue using key statistics (min, median, mean, and quartiles). The
predicted values show a higher mean and larger upper tail, reflecting
how several non-legal states exceed the revenue observed in legalized
states.</em></p>
</div>
</div>
<div id="model-diagnostics" class="section level1 tabset">
<h1 class="tabset">Model Diagnostics</h1>
<div id="lasso-cross-validation" class="section level2">
<h2>LASSO Cross-Validation</h2>
<pre class="r"><code>plot(lasso_cv)</code></pre>
<p><img src="analysis_files/figure-html/lasso-cv-plot-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>This figure shows the LASSO modelâ€™s cross-validation process.
Each point represents the modelâ€™s prediction error at a given penalty
value (lambda). The selected Î» minimizes mean-squared error, balancing
model simplicity and predictive accuracy. The curve illustrates how
adding too many predictors increases variance, while stronger
penalization improves stability.</em></p>
</div>
<div id="actual-vs-predicted" class="section level2">
<h2>Actual vs Predicted</h2>
<pre class="r"><code>pred_lasso_train &lt;- as.numeric(predict(lasso_model, newx = X_train))

training_data_lasso &lt;- training_data %&gt;%
  mutate(pred_lasso = pred_lasso_train)

ggplot(training_data_lasso, aes(x = Revenue, y = pred_lasso)) +
  geom_point(alpha = 0.7, color = &quot;darkgreen&quot;, size = 3) +
  geom_abline(slope = 1, intercept = 0, linetype = &quot;dashed&quot;, color = &quot;red&quot;) +
  scale_x_continuous(labels = scales::dollar) +
  scale_y_continuous(labels = scales::dollar) +
  labs(
    title = &quot;Actual vs Predicted Revenue (LASSO)&quot;,
    x = &quot;Actual Revenue&quot;,
    y = &quot;Predicted Revenue&quot;
  ) +
  theme_minimal(base_size = 13)</code></pre>
<p><img src="analysis_files/figure-html/actual-vs-predicted-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>This scatterplot compares predicted revenue to actual revenue in
legalized states. The points generally follow an upward trend,
indicating strong model performance.</em></p>
</div>
<div id="correlation-map" class="section level2">
<h2>Correlation Map</h2>
<pre class="r"><code>predictor_mat &lt;- training_data %&gt;%
  select(total_pop, median_income, pct_bachelors, pct_age_20_34,
         pct_urban, pct_poverty) %&gt;%
  as.matrix()

corr_mat &lt;- cor(predictor_mat)

corrplot(
  corr_mat,
  method = &quot;color&quot;,
  type = &quot;upper&quot;,
  col = viridis(200),
  tl.col = &quot;black&quot;,
  tl.srt = 45,
  title = &quot;Predictor Correlations&quot;,
  mar = c(0,0,1,0)
)</code></pre>
<p><img src="analysis_files/figure-html/correlation-map-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>This heatmap displays correlations among demographic predictors
used in the modeling process. Strong correlations across income,
education, population size, and poverty show multicollinearity.</em></p>
</div>
<div id="predictor-relationships" class="section level2">
<h2>Predictor Relationships</h2>
<pre class="r"><code>plot_df &lt;- training_data %&gt;%
  select(Revenue, total_pop, median_income, pct_bachelors,
         pct_age_20_34, pct_urban, pct_poverty) %&gt;%
  pivot_longer(-Revenue, names_to = &quot;predictor&quot;, values_to = &quot;value&quot;)

ggplot(plot_df, aes(x = value, y = Revenue)) +
  geom_point(alpha = 0.7) +
  facet_wrap(~ predictor, scales = &quot;free_x&quot;) +
  scale_y_continuous(labels = scales::dollar) +
  labs(
    title = &quot;Revenue vs Key Demographic Predictors (Legal States)&quot;,
    # Set x to NULL so the facet titles serve as the x-axis labels
    x = NULL, 
    y = &quot;Revenue&quot;
  ) +
  theme_minimal(base_size = 13)</code></pre>
<p><img src="analysis_files/figure-html/predictor-relationships-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>These scatterplots show the relationship between individual
demographic predictors and observed gambling revenue. While population
and urbanization show clearer positive associations, other variables,
such as poverty or median income, exhibit weak or inconsistent
relationships. This reinforces the idea that gambling revenue is driven
by a combination of demographic scale and specific high-engagement age
groups rather than socioeconomic factors alone.</em></p>
</div>
<div id="feature-importance" class="section level2">
<h2>Feature Importance</h2>
<pre class="r"><code>coef_mat &lt;- as.matrix(coef(lasso_cv, s = &quot;lambda.min&quot;))

coef_df &lt;- tibble(
  variable = rownames(coef_mat),
  coefficient = coef_mat[, &quot;lambda.min&quot;]
) %&gt;%
  filter(variable != &quot;(Intercept)&quot;) %&gt;%
  arrange(desc(abs(coefficient)))

ggplot(coef_df, aes(x = reorder(variable, abs(coefficient)), 
                    y = coefficient, 
                    fill = coefficient &gt; 0)) +
  geom_col() +
  coord_flip() +
  scale_fill_manual(values = c(&quot;TRUE&quot; = &quot;#1b9e77&quot;, &quot;FALSE&quot; = &quot;#d95f02&quot;), guide = &quot;none&quot;) +
  labs(
    title = &quot;LASSO Coefficients at Î»_min&quot;,
    subtitle = &quot;Positive (Green) vs Negative (Orange) Impact&quot;,
    x = &quot;&quot;,
    y = &quot;Coefficient Estimate&quot;
  ) +
  theme_minimal(base_size = 13)</code></pre>
<p><img src="analysis_files/figure-html/feature-importance-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="model-performance" class="section level2">
<h2>Model Performance</h2>
<pre class="r"><code># --- Linear Model Predictions ---
lm_pred &lt;- predict(fit_lm)

# --- LASSO Predictions ---
lasso_pred &lt;- as.numeric(predict(lasso_model, newx = X_train))

# --- True values ---
y_true &lt;- training_data$Revenue

# --- Comparison Metrics ---
model_metrics &lt;- tibble(
  Model = c(&quot;Linear Model&quot;, &quot;LASSO Model&quot;),
  RMSE  = c(rmse(y_true, lm_pred),
            rmse(y_true, lasso_pred)),
  MAE   = c(mae(y_true, lm_pred),
            mae(y_true, lasso_pred)),
  MAPE  = c(mape(y_true, lm_pred),
            mape(y_true, lasso_pred))
)

model_metrics %&gt;%
  mutate(
    RMSE = scales::dollar(RMSE),
    MAE  = scales::dollar(MAE),
    MAPE = scales::percent(MAPE)
  ) %&gt;%
  kable(format = &quot;html&quot;, caption = &quot;Model Performance Comparison: Linear Model vs LASSO&quot;) %&gt;%
  kable_styling(full_width = FALSE, bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;))</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Model Performance Comparison: Linear Model vs LASSO
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
RMSE
</th>
<th style="text-align:left;">
MAE
</th>
<th style="text-align:left;">
MAPE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Linear Model
</td>
<td style="text-align:left;">
$200,127,907
</td>
<td style="text-align:left;">
$133,430,779
</td>
<td style="text-align:left;">
344%
</td>
</tr>
<tr>
<td style="text-align:left;">
LASSO Model
</td>
<td style="text-align:left;">
$202,606,893
</td>
<td style="text-align:left;">
$132,201,269
</td>
<td style="text-align:left;">
191%
</td>
</tr>
</tbody>
</table>
<p><em>This table compares model performance metrics across the linear
regression and LASSO model. LASSO performs similarly in RMSE but
substantially better in MAPE, indicating higher stability for
lower-revenue states. The comparison highlights the value of
penalization when predictors show strong collinearity.</em></p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>We compared a standard linear regression to a LASSO regularized
model. Both models have sizeable error due to the extreme variability in
state gambling revenues. While the linear model slightly outperforms
LASSO in RMSE, the LASSO model achieves a much better MAPE (191% vs
344%), indicating more stable performance for low-revenue states.</p>
<p>LASSO also provides valuable model simplification: only two
predictors retain nonzero coefficientsâ€”pct_age_20_34 and pct_urban,
while income, population, poverty, and education are shrunk to zero.
This suggests strong multicollinearity among socioeconomic indicators,
with LASSO consolidating their predictive signal into a smaller set of
variables. The results highlight that demographic structure
(pct_age_20_34) and urbanization are the strongest predictors of sports
gambling markets.</p>
</div>

<footer style="background-color: #1e293b; color: #cbd5e1; padding: 40px 20px; margin-top: 50px; border-top: 3px solid #eab308; text-align: center; display: flex; flex-direction: column; align-items: center; justify-content: center;">
  
  <div style="max-width: 900px; width: 100%;">
    
    <p style="margin-bottom: 15px; font-size: 1.25rem; line-height: 1.5;">
      <strong style="color: #ffffff;">Team:</strong> Zakari, Kimia, Lawrence & Sukhman
    </p>
    
    <p style="margin-bottom: 15px; font-size: 1.1rem;">
      <a href="https://github.com/zakbillo/sports-betting" target="_blank" style="color: #eab308; text-decoration: none; font-weight: 500;">
        <i class="fa fa-github fa-lg" style="margin-right: 5px;"></i> View Our Source Code
      </a>
    </p>
    
    <p style="font-size: 1rem; color: #94a3b8; margin-bottom: 20px; font-style: italic;">
      "The house always wins... usually."
    </p>
    
    <p style="font-size: 0.95rem; color: #64748b; margin-top: 20px; border-top: 1px solid #334155; padding-top: 20px; display: inline-block;">
      2025 Data Science I (P8105) Final Project
    </p>

  </div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
