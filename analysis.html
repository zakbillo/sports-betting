<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Sports Betting Analysis</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />
<!-- Gambling Themed Favicon (Slot Machine Emoji) -->
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŽ°</text></svg>">

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Slot Machine</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="home.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="data.html">Data Processing</a>
</li>
<li>
  <a href="analysis.html">Analysis</a>
</li>
<li>
  <a href="report.html">Project Report</a>
</li>
<li>
  <a href="about.html">About Us</a>
</li>
<li>
  <a href="https://github.com/zakbillo/sports-betting">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Sports Betting Analysis</h1>

</div>


<style type="text/css">
/* General styling for website compatibility */
body {
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
h1, h2, h3 {
color: #2c3e50;
font-weight: 600;
}
.main-container {
max-width: 1500px;
margin-left: auto;
margin-right: auto;
}
</style>
<div id="exploratory-data-analysis" class="section level1">
<h1>Exploratory Data Analysis</h1>
<div id="import-data" class="section level2">
<h2>Import Data</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>total_state_revenue <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/total_state_revenue.csv&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>model_clean_2024 <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/model_clean_2024.csv&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>demographics_2024 <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/demographics_2024.csv&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># Pre-calculate yearly revenue summary for the Revenue by Year plot</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>yearly_revenue_summary <span class="ot">=</span> total_state_revenue <span class="sc">|&gt;</span> </span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">|&gt;</span> </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_Revenue =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># Pre-calculate data for Growth by State plot</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>top_states <span class="ot">=</span> total_state_revenue <span class="sc">|&gt;</span> </span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2024</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  <span class="fu">slice_max</span>(Revenue, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  <span class="fu">pull</span>(State)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>state_growth_plot_data <span class="ot">=</span> total_state_revenue <span class="sc">|&gt;</span> </span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>    <span class="at">State_Group =</span> <span class="fu">ifelse</span>(State <span class="sc">%in%</span> top_states, State, <span class="st">&quot;All Other&quot;</span>)</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, State_Group) <span class="sc">|&gt;</span> </span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Revenue =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">State_Group =</span> <span class="fu">fct_reorder</span>(State_Group, Revenue, <span class="at">.desc =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
</div>
</div>
<div id="gambling-visuals" class="section level1 tabset">
<h1 class="tabset">Gambling Visuals</h1>
<p>Below are several plots exploring the gambling revenue data. The
first is a plot of total US gambling revenue between 2018-2024. Second
is a plot of US gambling revenue across that time period among the top 5
ranked states in gambling revenue in 2024. Finally, the third plot
depicts how the top 5 ranked states in gambling revenue shifted from
2018-2024.</p>
<div id="revenue-by-year" class="section level2">
<h2>Revenue by Year</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Plotly bar chart showing total revenue by year</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">data =</span> yearly_revenue_summary <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)),</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>Year,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>Total_Revenue, </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;bar&quot;</span>, </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">color =</span> <span class="sc">~</span>Year,</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="co"># Use dollar format for text labels</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span>scales<span class="sc">::</span><span class="fu">dollar</span>(Total_Revenue <span class="sc">/</span> <span class="fl">1e9</span>, <span class="at">accuracy =</span> <span class="fl">0.01</span>, <span class="at">suffix =</span> <span class="st">&quot;B&quot;</span>),</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="at">textposition =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">&quot;x+y+text&quot;</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Total US Gambling Revenue (2018-2024)&quot;</span>,</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Year&quot;</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>    ),</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Total Revenue&quot;</span>,</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>      <span class="at">tickformat =</span> <span class="st">&quot;$,&quot;</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>    ),</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">FALSE</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>  )</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-935fd301eaae9ee418c9" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-935fd301eaae9ee418c9">{"x":{"visdat":{"3c8d77c55f8f":["function () ","plotlyVisDat"]},"cur_data":"3c8d77c55f8f","attrs":{"3c8d77c55f8f":{"x":{},"y":{},"text":{},"textposition":"outside","hoverinfo":"x+y+text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total US Gambling Revenue (2018-2024)","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2018","2019","2020","2021","2022","2023","2024"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Total Revenue","tickformat":"$,"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2018"],"y":[112745560],"text":"$0.11B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2018","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019"],"y":[558594169],"text":"$0.56B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2019","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020"],"y":[1541789027],"text":"$1.54B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2020","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2021"],"y":[4291686811],"text":"$4.29B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2021","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2022"],"y":[7603794087],"text":"$7.60B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2022","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2023"],"y":[11121558986],"text":"$11.12B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2023","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2024"],"y":[13924115452],"text":"$13.92B","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"2024","marker":{"color":"rgba(229,196,148,1)","line":{"color":"rgba(229,196,148,1)"}},"textfont":{"color":"rgba(229,196,148,1)"},"error_y":{"color":"rgba(229,196,148,1)"},"error_x":{"color":"rgba(229,196,148,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="growth-by-state" class="section level2">
<h2>Growth by State</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Plotly stacked bar chart showing revenue growth by state over time</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>state_growth_plot_data <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="fu">plot_ly</span>(</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>Year,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span>Revenue, </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;bar&quot;</span>, </span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>State_Group,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span>scales<span class="sc">::</span><span class="fu">dollar</span>(Revenue),</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">&quot;x+y+text&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;US Gambling Revenue Growth by State&quot;</span>,</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>      <span class="at">tickvals =</span> <span class="dv">2018</span><span class="sc">:</span><span class="dv">2024</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>    ),</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Revenue&quot;</span>,</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>      <span class="at">tickformat =</span> <span class="st">&quot;$,&quot;</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>    ),</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>    <span class="at">barmode =</span> <span class="st">&quot;stack&quot;</span>,</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">TRUE</span> </span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>  )</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-629aed8fd9496f20a3a5" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-629aed8fd9496f20a3a5">{"x":{"visdat":{"3c8d6c3af9cd":["function () ","plotlyVisDat"]},"cur_data":"3c8d6c3af9cd","attrs":{"3c8d6c3af9cd":{"x":{},"y":{},"text":{},"hoverinfo":"x+y+text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"US Gambling Revenue Growth by State","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","tickvals":[2018,2019,2020,2021,2022,2023,2024]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Revenue","tickformat":"$,"},"barmode":"stack","showlegend":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[16206578,147469423,679812733,2160290082,3668429838,5267109657,7220936855],"text":["$16,206,578","$147,469,423","$679,812,733","$2,160,290,082","$3,668,429,838","$5,267,109,657","$7,220,936,855"],"hoverinfo":["x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text"],"type":"bar","name":"All Other","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[0,0,193841046,810891340,1215977220,1535383261,1866642282],"text":["$0","$0","$193,841,046","$810,891,340","$1,215,977,220","$1,535,383,261","$1,866,642,282"],"hoverinfo":["x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text"],"type":"bar","name":"Illinois","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[94022393,299398035,398231302,814981641,762954971,1006681602,1094630610],"text":["$94,022,393","$299,398,035","$398,231,302","$814,981,641","$762,954,971","$1,006,681,602","$1,094,630,610"],"hoverinfo":["x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text"],"type":"bar","name":"New Jersey","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[2516589,111726711,269903946,505523748,597364960,686915514,778420570],"text":["$2,516,589","$111,726,711","$269,903,946","$505,523,748","$597,364,960","$686,915,514","$778,420,570"],"hoverinfo":["x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text"],"type":"bar","name":"Pennsylvania","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[0,0,0,0,1359067098,1689883800,2059297238],"text":["$0","$0","$0","$0","$1,359,067,098","$1,689,883,800","$2,059,297,238"],"hoverinfo":["x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text"],"type":"bar","name":"New York","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[0,0,0,0,0,935585152,904187897],"text":["$0","$0","$0","$0","$0","$935,585,152","$904,187,897"],"hoverinfo":["x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text","x+y+text"],"type":"bar","name":"Ohio","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="market-rank-shifts" class="section level2">
<h2>Market Rank Shifts</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># --- Data Processing ---</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>ranked_data <span class="ot">=</span> total_state_revenue <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="co"># Calculate rank, putting NAs last</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Rank =</span> <span class="fu">min_rank</span>(<span class="fu">desc</span>(Revenue))) <span class="sc">|&gt;</span> </span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co"># Identify &quot;States of Interest&quot; (Top 5 at any point)</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>focus_states <span class="ot">=</span> ranked_data <span class="sc">|&gt;</span> </span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="fu">filter</span>(Rank <span class="sc">&lt;=</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="fu">pull</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co"># Filter dataset</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>plot_data <span class="ot">=</span> ranked_data <span class="sc">|&gt;</span> </span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">%in%</span> focus_states) <span class="sc">|&gt;</span> </span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Rank)) <span class="sc">|&gt;</span>  <span class="co"># Remove years where rank is NA (not legalized yet)</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>  <span class="fu">arrange</span>(Year) </span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co"># --- Create Label Dataframes for Ends of Lines ---</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co"># Left Side Labels (2018)</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>labels_start <span class="ot">=</span> plot_data <span class="sc">|&gt;</span> </span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">min</span>(Year)) <span class="sc">|&gt;</span> </span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label_text =</span> <span class="fu">paste0</span>(<span class="st">&quot;#&quot;</span>, Rank, <span class="st">&quot; &quot;</span>, State))</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co"># Right Side Labels (2024)</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>labels_end <span class="ot">=</span> plot_data <span class="sc">|&gt;</span> </span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year)) <span class="sc">|&gt;</span> </span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label_text =</span> <span class="fu">paste0</span>(State, <span class="st">&quot; #&quot;</span>, Rank))</span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co"># --- Build Plotly Object ---</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">data =</span> plot_data) <span class="sc">|&gt;</span> </span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a>  </span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a>  <span class="co"># The Main Lines and Dots</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>Year, </span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span>Rank, </span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>State,</span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, </span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&#39;lines+markers&#39;</span>,</span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">3</span>),</span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a>    <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a>    <span class="co"># Custom Hover Text</span></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste0</span>(<span class="st">&quot;&lt;b&gt;&quot;</span>, State, <span class="st">&quot;&lt;/b&gt;&lt;br&gt;Year: &quot;</span>, Year, <span class="st">&quot;&lt;br&gt;Rank: &quot;</span>, Rank, <span class="st">&quot;&lt;br&gt;Revenue: &quot;</span>, scales<span class="sc">::</span><span class="fu">dollar</span>(Revenue)),</span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">&quot;text&quot;</span></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a>  </span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a>  <span class="co"># Left Side Text Labels (Start of line)</span></span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a>  <span class="fu">add_text</span>(</span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a>    <span class="at">data =</span> labels_start,</span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>Year, </span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span>Rank, </span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span>label_text,</span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>State,</span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a>    <span class="at">textposition =</span> <span class="st">&quot;middle left&quot;</span>,</span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">&quot;skip&quot;</span>,</span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">FALSE</span></span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a>  </span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a>  <span class="co"># Right Side Text Labels (End of line)</span></span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a>  <span class="fu">add_text</span>(</span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a>    <span class="at">data =</span> labels_end,</span>
<span id="cb4-63"><a href="#cb4-63" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>Year, </span>
<span id="cb4-64"><a href="#cb4-64" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span>Rank, </span>
<span id="cb4-65"><a href="#cb4-65" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span>label_text,</span>
<span id="cb4-66"><a href="#cb4-66" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>State,</span>
<span id="cb4-67"><a href="#cb4-67" tabindex="-1"></a>    <span class="at">textposition =</span> <span class="st">&quot;middle right&quot;</span>,</span>
<span id="cb4-68"><a href="#cb4-68" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">&quot;skip&quot;</span>,</span>
<span id="cb4-69"><a href="#cb4-69" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">FALSE</span></span>
<span id="cb4-70"><a href="#cb4-70" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb4-71"><a href="#cb4-71" tabindex="-1"></a>  </span>
<span id="cb4-72"><a href="#cb4-72" tabindex="-1"></a>  <span class="co"># Layout Settings</span></span>
<span id="cb4-73"><a href="#cb4-73" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb4-74"><a href="#cb4-74" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">&quot;&lt;b&gt;Shift in Top Gambling Markets (2018-2024)&lt;/b&gt;&quot;</span>),</span>
<span id="cb4-75"><a href="#cb4-75" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">FALSE</span>, </span>
<span id="cb4-76"><a href="#cb4-76" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(</span>
<span id="cb4-77"><a href="#cb4-77" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb4-78"><a href="#cb4-78" tabindex="-1"></a>      <span class="at">dtick =</span> <span class="dv">1</span>, </span>
<span id="cb4-79"><a href="#cb4-79" tabindex="-1"></a>      <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">2017</span>, <span class="dv">2025</span>), </span>
<span id="cb4-80"><a href="#cb4-80" tabindex="-1"></a>      <span class="at">showgrid =</span> <span class="cn">FALSE</span></span>
<span id="cb4-81"><a href="#cb4-81" tabindex="-1"></a>    ),</span>
<span id="cb4-82"><a href="#cb4-82" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(</span>
<span id="cb4-83"><a href="#cb4-83" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Revenue Rank&quot;</span>,</span>
<span id="cb4-84"><a href="#cb4-84" tabindex="-1"></a>      <span class="at">autorange =</span> <span class="st">&quot;reversed&quot;</span>, </span>
<span id="cb4-85"><a href="#cb4-85" tabindex="-1"></a>      <span class="at">zeroline =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-86"><a href="#cb4-86" tabindex="-1"></a>      <span class="at">showgrid =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-87"><a href="#cb4-87" tabindex="-1"></a>      <span class="at">tickmode =</span> <span class="st">&quot;array&quot;</span>,</span>
<span id="cb4-88"><a href="#cb4-88" tabindex="-1"></a>      <span class="at">tickvals =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">max</span>(plot_data<span class="sc">$</span>Rank, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb4-89"><a href="#cb4-89" tabindex="-1"></a>    ),</span>
<span id="cb4-90"><a href="#cb4-90" tabindex="-1"></a>    <span class="at">margin =</span> <span class="fu">list</span>(<span class="at">l =</span> <span class="dv">100</span>, <span class="at">r =</span> <span class="dv">100</span>) </span>
<span id="cb4-91"><a href="#cb4-91" tabindex="-1"></a>  )</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-d9e01f75ea4256c9af5f" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-d9e01f75ea4256c9af5f">{"x":{"visdat":{"3c8d21260497":["function () ","plotlyVisDat"],"3c8d46f76681":["function () ","data"],"3c8d1c6ac38d":["function () ","data"]},"cur_data":"3c8d1c6ac38d","attrs":{"3c8d21260497":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"color":{},"type":"scatter","mode":"lines+markers","line":{"width":3},"marker":{"size":8},"text":{},"hoverinfo":"text","inherit":true},"3c8d46f76681":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"text":{},"type":"scatter","mode":"text","color":{},"textposition":"middle left","hoverinfo":"skip","showlegend":false,"inherit":true},"3c8d1c6ac38d":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"text":{},"type":"scatter","mode":"text","color":{},"textposition":"middle right","hoverinfo":"skip","showlegend":false,"inherit":true}},"layout":{"margin":{"b":40,"l":100,"t":25,"r":100},"title":{"text":"<b>Shift in Top Gambling Markets (2018-2024)<\/b>"},"showlegend":false,"xaxis":{"domain":[0,1],"automargin":true,"title":"","dtick":1,"range":[2017,2025],"showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"title":"Revenue Rank","autorange":"reversed","zeroline":false,"showgrid":false,"tickmode":"array","tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2019,2020,2021,2022,2023,2024],"y":[5,7,11,16,20,21],"type":"scatter","mode":"lines+markers","line":{"color":"rgba(102,194,165,1)","width":3},"marker":{"color":"rgba(102,194,165,1)","size":8,"line":{"color":"rgba(102,194,165,1)"}},"text":["<b>Arkansas<\/b><br>Year: 2019<br>Rank: 5<br>Revenue: $24,305,962","<b>Arkansas<\/b><br>Year: 2020<br>Rank: 7<br>Revenue: $51,013,027","<b>Arkansas<\/b><br>Year: 2021<br>Rank: 11<br>Revenue: $78,763,591","<b>Arkansas<\/b><br>Year: 2022<br>Rank: 16<br>Revenue: $88,448,329","<b>Arkansas<\/b><br>Year: 2023<br>Rank: 20<br>Revenue: $103,188,842","<b>Arkansas<\/b><br>Year: 2024<br>Rank: 21<br>Revenue: $107,275,202"],"hoverinfo":["text","text","text","text","text","text"],"name":"Arkansas","textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2020,2021,2022,2023,2024],"y":[4,2,2,2,2],"type":"scatter","mode":"lines+markers","line":{"color":"rgba(219,161,118,1)","width":3},"marker":{"color":"rgba(219,161,118,1)","size":8,"line":{"color":"rgba(219,161,118,1)"}},"text":["<b>Illinois<\/b><br>Year: 2020<br>Rank: 4<br>Revenue: $193,841,046","<b>Illinois<\/b><br>Year: 2021<br>Rank: 2<br>Revenue: $810,891,340","<b>Illinois<\/b><br>Year: 2022<br>Rank: 2<br>Revenue: $1,215,977,220","<b>Illinois<\/b><br>Year: 2023<br>Rank: 2<br>Revenue: $1,535,383,261","<b>Illinois<\/b><br>Year: 2024<br>Rank: 2<br>Revenue: $1,866,642,282"],"hoverinfo":["text","text","text","text","text"],"name":"Illinois","textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023,2024],"y":[4,5,6,7,12,11],"type":"scatter","mode":"lines+markers","line":{"color":"rgba(217,150,141,1)","width":3},"marker":{"color":"rgba(217,150,141,1)","size":8,"line":{"color":"rgba(217,150,141,1)"}},"text":["<b>Indiana<\/b><br>Year: 2019<br>Rank: 4<br>Revenue: $41,576,946","<b>Indiana<\/b><br>Year: 2020<br>Rank: 5<br>Revenue: $136,395,416","<b>Indiana<\/b><br>Year: 2021<br>Rank: 6<br>Revenue: $308,304,353","<b>Indiana<\/b><br>Year: 2022<br>Rank: 7<br>Revenue: $386,888,311","<b>Indiana<\/b><br>Year: 2023<br>Rank: 12<br>Revenue: $404,363,766","<b>Indiana<\/b><br>Year: 2024<br>Rank: 11<br>Revenue: $484,278,308"],"hoverinfo":["text","text","text","text","text","text"],"name":"Indiana","textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2020,2021,2022,2023,2024],"y":[14,5,6,10,13],"type":"scatter","mode":"lines+markers","line":{"color":"rgba(152,158,202,1)","width":3},"marker":{"color":"rgba(152,158,202,1)","size":8,"line":{"color":"rgba(152,158,202,1)"}},"text":["<b>Michigan<\/b><br>Year: 2020<br>Rank: 14<br>Revenue: $18,276,857","<b>Michigan<\/b><br>Year: 2021<br>Rank: 5<br>Revenue: $319,522,216","<b>Michigan<\/b><br>Year: 2022<br>Rank: 6<br>Revenue: $418,647,137","<b>Michigan<\/b><br>Year: 2023<br>Rank: 10<br>Revenue: $434,438,031","<b>Michigan<\/b><br>Year: 2024<br>Rank: 13<br>Revenue: $481,495,654"],"hoverinfo":["text","text","text","text","text"],"name":"Michigan","textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[2,3,8,12,19,22,27],"type":"scatter","mode":"lines+markers","line":{"color":"rgba(215,144,197,1)","width":3},"marker":{"color":"rgba(215,144,197,1)","size":8,"line":{"color":"rgba(215,144,197,1)"}},"text":["<b>Mississippi<\/b><br>Year: 2018<br>Rank: 2<br>Revenue: $15,175,668","<b>Mississippi<\/b><br>Year: 2019<br>Rank: 3<br>Revenue: $44,451,372","<b>Mississippi<\/b><br>Year: 2020<br>Rank: 8<br>Revenue: $43,865,991","<b>Mississippi<\/b><br>Year: 2021<br>Rank: 12<br>Revenue: $65,868,087","<b>Mississippi<\/b><br>Year: 2022<br>Rank: 19<br>Revenue: $60,816,325","<b>Mississippi<\/b><br>Year: 2023<br>Rank: 22<br>Revenue: $51,224,141","<b>Mississippi<\/b><br>Year: 2024<br>Rank: 27<br>Revenue: $43,344,188"],"hoverinfo":["text","text","text","text","text","text","text"],"name":"Mississippi","textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2020,2021,2022,2023,2024],"y":[3,4,5,9,12],"type":"scatter","mode":"lines+markers","line":{"color":"rgba(205,180,144,1)","width":3},"marker":{"color":"rgba(205,180,144,1)","size":8,"line":{"color":"rgba(205,180,144,1)"}},"text":["<b>Nevada<\/b><br>Year: 2020<br>Rank: 3<br>Revenue: $200,943,000","<b>Nevada<\/b><br>Year: 2021<br>Rank: 4<br>Revenue: $445,145,000","<b>Nevada<\/b><br>Year: 2022<br>Rank: 5<br>Revenue: $449,698,000","<b>Nevada<\/b><br>Year: 2023<br>Rank: 9<br>Revenue: $481,393,000","<b>Nevada<\/b><br>Year: 2024<br>Rank: 12<br>Revenue: $482,121,000"],"hoverinfo":["text","text","text","text","text"],"name":"Nevada","textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[1,1,1,1,3,3,3],"type":"scatter","mode":"lines+markers","line":{"color":"rgba(186,217,78,1)","width":3},"marker":{"color":"rgba(186,217,78,1)","size":8,"line":{"color":"rgba(186,217,78,1)"}},"text":["<b>New Jersey<\/b><br>Year: 2018<br>Rank: 1<br>Revenue: $94,022,393","<b>New Jersey<\/b><br>Year: 2019<br>Rank: 1<br>Revenue: $299,398,035","<b>New Jersey<\/b><br>Year: 2020<br>Rank: 1<br>Revenue: $398,231,302","<b>New Jersey<\/b><br>Year: 2021<br>Rank: 1<br>Revenue: $814,981,641","<b>New Jersey<\/b><br>Year: 2022<br>Rank: 3<br>Revenue: $762,954,971","<b>New Jersey<\/b><br>Year: 2023<br>Rank: 3<br>Revenue: $1,006,681,602","<b>New Jersey<\/b><br>Year: 2024<br>Rank: 3<br>Revenue: $1,094,630,610"],"hoverinfo":["text","text","text","text","text","text","text"],"name":"New Jersey","textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2022,2023,2024],"y":[1,1,1],"type":"scatter","mode":"lines+markers","line":{"color":"rgba(247,217,52,1)","width":3},"marker":{"color":"rgba(247,217,52,1)","size":8,"line":{"color":"rgba(247,217,52,1)"}},"text":["<b>New York<\/b><br>Year: 2022<br>Rank: 1<br>Revenue: $1,359,067,098","<b>New York<\/b><br>Year: 2023<br>Rank: 1<br>Revenue: $1,689,883,800","<b>New York<\/b><br>Year: 2024<br>Rank: 1<br>Revenue: $2,059,297,238"],"hoverinfo":["text","text","text"],"name":"New York","textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2023,2024],"y":[4,4],"type":"scatter","mode":"lines+markers","line":{"color":"rgba(241,204,114,1)","width":3},"marker":{"color":"rgba(241,204,114,1)","size":8,"line":{"color":"rgba(241,204,114,1)"}},"text":["<b>Ohio<\/b><br>Year: 2023<br>Rank: 4<br>Revenue: $935,585,152","<b>Ohio<\/b><br>Year: 2024<br>Rank: 4<br>Revenue: $904,187,897"],"hoverinfo":["text","text"],"name":"Ohio","textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[3,2,2,3,4,5,5],"type":"scatter","mode":"lines+markers","line":{"color":"rgba(215,191,158,1)","width":3},"marker":{"color":"rgba(215,191,158,1)","size":8,"line":{"color":"rgba(215,191,158,1)"}},"text":["<b>Pennsylvania<\/b><br>Year: 2018<br>Rank: 3<br>Revenue: $2,516,589","<b>Pennsylvania<\/b><br>Year: 2019<br>Rank: 2<br>Revenue: $111,726,711","<b>Pennsylvania<\/b><br>Year: 2020<br>Rank: 2<br>Revenue: $269,903,946","<b>Pennsylvania<\/b><br>Year: 2021<br>Rank: 3<br>Revenue: $505,523,748","<b>Pennsylvania<\/b><br>Year: 2022<br>Rank: 4<br>Revenue: $597,364,960","<b>Pennsylvania<\/b><br>Year: 2023<br>Rank: 5<br>Revenue: $686,915,514","<b>Pennsylvania<\/b><br>Year: 2024<br>Rank: 5<br>Revenue: $778,420,570"],"hoverinfo":["text","text","text","text","text","text","text"],"name":"Pennsylvania","textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018,2019,2020,2021,2022,2023,2024],"y":[4,7,11,16,21,23,28],"type":"scatter","mode":"lines+markers","line":{"color":"rgba(179,179,179,1)","width":3},"marker":{"color":"rgba(179,179,179,1)","size":8,"line":{"color":"rgba(179,179,179,1)"}},"text":["<b>Rhode Island<\/b><br>Year: 2018<br>Rank: 4<br>Revenue: $1,030,910","<b>Rhode Island<\/b><br>Year: 2019<br>Rank: 7<br>Revenue: $17,806,694","<b>Rhode Island<\/b><br>Year: 2020<br>Rank: 11<br>Revenue: $24,067,477","<b>Rhode Island<\/b><br>Year: 2021<br>Rank: 16<br>Revenue: $38,751,495","<b>Rhode Island<\/b><br>Year: 2022<br>Rank: 21<br>Revenue: $49,298,062","<b>Rhode Island<\/b><br>Year: 2023<br>Rank: 23<br>Revenue: $40,277,816","<b>Rhode Island<\/b><br>Year: 2024<br>Rank: 28<br>Revenue: $38,051,914"],"hoverinfo":["text","text","text","text","text","text","text"],"name":"Rhode Island","textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018],"y":[2],"text":"#2 Mississippi","type":"scatter","mode":"text","textposition":"middle left","hoverinfo":"skip","showlegend":false,"name":"Mississippi","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"line":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018],"y":[1],"text":"#1 New Jersey","type":"scatter","mode":"text","textposition":"middle left","hoverinfo":"skip","showlegend":false,"name":"New Jersey","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"line":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018],"y":[3],"text":"#3 Pennsylvania","type":"scatter","mode":"text","textposition":"middle left","hoverinfo":"skip","showlegend":false,"name":"Pennsylvania","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"line":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2018],"y":[4],"text":"#4 Rhode Island","type":"scatter","mode":"text","textposition":"middle left","hoverinfo":"skip","showlegend":false,"name":"Rhode Island","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2024],"y":[21],"text":"Arkansas #21","type":"scatter","mode":"text","textposition":"middle right","hoverinfo":"skip","showlegend":false,"name":"Arkansas","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2024],"y":[2],"text":"Illinois #2","type":"scatter","mode":"text","textposition":"middle right","hoverinfo":"skip","showlegend":false,"name":"Illinois","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"line":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2024],"y":[11],"text":"Indiana #11","type":"scatter","mode":"text","textposition":"middle right","hoverinfo":"skip","showlegend":false,"name":"Indiana","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"line":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2024],"y":[13],"text":"Michigan #13","type":"scatter","mode":"text","textposition":"middle right","hoverinfo":"skip","showlegend":false,"name":"Michigan","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"line":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2024],"y":[27],"text":"Mississippi #27","type":"scatter","mode":"text","textposition":"middle right","hoverinfo":"skip","showlegend":false,"name":"Mississippi","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"line":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2024],"y":[12],"text":"Nevada #12","type":"scatter","mode":"text","textposition":"middle right","hoverinfo":"skip","showlegend":false,"name":"Nevada","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"line":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2024],"y":[3],"text":"New Jersey #3","type":"scatter","mode":"text","textposition":"middle right","hoverinfo":"skip","showlegend":false,"name":"New Jersey","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"line":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2024],"y":[1],"text":"New York #1","type":"scatter","mode":"text","textposition":"middle right","hoverinfo":"skip","showlegend":false,"name":"New York","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"line":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2024],"y":[4],"text":"Ohio #4","type":"scatter","mode":"text","textposition":"middle right","hoverinfo":"skip","showlegend":false,"name":"Ohio","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"line":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2024],"y":[5],"text":"Pennsylvania #5","type":"scatter","mode":"text","textposition":"middle right","hoverinfo":"skip","showlegend":false,"name":"Pennsylvania","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"line":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2024],"y":[28],"text":"Rhode Island #28","type":"scatter","mode":"text","textposition":"middle right","hoverinfo":"skip","showlegend":false,"name":"Rhode Island","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="demographic-visuals" class="section level1 tabset">
<h1 class="tabset">Demographic Visuals</h1>
<p>Below are exploratory plots of the demographic data in 2024. The
first plot shows the total population of each state in which gambling is
legal, arranged by order of descending gambling revenue. The second plot
shows gambling revenue by state in 2024. The third plot compares the
first two plots. The fourth plot shows the racial makeup in percentage
of the total population in each state in 2024, arranged in descending
order of total gambling revenue. The fifth plot depicts the percentage
of the total population in poverty and unemployed in 2024 in each state,
arranged in descending order of total gambling revenue.</p>
<div id="population" class="section level2">
<h2>Population</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Order by Revenue (descending)</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>population_plot_data <span class="ot">=</span> </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  model_clean_2024 <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">!=</span> <span class="st">&quot;Washington D.C.&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="at">State =</span> <span class="fu">as.factor</span>(State),</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    <span class="at">State =</span> <span class="fu">fct_reorder</span>(State, Revenue, <span class="at">.desc =</span> <span class="cn">TRUE</span>) </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="fu">arrange</span>(State) <span class="co"># Ensure data is physically sorted to match factor order</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co"># Extract the order for the axis</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>ordered_states <span class="ot">=</span> <span class="fu">levels</span>(population_plot_data<span class="sc">$</span>State)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>population_plot <span class="ot">=</span> </span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  population_plot_data <span class="sc">|&gt;</span> </span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  <span class="fu">plot_ly</span>(</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>State,</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span>total_pop, </span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;bar&quot;</span>, </span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>State,</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span>scales<span class="sc">::</span><span class="fu">comma</span>(total_pop),</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>    <span class="at">textposition =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">&quot;x+y+text&quot;</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Total Population by State (2024)&quot;</span>,</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;State (sorted by descending 2024 Revenue)&quot;</span>,</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>      <span class="at">tickangle =</span> <span class="dv">90</span>,        </span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>      <span class="at">tickmode =</span> <span class="st">&quot;array&quot;</span>,            </span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>      <span class="at">tickvals =</span> ordered_states,   </span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>      <span class="at">ticktext =</span> ordered_states</span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a>      ),</span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(</span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Total Population&quot;</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a>    ),</span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">FALSE</span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a>  )</span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a>population_plot</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-5dbbfc147a383700e70d" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-5dbbfc147a383700e70d">{"x":{"visdat":{"3c8d11265832":["function () ","plotlyVisDat"]},"cur_data":"3c8d11265832","attrs":{"3c8d11265832":{"x":{},"y":{},"text":{},"textposition":"outside","hoverinfo":"x+y+text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total Population by State (2024)","xaxis":{"domain":[0,1],"automargin":true,"title":"State (sorted by descending 2024 Revenue)","tickangle":90,"tickmode":"array","tickvals":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"],"ticktext":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Total Population"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["New York"],"y":[19867248],"text":"19,867,248","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New York","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Illinois"],"y":[12710158],"text":"12,710,158","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Illinois","marker":{"color":"rgba(153,184,149,1)","line":{"color":"rgba(153,184,149,1)"}},"textfont":{"color":"rgba(153,184,149,1)"},"error_y":{"color":"rgba(153,184,149,1)"},"error_x":{"color":"rgba(153,184,149,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Jersey"],"y":[9500851],"text":"9,500,851","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Jersey","marker":{"color":"rgba(189,173,133,1)","line":{"color":"rgba(189,173,133,1)"}},"textfont":{"color":"rgba(189,173,133,1)"},"error_y":{"color":"rgba(189,173,133,1)"},"error_x":{"color":"rgba(189,173,133,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Ohio"],"y":[11883304],"text":"11,883,304","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Ohio","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Pennsylvania"],"y":[13078751],"text":"13,078,751","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Pennsylvania","marker":{"color":"rgba(245,146,102,1)","line":{"color":"rgba(245,146,102,1)"}},"textfont":{"color":"rgba(245,146,102,1)"},"error_y":{"color":"rgba(245,146,102,1)"},"error_x":{"color":"rgba(245,146,102,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Massachusetts"],"y":[7136171],"text":"7,136,171","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Massachusetts","marker":{"color":"rgba(238,145,116,1)","line":{"color":"rgba(238,145,116,1)"}},"textfont":{"color":"rgba(238,145,116,1)"},"error_y":{"color":"rgba(238,145,116,1)"},"error_x":{"color":"rgba(238,145,116,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maryland"],"y":[6263220],"text":"6,263,220","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maryland","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Virginia"],"y":[8811195],"text":"8,811,195","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Virginia","marker":{"color":"rgba(193,154,165,1)","line":{"color":"rgba(193,154,165,1)"}},"textfont":{"color":"rgba(193,154,165,1)"},"error_y":{"color":"rgba(193,154,165,1)"},"error_x":{"color":"rgba(193,154,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["North Carolina"],"y":[11046024],"text":"11,046,024","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"North Carolina","marker":{"color":"rgba(162,158,189,1)","line":{"color":"rgba(162,158,189,1)"}},"textfont":{"color":"rgba(162,158,189,1)"},"error_y":{"color":"rgba(162,158,189,1)"},"error_x":{"color":"rgba(162,158,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Tennessee"],"y":[7227750],"text":"7,227,750","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Tennessee","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Indiana"],"y":[6924275],"text":"6,924,275","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Indiana","marker":{"color":"rgba(175,154,200,1)","line":{"color":"rgba(175,154,200,1)"}},"textfont":{"color":"rgba(175,154,200,1)"},"error_y":{"color":"rgba(175,154,200,1)"},"error_x":{"color":"rgba(175,154,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nevada"],"y":[3267467],"text":"3,267,467","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Nevada","marker":{"color":"rgba(196,149,198,1)","line":{"color":"rgba(196,149,198,1)"}},"textfont":{"color":"rgba(196,149,198,1)"},"error_y":{"color":"rgba(196,149,198,1)"},"error_x":{"color":"rgba(196,149,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Michigan"],"y":[10140459],"text":"10,140,459","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Michigan","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Colorado"],"y":[5957494],"text":"5,957,494","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Colorado","marker":{"color":"rgba(230,141,192,1)","line":{"color":"rgba(230,141,192,1)"}},"textfont":{"color":"rgba(230,141,192,1)"},"error_y":{"color":"rgba(230,141,192,1)"},"error_x":{"color":"rgba(230,141,192,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Louisiana"],"y":[4597740],"text":"4,597,740","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Louisiana","marker":{"color":"rgba(219,162,168,1)","line":{"color":"rgba(219,162,168,1)"}},"textfont":{"color":"rgba(219,162,168,1)"},"error_y":{"color":"rgba(219,162,168,1)"},"error_x":{"color":"rgba(219,162,168,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Arizona"],"y":[7582384],"text":"7,582,384","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Arizona","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kentucky"],"y":[4588372],"text":"4,588,372","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kentucky","marker":{"color":"rgba(189,198,118,1)","line":{"color":"rgba(189,198,118,1)"}},"textfont":{"color":"rgba(189,198,118,1)"},"error_y":{"color":"rgba(189,198,118,1)"},"error_x":{"color":"rgba(189,198,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Iowa"],"y":[3241488],"text":"3,241,488","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Iowa","marker":{"color":"rgba(169,214,89,1)","line":{"color":"rgba(169,214,89,1)"}},"textfont":{"color":"rgba(169,214,89,1)"},"error_y":{"color":"rgba(169,214,89,1)"},"error_x":{"color":"rgba(169,214,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Connecticut"],"y":[3675069],"text":"3,675,069","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Connecticut","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kansas"],"y":[2970606],"text":"2,970,606","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kansas","marker":{"color":"rgba(207,217,70,1)","line":{"color":"rgba(207,217,70,1)"}},"textfont":{"color":"rgba(207,217,70,1)"},"error_y":{"color":"rgba(207,217,70,1)"},"error_x":{"color":"rgba(207,217,70,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Oregon"],"y":[4272371],"text":"4,272,371","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Oregon","marker":{"color":"rgba(227,217,62,1)","line":{"color":"rgba(227,217,62,1)"}},"textfont":{"color":"rgba(227,217,62,1)"},"error_y":{"color":"rgba(227,217,62,1)"},"error_x":{"color":"rgba(227,217,62,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Hampshire"],"y":[1409032],"text":"1,409,032","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Hampshire","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["West Virginia"],"y":[1769979],"text":"1,769,979","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"West Virginia","marker":{"color":"rgba(252,214,66,1)","line":{"color":"rgba(252,214,66,1)"}},"textfont":{"color":"rgba(252,214,66,1)"},"error_y":{"color":"rgba(252,214,66,1)"},"error_x":{"color":"rgba(252,214,66,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maine"],"y":[1405012],"text":"1,405,012","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maine","marker":{"color":"rgba(247,209,92,1)","line":{"color":"rgba(247,209,92,1)"}},"textfont":{"color":"rgba(247,209,92,1)"},"error_y":{"color":"rgba(247,209,92,1)"},"error_x":{"color":"rgba(247,209,92,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mississippi"],"y":[2943045],"text":"2,943,045","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Mississippi","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Rhode Island"],"y":[1112308],"text":"1,112,308","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Rhode Island","marker":{"color":"rgba(234,199,134,1)","line":{"color":"rgba(234,199,134,1)"}},"textfont":{"color":"rgba(234,199,134,1)"},"error_y":{"color":"rgba(234,199,134,1)"},"error_x":{"color":"rgba(234,199,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Vermont"],"y":[648493],"text":"648,493","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Vermont","marker":{"color":"rgba(226,195,150,1)","line":{"color":"rgba(226,195,150,1)"}},"textfont":{"color":"rgba(226,195,150,1)"},"error_y":{"color":"rgba(226,195,150,1)"},"error_x":{"color":"rgba(226,195,150,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Wyoming"],"y":[587618],"text":"587,618","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Wyoming","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Delaware"],"y":[1051917],"text":"1,051,917","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Delaware","marker":{"color":"rgba(204,187,165,1)","line":{"color":"rgba(204,187,165,1)"}},"textfont":{"color":"rgba(204,187,165,1)"},"error_y":{"color":"rgba(204,187,165,1)"},"error_x":{"color":"rgba(204,187,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montana"],"y":[1137233],"text":"1,137,233","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Montana","marker":{"color":"rgba(192,183,172,1)","line":{"color":"rgba(192,183,172,1)"}},"textfont":{"color":"rgba(192,183,172,1)"},"error_y":{"color":"rgba(192,183,172,1)"},"error_x":{"color":"rgba(192,183,172,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["South Dakota"],"y":[924669],"text":"924,669","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"South Dakota","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="revenue" class="section level2">
<h2>Revenue</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Order by Revenue (descending)</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>revenue_plot_data <span class="ot">=</span> </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  model_clean_2024 <span class="sc">|&gt;</span> </span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">!=</span> <span class="st">&quot;Washington D.C.&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    <span class="at">State =</span> <span class="fu">as.factor</span>(State),</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>    <span class="at">State =</span> <span class="fu">fct_reorder</span>(State, Revenue, <span class="at">.desc =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="fu">arrange</span>(State) <span class="co"># Ensure data is physically sorted</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co"># Extract order</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>ordered_states <span class="ot">=</span> <span class="fu">levels</span>(revenue_plot_data<span class="sc">$</span>State)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>revenue_plot <span class="ot">=</span> </span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  revenue_plot_data <span class="sc">|&gt;</span> </span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  <span class="fu">plot_ly</span>(</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>State,</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span>Revenue, </span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;bar&quot;</span>, </span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>State,</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span>scales<span class="sc">::</span><span class="fu">dollar</span>(Revenue),</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>    <span class="at">textposition =</span> <span class="st">&quot;outside&quot;</span>,</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">&quot;x+y+text&quot;</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Gambling Revenue by State (2024)&quot;</span>,</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(</span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;State (sorted by descending 2024 Revenue)&quot;</span>,</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>      <span class="at">tickangle =</span> <span class="dv">90</span>,        </span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>      <span class="at">tickmode =</span> <span class="st">&quot;array&quot;</span>,            </span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>      <span class="at">tickvals =</span> ordered_states,   </span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>      <span class="at">ticktext =</span> ordered_states</span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a>      ),</span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(</span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Revenue&quot;</span>,</span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a>      <span class="at">tickformat =</span> <span class="st">&quot;$,&quot;</span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a>    ),</span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">FALSE</span></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a>  )</span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a>revenue_plot</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-3f12dc64fb37c8777bdd" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-3f12dc64fb37c8777bdd">{"x":{"visdat":{"3c8d2575b882":["function () ","plotlyVisDat"]},"cur_data":"3c8d2575b882","attrs":{"3c8d2575b882":{"x":{},"y":{},"text":{},"textposition":"outside","hoverinfo":"x+y+text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Gambling Revenue by State (2024)","xaxis":{"domain":[0,1],"automargin":true,"title":"State (sorted by descending 2024 Revenue)","tickangle":90,"tickmode":"array","tickvals":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"],"ticktext":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Revenue","tickformat":"$,"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["New York"],"y":[2059297238],"text":"$2,059,297,238","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New York","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Illinois"],"y":[1866642282],"text":"$1,866,642,282","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Illinois","marker":{"color":"rgba(153,184,149,1)","line":{"color":"rgba(153,184,149,1)"}},"textfont":{"color":"rgba(153,184,149,1)"},"error_y":{"color":"rgba(153,184,149,1)"},"error_x":{"color":"rgba(153,184,149,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Jersey"],"y":[1094630610],"text":"$1,094,630,610","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Jersey","marker":{"color":"rgba(189,173,133,1)","line":{"color":"rgba(189,173,133,1)"}},"textfont":{"color":"rgba(189,173,133,1)"},"error_y":{"color":"rgba(189,173,133,1)"},"error_x":{"color":"rgba(189,173,133,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Ohio"],"y":[904187897],"text":"$904,187,897","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Ohio","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Pennsylvania"],"y":[778420570],"text":"$778,420,570","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Pennsylvania","marker":{"color":"rgba(245,146,102,1)","line":{"color":"rgba(245,146,102,1)"}},"textfont":{"color":"rgba(245,146,102,1)"},"error_y":{"color":"rgba(245,146,102,1)"},"error_x":{"color":"rgba(245,146,102,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Massachusetts"],"y":[670694019],"text":"$670,694,019","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Massachusetts","marker":{"color":"rgba(238,145,116,1)","line":{"color":"rgba(238,145,116,1)"}},"textfont":{"color":"rgba(238,145,116,1)"},"error_y":{"color":"rgba(238,145,116,1)"},"error_x":{"color":"rgba(238,145,116,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maryland"],"y":[629812059],"text":"$629,812,059","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maryland","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Virginia"],"y":[615044067],"text":"$615,044,067","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Virginia","marker":{"color":"rgba(193,154,165,1)","line":{"color":"rgba(193,154,165,1)"}},"textfont":{"color":"rgba(193,154,165,1)"},"error_y":{"color":"rgba(193,154,165,1)"},"error_x":{"color":"rgba(193,154,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["North Carolina"],"y":[583645811],"text":"$583,645,811","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"North Carolina","marker":{"color":"rgba(162,158,189,1)","line":{"color":"rgba(162,158,189,1)"}},"textfont":{"color":"rgba(162,158,189,1)"},"error_y":{"color":"rgba(162,158,189,1)"},"error_x":{"color":"rgba(162,158,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Tennessee"],"y":[485802815],"text":"$485,802,815","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Tennessee","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Indiana"],"y":[484278308],"text":"$484,278,308","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Indiana","marker":{"color":"rgba(175,154,200,1)","line":{"color":"rgba(175,154,200,1)"}},"textfont":{"color":"rgba(175,154,200,1)"},"error_y":{"color":"rgba(175,154,200,1)"},"error_x":{"color":"rgba(175,154,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nevada"],"y":[482121000],"text":"$482,121,000","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Nevada","marker":{"color":"rgba(196,149,198,1)","line":{"color":"rgba(196,149,198,1)"}},"textfont":{"color":"rgba(196,149,198,1)"},"error_y":{"color":"rgba(196,149,198,1)"},"error_x":{"color":"rgba(196,149,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Michigan"],"y":[481495654],"text":"$481,495,654","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Michigan","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Colorado"],"y":[475176731],"text":"$475,176,731","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Colorado","marker":{"color":"rgba(230,141,192,1)","line":{"color":"rgba(230,141,192,1)"}},"textfont":{"color":"rgba(230,141,192,1)"},"error_y":{"color":"rgba(230,141,192,1)"},"error_x":{"color":"rgba(230,141,192,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Louisiana"],"y":[461224426],"text":"$461,224,426","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Louisiana","marker":{"color":"rgba(219,162,168,1)","line":{"color":"rgba(219,162,168,1)"}},"textfont":{"color":"rgba(219,162,168,1)"},"error_y":{"color":"rgba(219,162,168,1)"},"error_x":{"color":"rgba(219,162,168,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Arizona"],"y":[427397087],"text":"$427,397,087","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Arizona","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kentucky"],"y":[272086697],"text":"$272,086,697","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kentucky","marker":{"color":"rgba(189,198,118,1)","line":{"color":"rgba(189,198,118,1)"}},"textfont":{"color":"rgba(189,198,118,1)"},"error_y":{"color":"rgba(189,198,118,1)"},"error_x":{"color":"rgba(189,198,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Iowa"],"y":[218482781],"text":"$218,482,781","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Iowa","marker":{"color":"rgba(169,214,89,1)","line":{"color":"rgba(169,214,89,1)"}},"textfont":{"color":"rgba(169,214,89,1)"},"error_y":{"color":"rgba(169,214,89,1)"},"error_x":{"color":"rgba(169,214,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Connecticut"],"y":[187349516],"text":"$187,349,516","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Connecticut","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kansas"],"y":[145263244],"text":"$145,263,244","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kansas","marker":{"color":"rgba(207,217,70,1)","line":{"color":"rgba(207,217,70,1)"}},"textfont":{"color":"rgba(207,217,70,1)"},"error_y":{"color":"rgba(207,217,70,1)"},"error_x":{"color":"rgba(207,217,70,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Oregon"],"y":[80932000],"text":"$80,932,000","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Oregon","marker":{"color":"rgba(227,217,62,1)","line":{"color":"rgba(227,217,62,1)"}},"textfont":{"color":"rgba(227,217,62,1)"},"error_y":{"color":"rgba(227,217,62,1)"},"error_x":{"color":"rgba(227,217,62,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Hampshire"],"y":[78996303],"text":"$78,996,303","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Hampshire","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["West Virginia"],"y":[65866101],"text":"$65,866,101","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"West Virginia","marker":{"color":"rgba(252,214,66,1)","line":{"color":"rgba(252,214,66,1)"}},"textfont":{"color":"rgba(252,214,66,1)"},"error_y":{"color":"rgba(252,214,66,1)"},"error_x":{"color":"rgba(252,214,66,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maine"],"y":[55388488],"text":"$55,388,488","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maine","marker":{"color":"rgba(247,209,92,1)","line":{"color":"rgba(247,209,92,1)"}},"textfont":{"color":"rgba(247,209,92,1)"},"error_y":{"color":"rgba(247,209,92,1)"},"error_x":{"color":"rgba(247,209,92,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mississippi"],"y":[43344188],"text":"$43,344,188","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Mississippi","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Rhode Island"],"y":[38051914],"text":"$38,051,914","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Rhode Island","marker":{"color":"rgba(234,199,134,1)","line":{"color":"rgba(234,199,134,1)"}},"textfont":{"color":"rgba(234,199,134,1)"},"error_y":{"color":"rgba(234,199,134,1)"},"error_x":{"color":"rgba(234,199,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Vermont"],"y":[27347988],"text":"$27,347,988","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Vermont","marker":{"color":"rgba(226,195,150,1)","line":{"color":"rgba(226,195,150,1)"}},"textfont":{"color":"rgba(226,195,150,1)"},"error_y":{"color":"rgba(226,195,150,1)"},"error_x":{"color":"rgba(226,195,150,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Wyoming"],"y":[22810652],"text":"$22,810,652","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Wyoming","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Delaware"],"y":[14585100],"text":"$14,585,100","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Delaware","marker":{"color":"rgba(204,187,165,1)","line":{"color":"rgba(204,187,165,1)"}},"textfont":{"color":"rgba(204,187,165,1)"},"error_y":{"color":"rgba(204,187,165,1)"},"error_x":{"color":"rgba(204,187,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montana"],"y":[7186894],"text":"$7,186,894","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Montana","marker":{"color":"rgba(192,183,172,1)","line":{"color":"rgba(192,183,172,1)"}},"textfont":{"color":"rgba(192,183,172,1)"},"error_y":{"color":"rgba(192,183,172,1)"},"error_x":{"color":"rgba(192,183,172,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["South Dakota"],"y":[920918],"text":"$920,918","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"South Dakota","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="comparison" class="section level2">
<h2>Comparison</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Use the Plotly objects created in the previous chunks</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>combined_revenue_population <span class="ot">=</span> </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">subplot</span>(</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    population_plot, </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    revenue_plot, </span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    <span class="at">nrows =</span> <span class="dv">2</span>,       </span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    <span class="at">shareX =</span> <span class="cn">TRUE</span>,     </span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>    <span class="at">shareY =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>    <span class="at">titleY =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>    <span class="at">titleX =</span> <span class="cn">TRUE</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Population vs Revenue Comparison&quot;</span>,</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">FALSE</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>  )</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>combined_revenue_population</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-c8ad24577904c7d73c24" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-c8ad24577904c7d73c24">{"x":{"data":[{"x":["New York"],"y":[19867248],"text":"19,867,248","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New York","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Illinois"],"y":[12710158],"text":"12,710,158","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Illinois","marker":{"color":"rgba(153,184,149,1)","line":{"color":"rgba(153,184,149,1)"}},"textfont":{"color":"rgba(153,184,149,1)"},"error_y":{"color":"rgba(153,184,149,1)"},"error_x":{"color":"rgba(153,184,149,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Jersey"],"y":[9500851],"text":"9,500,851","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Jersey","marker":{"color":"rgba(189,173,133,1)","line":{"color":"rgba(189,173,133,1)"}},"textfont":{"color":"rgba(189,173,133,1)"},"error_y":{"color":"rgba(189,173,133,1)"},"error_x":{"color":"rgba(189,173,133,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Ohio"],"y":[11883304],"text":"11,883,304","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Ohio","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Pennsylvania"],"y":[13078751],"text":"13,078,751","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Pennsylvania","marker":{"color":"rgba(245,146,102,1)","line":{"color":"rgba(245,146,102,1)"}},"textfont":{"color":"rgba(245,146,102,1)"},"error_y":{"color":"rgba(245,146,102,1)"},"error_x":{"color":"rgba(245,146,102,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Massachusetts"],"y":[7136171],"text":"7,136,171","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Massachusetts","marker":{"color":"rgba(238,145,116,1)","line":{"color":"rgba(238,145,116,1)"}},"textfont":{"color":"rgba(238,145,116,1)"},"error_y":{"color":"rgba(238,145,116,1)"},"error_x":{"color":"rgba(238,145,116,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maryland"],"y":[6263220],"text":"6,263,220","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maryland","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Virginia"],"y":[8811195],"text":"8,811,195","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Virginia","marker":{"color":"rgba(193,154,165,1)","line":{"color":"rgba(193,154,165,1)"}},"textfont":{"color":"rgba(193,154,165,1)"},"error_y":{"color":"rgba(193,154,165,1)"},"error_x":{"color":"rgba(193,154,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["North Carolina"],"y":[11046024],"text":"11,046,024","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"North Carolina","marker":{"color":"rgba(162,158,189,1)","line":{"color":"rgba(162,158,189,1)"}},"textfont":{"color":"rgba(162,158,189,1)"},"error_y":{"color":"rgba(162,158,189,1)"},"error_x":{"color":"rgba(162,158,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Tennessee"],"y":[7227750],"text":"7,227,750","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Tennessee","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Indiana"],"y":[6924275],"text":"6,924,275","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Indiana","marker":{"color":"rgba(175,154,200,1)","line":{"color":"rgba(175,154,200,1)"}},"textfont":{"color":"rgba(175,154,200,1)"},"error_y":{"color":"rgba(175,154,200,1)"},"error_x":{"color":"rgba(175,154,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Nevada"],"y":[3267467],"text":"3,267,467","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Nevada","marker":{"color":"rgba(196,149,198,1)","line":{"color":"rgba(196,149,198,1)"}},"textfont":{"color":"rgba(196,149,198,1)"},"error_y":{"color":"rgba(196,149,198,1)"},"error_x":{"color":"rgba(196,149,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Michigan"],"y":[10140459],"text":"10,140,459","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Michigan","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Colorado"],"y":[5957494],"text":"5,957,494","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Colorado","marker":{"color":"rgba(230,141,192,1)","line":{"color":"rgba(230,141,192,1)"}},"textfont":{"color":"rgba(230,141,192,1)"},"error_y":{"color":"rgba(230,141,192,1)"},"error_x":{"color":"rgba(230,141,192,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Louisiana"],"y":[4597740],"text":"4,597,740","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Louisiana","marker":{"color":"rgba(219,162,168,1)","line":{"color":"rgba(219,162,168,1)"}},"textfont":{"color":"rgba(219,162,168,1)"},"error_y":{"color":"rgba(219,162,168,1)"},"error_x":{"color":"rgba(219,162,168,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Arizona"],"y":[7582384],"text":"7,582,384","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Arizona","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kentucky"],"y":[4588372],"text":"4,588,372","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kentucky","marker":{"color":"rgba(189,198,118,1)","line":{"color":"rgba(189,198,118,1)"}},"textfont":{"color":"rgba(189,198,118,1)"},"error_y":{"color":"rgba(189,198,118,1)"},"error_x":{"color":"rgba(189,198,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Iowa"],"y":[3241488],"text":"3,241,488","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Iowa","marker":{"color":"rgba(169,214,89,1)","line":{"color":"rgba(169,214,89,1)"}},"textfont":{"color":"rgba(169,214,89,1)"},"error_y":{"color":"rgba(169,214,89,1)"},"error_x":{"color":"rgba(169,214,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Connecticut"],"y":[3675069],"text":"3,675,069","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Connecticut","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kansas"],"y":[2970606],"text":"2,970,606","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kansas","marker":{"color":"rgba(207,217,70,1)","line":{"color":"rgba(207,217,70,1)"}},"textfont":{"color":"rgba(207,217,70,1)"},"error_y":{"color":"rgba(207,217,70,1)"},"error_x":{"color":"rgba(207,217,70,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Oregon"],"y":[4272371],"text":"4,272,371","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Oregon","marker":{"color":"rgba(227,217,62,1)","line":{"color":"rgba(227,217,62,1)"}},"textfont":{"color":"rgba(227,217,62,1)"},"error_y":{"color":"rgba(227,217,62,1)"},"error_x":{"color":"rgba(227,217,62,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Hampshire"],"y":[1409032],"text":"1,409,032","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Hampshire","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["West Virginia"],"y":[1769979],"text":"1,769,979","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"West Virginia","marker":{"color":"rgba(252,214,66,1)","line":{"color":"rgba(252,214,66,1)"}},"textfont":{"color":"rgba(252,214,66,1)"},"error_y":{"color":"rgba(252,214,66,1)"},"error_x":{"color":"rgba(252,214,66,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Maine"],"y":[1405012],"text":"1,405,012","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maine","marker":{"color":"rgba(247,209,92,1)","line":{"color":"rgba(247,209,92,1)"}},"textfont":{"color":"rgba(247,209,92,1)"},"error_y":{"color":"rgba(247,209,92,1)"},"error_x":{"color":"rgba(247,209,92,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mississippi"],"y":[2943045],"text":"2,943,045","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Mississippi","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Rhode Island"],"y":[1112308],"text":"1,112,308","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Rhode Island","marker":{"color":"rgba(234,199,134,1)","line":{"color":"rgba(234,199,134,1)"}},"textfont":{"color":"rgba(234,199,134,1)"},"error_y":{"color":"rgba(234,199,134,1)"},"error_x":{"color":"rgba(234,199,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Vermont"],"y":[648493],"text":"648,493","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Vermont","marker":{"color":"rgba(226,195,150,1)","line":{"color":"rgba(226,195,150,1)"}},"textfont":{"color":"rgba(226,195,150,1)"},"error_y":{"color":"rgba(226,195,150,1)"},"error_x":{"color":"rgba(226,195,150,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Wyoming"],"y":[587618],"text":"587,618","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Wyoming","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Delaware"],"y":[1051917],"text":"1,051,917","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Delaware","marker":{"color":"rgba(204,187,165,1)","line":{"color":"rgba(204,187,165,1)"}},"textfont":{"color":"rgba(204,187,165,1)"},"error_y":{"color":"rgba(204,187,165,1)"},"error_x":{"color":"rgba(204,187,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montana"],"y":[1137233],"text":"1,137,233","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Montana","marker":{"color":"rgba(192,183,172,1)","line":{"color":"rgba(192,183,172,1)"}},"textfont":{"color":"rgba(192,183,172,1)"},"error_y":{"color":"rgba(192,183,172,1)"},"error_x":{"color":"rgba(192,183,172,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["South Dakota"],"y":[924669],"text":"924,669","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"South Dakota","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New York"],"y":[2059297238],"text":"$2,059,297,238","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New York","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Illinois"],"y":[1866642282],"text":"$1,866,642,282","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Illinois","marker":{"color":"rgba(153,184,149,1)","line":{"color":"rgba(153,184,149,1)"}},"textfont":{"color":"rgba(153,184,149,1)"},"error_y":{"color":"rgba(153,184,149,1)"},"error_x":{"color":"rgba(153,184,149,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["New Jersey"],"y":[1094630610],"text":"$1,094,630,610","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Jersey","marker":{"color":"rgba(189,173,133,1)","line":{"color":"rgba(189,173,133,1)"}},"textfont":{"color":"rgba(189,173,133,1)"},"error_y":{"color":"rgba(189,173,133,1)"},"error_x":{"color":"rgba(189,173,133,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Ohio"],"y":[904187897],"text":"$904,187,897","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Ohio","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Pennsylvania"],"y":[778420570],"text":"$778,420,570","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Pennsylvania","marker":{"color":"rgba(245,146,102,1)","line":{"color":"rgba(245,146,102,1)"}},"textfont":{"color":"rgba(245,146,102,1)"},"error_y":{"color":"rgba(245,146,102,1)"},"error_x":{"color":"rgba(245,146,102,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Massachusetts"],"y":[670694019],"text":"$670,694,019","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Massachusetts","marker":{"color":"rgba(238,145,116,1)","line":{"color":"rgba(238,145,116,1)"}},"textfont":{"color":"rgba(238,145,116,1)"},"error_y":{"color":"rgba(238,145,116,1)"},"error_x":{"color":"rgba(238,145,116,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Maryland"],"y":[629812059],"text":"$629,812,059","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maryland","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Virginia"],"y":[615044067],"text":"$615,044,067","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Virginia","marker":{"color":"rgba(193,154,165,1)","line":{"color":"rgba(193,154,165,1)"}},"textfont":{"color":"rgba(193,154,165,1)"},"error_y":{"color":"rgba(193,154,165,1)"},"error_x":{"color":"rgba(193,154,165,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["North Carolina"],"y":[583645811],"text":"$583,645,811","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"North Carolina","marker":{"color":"rgba(162,158,189,1)","line":{"color":"rgba(162,158,189,1)"}},"textfont":{"color":"rgba(162,158,189,1)"},"error_y":{"color":"rgba(162,158,189,1)"},"error_x":{"color":"rgba(162,158,189,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Tennessee"],"y":[485802815],"text":"$485,802,815","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Tennessee","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Indiana"],"y":[484278308],"text":"$484,278,308","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Indiana","marker":{"color":"rgba(175,154,200,1)","line":{"color":"rgba(175,154,200,1)"}},"textfont":{"color":"rgba(175,154,200,1)"},"error_y":{"color":"rgba(175,154,200,1)"},"error_x":{"color":"rgba(175,154,200,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Nevada"],"y":[482121000],"text":"$482,121,000","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Nevada","marker":{"color":"rgba(196,149,198,1)","line":{"color":"rgba(196,149,198,1)"}},"textfont":{"color":"rgba(196,149,198,1)"},"error_y":{"color":"rgba(196,149,198,1)"},"error_x":{"color":"rgba(196,149,198,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Michigan"],"y":[481495654],"text":"$481,495,654","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Michigan","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Colorado"],"y":[475176731],"text":"$475,176,731","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Colorado","marker":{"color":"rgba(230,141,192,1)","line":{"color":"rgba(230,141,192,1)"}},"textfont":{"color":"rgba(230,141,192,1)"},"error_y":{"color":"rgba(230,141,192,1)"},"error_x":{"color":"rgba(230,141,192,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Louisiana"],"y":[461224426],"text":"$461,224,426","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Louisiana","marker":{"color":"rgba(219,162,168,1)","line":{"color":"rgba(219,162,168,1)"}},"textfont":{"color":"rgba(219,162,168,1)"},"error_y":{"color":"rgba(219,162,168,1)"},"error_x":{"color":"rgba(219,162,168,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Arizona"],"y":[427397087],"text":"$427,397,087","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Arizona","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Kentucky"],"y":[272086697],"text":"$272,086,697","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kentucky","marker":{"color":"rgba(189,198,118,1)","line":{"color":"rgba(189,198,118,1)"}},"textfont":{"color":"rgba(189,198,118,1)"},"error_y":{"color":"rgba(189,198,118,1)"},"error_x":{"color":"rgba(189,198,118,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Iowa"],"y":[218482781],"text":"$218,482,781","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Iowa","marker":{"color":"rgba(169,214,89,1)","line":{"color":"rgba(169,214,89,1)"}},"textfont":{"color":"rgba(169,214,89,1)"},"error_y":{"color":"rgba(169,214,89,1)"},"error_x":{"color":"rgba(169,214,89,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Connecticut"],"y":[187349516],"text":"$187,349,516","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Connecticut","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Kansas"],"y":[145263244],"text":"$145,263,244","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Kansas","marker":{"color":"rgba(207,217,70,1)","line":{"color":"rgba(207,217,70,1)"}},"textfont":{"color":"rgba(207,217,70,1)"},"error_y":{"color":"rgba(207,217,70,1)"},"error_x":{"color":"rgba(207,217,70,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Oregon"],"y":[80932000],"text":"$80,932,000","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Oregon","marker":{"color":"rgba(227,217,62,1)","line":{"color":"rgba(227,217,62,1)"}},"textfont":{"color":"rgba(227,217,62,1)"},"error_y":{"color":"rgba(227,217,62,1)"},"error_x":{"color":"rgba(227,217,62,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["New Hampshire"],"y":[78996303],"text":"$78,996,303","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"New Hampshire","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["West Virginia"],"y":[65866101],"text":"$65,866,101","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"West Virginia","marker":{"color":"rgba(252,214,66,1)","line":{"color":"rgba(252,214,66,1)"}},"textfont":{"color":"rgba(252,214,66,1)"},"error_y":{"color":"rgba(252,214,66,1)"},"error_x":{"color":"rgba(252,214,66,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Maine"],"y":[55388488],"text":"$55,388,488","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Maine","marker":{"color":"rgba(247,209,92,1)","line":{"color":"rgba(247,209,92,1)"}},"textfont":{"color":"rgba(247,209,92,1)"},"error_y":{"color":"rgba(247,209,92,1)"},"error_x":{"color":"rgba(247,209,92,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Mississippi"],"y":[43344188],"text":"$43,344,188","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Mississippi","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Rhode Island"],"y":[38051914],"text":"$38,051,914","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Rhode Island","marker":{"color":"rgba(234,199,134,1)","line":{"color":"rgba(234,199,134,1)"}},"textfont":{"color":"rgba(234,199,134,1)"},"error_y":{"color":"rgba(234,199,134,1)"},"error_x":{"color":"rgba(234,199,134,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Vermont"],"y":[27347988],"text":"$27,347,988","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Vermont","marker":{"color":"rgba(226,195,150,1)","line":{"color":"rgba(226,195,150,1)"}},"textfont":{"color":"rgba(226,195,150,1)"},"error_y":{"color":"rgba(226,195,150,1)"},"error_x":{"color":"rgba(226,195,150,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Wyoming"],"y":[22810652],"text":"$22,810,652","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Wyoming","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Delaware"],"y":[14585100],"text":"$14,585,100","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Delaware","marker":{"color":"rgba(204,187,165,1)","line":{"color":"rgba(204,187,165,1)"}},"textfont":{"color":"rgba(204,187,165,1)"},"error_y":{"color":"rgba(204,187,165,1)"},"error_x":{"color":"rgba(204,187,165,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["Montana"],"y":[7186894],"text":"$7,186,894","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"Montana","marker":{"color":"rgba(192,183,172,1)","line":{"color":"rgba(192,183,172,1)"}},"textfont":{"color":"rgba(192,183,172,1)"},"error_y":{"color":"rgba(192,183,172,1)"},"error_x":{"color":"rgba(192,183,172,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["South Dakota"],"y":[920918],"text":"$920,918","textposition":"outside","hoverinfo":"x+y+text","type":"bar","name":"South Dakota","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"State (sorted by descending 2024 Revenue)","tickangle":90,"tickmode":"array","tickvals":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"],"ticktext":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"],"anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"Revenue","tickformat":"$,","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"Total Population","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Population vs Revenue Comparison","showlegend":false,"hovermode":"closest"},"attrs":{"3c8d11265832":{"x":{},"y":{},"text":{},"textposition":"outside","hoverinfo":"x+y+text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"3c8d2575b882":{"x":{},"y":{},"text":{},"textposition":"outside","hoverinfo":"x+y+text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="racial-makeup" class="section level2">
<h2>Racial Makeup</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>race_plot_data <span class="ot">=</span> </span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  model_clean_2024 <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">!=</span> <span class="st">&quot;Washington D.C.&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="fu">select</span>(State, Revenue, pct_white, pct_black, pct_asian, pct_hispanic) <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    <span class="at">cols =</span> pct_white<span class="sc">:</span>pct_hispanic,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;race&quot;</span>,</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;percentage&quot;</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>      <span class="at">State =</span> <span class="fu">as.factor</span>(State),</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>      <span class="co"># 1. Reorder Factor Levels</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>      <span class="at">State =</span> <span class="fu">fct_reorder</span>(State, Revenue, <span class="at">.desc =</span> <span class="cn">TRUE</span>), </span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>      <span class="at">race =</span> <span class="fu">factor</span>(race, </span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;pct_white&quot;</span>, <span class="st">&quot;pct_black&quot;</span>, <span class="st">&quot;pct_asian&quot;</span>, <span class="st">&quot;pct_hispanic&quot;</span>),</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;% White&quot;</span>, <span class="st">&quot;% Black&quot;</span>, <span class="st">&quot;% Asian&quot;</span>, <span class="st">&quot;% Hispanic&quot;</span>))</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>  <span class="co"># 2. Arrange rows by State so lines draw sequentially left-to-right</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>  <span class="fu">arrange</span>(State)</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co"># Extract order for consistent axis</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>ordered_states_race <span class="ot">=</span> <span class="fu">levels</span>(race_plot_data<span class="sc">$</span>State)</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>race_plot_data <span class="sc">|&gt;</span> </span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>  <span class="fu">plot_ly</span>(</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>State,</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span>percentage,</span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>race,</span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>,</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&#39;lines+markers&#39;</span>,</span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(State, <span class="st">&quot;: &quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.2f%%&quot;</span>, percentage)),</span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">&#39;text&#39;</span>,          </span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">2</span>)</span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Racial Makeup by State (Sorted by Revenue)&quot;</span>,     </span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(</span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;State&quot;</span>,</span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a>      <span class="at">tickangle =</span> <span class="dv">90</span>,</span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a>      <span class="at">tickmode =</span> <span class="st">&quot;array&quot;</span>,</span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a>      <span class="at">tickvals =</span> ordered_states_race,</span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a>      <span class="at">ticktext =</span> ordered_states_race</span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a>    ),</span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(</span>
<span id="cb8-45"><a href="#cb8-45" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Percentage of Population&quot;</span>, </span>
<span id="cb8-46"><a href="#cb8-46" tabindex="-1"></a>      <span class="at">tickformat =</span> <span class="st">&quot;.1f%&quot;</span></span>
<span id="cb8-47"><a href="#cb8-47" tabindex="-1"></a>    ),</span>
<span id="cb8-48"><a href="#cb8-48" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">TRUE</span></span>
<span id="cb8-49"><a href="#cb8-49" tabindex="-1"></a>  )</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-98af6d587fb6a5dc3a62" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-98af6d587fb6a5dc3a62">{"x":{"visdat":{"3c8d1983b6ce":["function () ","plotlyVisDat"]},"cur_data":"3c8d1983b6ce","attrs":{"3c8d1983b6ce":{"x":{},"y":{},"mode":"lines+markers","text":{},"hoverinfo":"text","line":{"width":2},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Racial Makeup by State (Sorted by Revenue)","xaxis":{"domain":[0,1],"automargin":true,"title":"State","tickangle":90,"tickmode":"array","tickvals":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"],"ticktext":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Percentage of Population","tickformat":".1f%"},"showlegend":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"],"y":[0.54330297784574899,0.60189629428682201,0.52336227565299198,0.75988050124780104,0.73495565440461397,0.66718258292857602,0.46899358476949599,0.59293920972126901,0.60837754833775504,0.71959102071875802,0.76012607818147004,0.48017960089574002,0.73043853340366505,0.69359885213480699,0.56421372239404599,0.57312752822858903,0.81427312345206504,0.83172604680319695,0.63697987711251103,0.75049871978983396,0.73484442245301296,0.87559260541989103,0.89395297910314198,0.89681653964521302,0.55563676396385397,0.68538570252124398,0.90105829978118501,0.83302757914155101,0.58165805857306196,0.84627160836873405,0.79927736303477204],"mode":"lines+markers","text":["New York :  0.54%","Illinois :  0.60%","New Jersey :  0.52%","Ohio :  0.76%","Pennsylvania :  0.73%","Massachusetts :  0.67%","Maryland :  0.47%","Virginia :  0.59%","North Carolina :  0.61%","Tennessee :  0.72%","Indiana :  0.76%","Nevada :  0.48%","Michigan :  0.73%","Colorado :  0.69%","Louisiana :  0.56%","Arizona :  0.57%","Kentucky :  0.81%","Iowa :  0.83%","Connecticut :  0.64%","Kansas :  0.75%","Oregon :  0.73%","New Hampshire :  0.88%","West Virginia :  0.89%","Maine :  0.90%","Mississippi :  0.56%","Rhode Island :  0.69%","Vermont :  0.90%","Wyoming :  0.83%","Delaware :  0.58%","Montana :  0.85%","South Dakota :  0.80%"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"rgba(102,194,165,1)","width":2},"type":"scatter","name":"% White","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"],"y":[0.14235122046093099,0.13215421869657301,0.12901139066384701,0.121569051839455,0.105373058941179,0.068592806982904403,0.291403144069664,0.18221194741462399,0.19820045656247001,0.149972121337899,0.091196406844037806,0.095148933409273898,0.13016738196959299,0.042512338241549201,0.30411267274791498,0.047592947020356699,0.071121304026787693,0.041514267521582701,0.10757838832413801,0.053426809209972601,0.019374721905003101,0.015097598918974201,0.032174958007976401,0.020814768841832001,0.35880219296680799,0.055527785469492302,0.0096778222741031907,0.0078265131428921497,0.22039286369552,0.0030908353872953001,0.020277526336451201],"mode":"lines+markers","text":["New York :  0.14%","Illinois :  0.13%","New Jersey :  0.13%","Ohio :  0.12%","Pennsylvania :  0.11%","Massachusetts :  0.07%","Maryland :  0.29%","Virginia :  0.18%","North Carolina :  0.20%","Tennessee :  0.15%","Indiana :  0.09%","Nevada :  0.10%","Michigan :  0.13%","Colorado :  0.04%","Louisiana :  0.30%","Arizona :  0.05%","Kentucky :  0.07%","Iowa :  0.04%","Connecticut :  0.11%","Kansas :  0.05%","Oregon :  0.02%","New Hampshire :  0.02%","West Virginia :  0.03%","Maine :  0.02%","Mississippi :  0.36%","Rhode Island :  0.06%","Vermont :  0.01%","Wyoming :  0.01%","Delaware :  0.22%","Montana :  0.00%","South Dakota :  0.02%"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"rgba(252,141,98,1)","width":2},"type":"scatter","name":"% Black","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"],"y":[0.095325281085734695,0.063933430253187998,0.10665023585781901,0.027620012077449199,0.0417672910815413,0.077293411270553905,0.069358093760078704,0.071753717855523605,0.036272146430244998,0.020193559544809898,0.027088612165172499,0.094512048629718404,0.0374693098211826,0.034834445489999699,0.018233088430402802,0.039926229006602698,0.018778119995501701,0.025885951143425501,0.048035560692874103,0.030271264516398302,0.0494404629185995,0.0268602842234953,0.0070627956602875002,0.013376398208698599,0.0123141168415706,0.037539062921421,0.020575395570962201,0.0099009900990098994,0.048310845817683301,0.0082700730633036498,0.017061240292472201],"mode":"lines+markers","text":["New York :  0.10%","Illinois :  0.06%","New Jersey :  0.11%","Ohio :  0.03%","Pennsylvania :  0.04%","Massachusetts :  0.08%","Maryland :  0.07%","Virginia :  0.07%","North Carolina :  0.04%","Tennessee :  0.02%","Indiana :  0.03%","Nevada :  0.09%","Michigan :  0.04%","Colorado :  0.03%","Louisiana :  0.02%","Arizona :  0.04%","Kentucky :  0.02%","Iowa :  0.03%","Connecticut :  0.05%","Kansas :  0.03%","Oregon :  0.05%","New Hampshire :  0.03%","West Virginia :  0.01%","Maine :  0.01%","Mississippi :  0.01%","Rhode Island :  0.04%","Vermont :  0.02%","Wyoming :  0.01%","Delaware :  0.05%","Montana :  0.01%","South Dakota :  0.02%"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"rgba(141,160,203,1)","width":2},"type":"scatter","name":"% Asian","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"],"y":[0.20230723449971499,0.193763759663727,0.23465940051054399,0.051074431824684401,0.094245773162896104,0.13996231312282201,0.13267105418618499,0.115515886324159,0.119913735476222,0.078425374424959393,0.0904955392441808,0.30587210215129901,0.061321780404614799,0.23213586115235699,0.077783432729993399,0.32122627922827401,0.055060923569405403,0.078119678369933804,0.19232455227371201,0.142315069719781,0.15512229626125601,0.0503267491440932,0.023165246593321202,0.023394106242509,0.040274273753884197,0.18787601995130801,0.0268329804639372,0.110667134090515,0.116751606828295,0.048807939973602603,0.048608745399705201],"mode":"lines+markers","text":["New York :  0.20%","Illinois :  0.19%","New Jersey :  0.23%","Ohio :  0.05%","Pennsylvania :  0.09%","Massachusetts :  0.14%","Maryland :  0.13%","Virginia :  0.12%","North Carolina :  0.12%","Tennessee :  0.08%","Indiana :  0.09%","Nevada :  0.31%","Michigan :  0.06%","Colorado :  0.23%","Louisiana :  0.08%","Arizona :  0.32%","Kentucky :  0.06%","Iowa :  0.08%","Connecticut :  0.19%","Kansas :  0.14%","Oregon :  0.16%","New Hampshire :  0.05%","West Virginia :  0.02%","Maine :  0.02%","Mississippi :  0.04%","Rhode Island :  0.19%","Vermont :  0.03%","Wyoming :  0.11%","Delaware :  0.12%","Montana :  0.05%","South Dakota :  0.05%"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"rgba(231,138,195,1)","width":2},"type":"scatter","name":"% Hispanic","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="economic-stats" class="section level2">
<h2>Economic Stats</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>economic_plot_data <span class="ot">=</span> </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  model_clean_2024 <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    <span class="fu">filter</span>(State <span class="sc">!=</span> <span class="st">&quot;Washington D.C.&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>    <span class="fu">select</span>(State, Revenue, unemployment_rate, pct_poverty) <span class="sc">|&gt;</span> </span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;pct_poverty&quot;</span>, <span class="st">&quot;unemployment_rate&quot;</span>),</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">&quot;measure&quot;</span>,</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">&quot;percentage&quot;</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">as.factor</span>(State),</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>        <span class="co"># 1. Reorder Factor Levels</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">fct_reorder</span>(State, Revenue, <span class="at">.desc =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>        <span class="at">measure =</span> <span class="fu">factor</span>(measure, </span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;pct_poverty&quot;</span>, <span class="st">&quot;unemployment_rate&quot;</span>),</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;% in Poverty&quot;</span>, <span class="st">&quot;% Unemployed&quot;</span>))</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>    <span class="co"># 2. CRITICAL: Arrange rows by State</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>    <span class="fu">arrange</span>(State)</span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co"># Extract order</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>ordered_states_econ <span class="ot">=</span> <span class="fu">levels</span>(economic_plot_data<span class="sc">$</span>State)</span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>economic_plot_data <span class="sc">|&gt;</span> </span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a>  <span class="fu">plot_ly</span>(</span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>State,</span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span>percentage,</span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>measure,</span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>,</span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">&#39;lines+markers&#39;</span>,</span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(State, <span class="st">&quot;: &quot;</span>, <span class="fu">sprintf</span>(<span class="st">&quot;%.2f%%&quot;</span>, percentage)),</span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">&#39;text&#39;</span>,          </span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">2</span>)</span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Poverty &amp; Unemployment (Sorted by Revenue)&quot;</span>,     </span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(</span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;State&quot;</span>,</span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a>      <span class="at">tickangle =</span> <span class="dv">90</span>,</span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a>      <span class="at">tickmode =</span> <span class="st">&quot;array&quot;</span>,</span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a>      <span class="at">tickvals =</span> ordered_states_econ,</span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a>      <span class="at">ticktext =</span> ordered_states_econ</span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a>    ),</span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(</span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Percentage of Population&quot;</span>, </span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a>      <span class="at">tickformat =</span> <span class="st">&quot;.1f%&quot;</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a>    ),</span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">TRUE</span></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a>  )</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-0071c64e34163f5f829e" style="width:90%;height:460.8px;"></div>
<script type="application/json" data-for="htmlwidget-0071c64e34163f5f829e">{"x":{"visdat":{"3c8d2001c27c":["function () ","plotlyVisDat"]},"cur_data":"3c8d2001c27c","attrs":{"3c8d2001c27c":{"x":{},"y":{},"mode":"lines+markers","text":{},"hoverinfo":"text","line":{"width":2},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Poverty & Unemployment (Sorted by Revenue)","xaxis":{"domain":[0,1],"automargin":true,"title":"State","tickangle":90,"tickmode":"array","tickvals":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"],"ticktext":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Percentage of Population","tickformat":".1f%"},"showlegend":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"],"y":[0.13971302310467301,0.115789212711916,0.091957993636379104,0.12672748044722501,0.115776120959588,0.097188245112582894,0.090648953011687794,0.097491173585547999,0.125482468770931,0.134601236749816,0.122276666904688,0.11578105072867501,0.13445265492470501,0.096011668699054198,0.18687793455590701,0.116805302577693,0.15555882731262799,0.1133853317804,0.10195636795853,0.108541075711762,0.117864210641138,0.072048082719815901,0.16736124000602401,0.10598586639857301,0.17812326777482301,0.121662252898198,0.090159396590621804,0.10095231141522,0.095937176933724999,0.102255698611753,0.10411901484783199],"mode":"lines+markers","text":["New York :  0.14%","Illinois :  0.12%","New Jersey :  0.09%","Ohio :  0.13%","Pennsylvania :  0.12%","Massachusetts :  0.10%","Maryland :  0.09%","Virginia :  0.10%","North Carolina :  0.13%","Tennessee :  0.13%","Indiana :  0.12%","Nevada :  0.12%","Michigan :  0.13%","Colorado :  0.10%","Louisiana :  0.19%","Arizona :  0.12%","Kentucky :  0.16%","Iowa :  0.11%","Connecticut :  0.10%","Kansas :  0.11%","Oregon :  0.12%","New Hampshire :  0.07%","West Virginia :  0.17%","Maine :  0.11%","Mississippi :  0.18%","Rhode Island :  0.12%","Vermont :  0.09%","Wyoming :  0.10%","Delaware :  0.10%","Montana :  0.10%","South Dakota :  0.10%"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"rgba(102,194,165,1)","width":2},"type":"scatter","name":"% in Poverty","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New York","Illinois","New Jersey","Ohio","Pennsylvania","Massachusetts","Maryland","Virginia","North Carolina","Tennessee","Indiana","Nevada","Michigan","Colorado","Louisiana","Arizona","Kentucky","Iowa","Connecticut","Kansas","Oregon","New Hampshire","West Virginia","Maine","Mississippi","Rhode Island","Vermont","Wyoming","Delaware","Montana","South Dakota"],"y":[0.053222478733459602,0.051274607770050502,0.054064165521133703,0.039911548884883699,0.043452420240770902,0.040706371215408002,0.043456375838926198,0.036202912799668301,0.039885912529005099,0.042269914198456097,0.040963569793122601,0.0628302798451012,0.044997010233710701,0.042770318157260498,0.051515239241408502,0.045637548016821898,0.048706068993665502,0.031819046666200203,0.049482889745232503,0.036714328173470201,0.048540222510555599,0.027765141176113801,0.046344915416549601,0.027231558189705098,0.046047512310693997,0.050414644261615203,0.026674037344768999,0.034279547663393403,0.051067189839202803,0.029626135877790099,0.0280759936503443],"mode":"lines+markers","text":["New York :  0.05%","Illinois :  0.05%","New Jersey :  0.05%","Ohio :  0.04%","Pennsylvania :  0.04%","Massachusetts :  0.04%","Maryland :  0.04%","Virginia :  0.04%","North Carolina :  0.04%","Tennessee :  0.04%","Indiana :  0.04%","Nevada :  0.06%","Michigan :  0.04%","Colorado :  0.04%","Louisiana :  0.05%","Arizona :  0.05%","Kentucky :  0.05%","Iowa :  0.03%","Connecticut :  0.05%","Kansas :  0.04%","Oregon :  0.05%","New Hampshire :  0.03%","West Virginia :  0.05%","Maine :  0.03%","Mississippi :  0.05%","Rhode Island :  0.05%","Vermont :  0.03%","Wyoming :  0.03%","Delaware :  0.05%","Montana :  0.03%","South Dakota :  0.03%"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"rgba(141,160,203,1)","width":2},"type":"scatter","name":"% Unemployed","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="predictive-modeling" class="section level1">
<h1>Predictive Modeling</h1>
<div id="model-setup" class="section level2">
<h2>Model Setup</h2>
<p>We begin by building our training dataset, fitting a standard linear
model for comparison, and handling missing values.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Build training dataset</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> model_clean_2024 <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    State, Revenue, total_pop, median_income, </span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    pct_bachelors, pct_age_20_34, pct_urban, pct_poverty</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co"># Fit Linear Model for later comparison</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>fit_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  Revenue <span class="sc">~</span> total_pop <span class="sc">+</span> median_income <span class="sc">+</span> pct_bachelors <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>    pct_age_20_34 <span class="sc">+</span> pct_urban <span class="sc">+</span> pct_poverty,</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>  <span class="at">data =</span> training_data</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co"># Prepare Illegal States Data</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>states_no_gambling <span class="ot">&lt;-</span> demographics_2024 <span class="sc">|&gt;</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>  <span class="fu">anti_join</span>(training_data, <span class="at">by =</span> <span class="st">&quot;State&quot;</span>)</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>newdata_illegal <span class="ot">&lt;-</span> states_no_gambling <span class="sc">|&gt;</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>    State, total_pop, median_income, pct_bachelors, </span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>    pct_age_20_34, pct_urban, pct_poverty</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span></code></pre></div>
</div>
<div id="lasso-regression" class="section level2">
<h2>LASSO Regression</h2>
<p>We implement a LASSO regression to handle multicollinearity and
perform feature selection.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Build design matrix</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  Revenue <span class="sc">~</span> total_pop <span class="sc">+</span> median_income <span class="sc">+</span> pct_bachelors <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    pct_age_20_34 <span class="sc">+</span> pct_urban <span class="sc">+</span> pct_poverty,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="at">data =</span> training_data)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> training_data<span class="sc">$</span>Revenue</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co"># Cross-validated LASSO</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>lasso_cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(X_train, y_train, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">nfolds =</span> <span class="dv">5</span>, <span class="at">standardize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>lasso_model <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(X_train, y_train, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> lasso_cv<span class="sc">$</span>lambda.min, <span class="at">standardize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co"># Predictions for non-gambling states</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>X_new <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>  <span class="sc">~</span> total_pop <span class="sc">+</span> median_income <span class="sc">+</span> pct_bachelors <span class="sc">+</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>    pct_age_20_34 <span class="sc">+</span> pct_urban <span class="sc">+</span> pct_poverty,</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>  <span class="at">data =</span> newdata_illegal)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>pred_illegal_lasso <span class="ot">&lt;-</span> newdata_illegal <span class="sc">|&gt;</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>    <span class="at">predicted_revenue_lasso =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(lasso_model, <span class="at">newx =</span> X_new)),</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>    <span class="at">predicted_revenue_lasso =</span> <span class="fu">pmax</span>(predicted_revenue_lasso, <span class="dv">0</span>) <span class="co"># Remove negative predictions</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(predicted_revenue_lasso))</span></code></pre></div>
</div>
<div id="prediction-results" class="section level2">
<h2>Prediction Results</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>pred_table <span class="ot">&lt;-</span> pred_illegal_lasso <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>    <span class="at">Predicted_Revenue =</span> scales<span class="sc">::</span><span class="fu">dollar</span>(predicted_revenue_lasso),</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    <span class="at">Population =</span> scales<span class="sc">::</span><span class="fu">comma</span>(total_pop),</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    <span class="at">Median_Income =</span> scales<span class="sc">::</span><span class="fu">dollar</span>(median_income)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    State, Population, Median_Income, pct_bachelors, </span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    pct_age_20_34, pct_urban, pct_poverty, Predicted_Revenue</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  )</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="fu">kable</span>(pred_table, <span class="at">format =</span> <span class="st">&quot;html&quot;</span>, </span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Predicted Annual Gambling Revenue for Non-Legal States (LASSO Model)&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span>))</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Predicted Annual Gambling Revenue for Non-Legal States (LASSO Model)
</caption>
<thead>
<tr>
<th style="text-align:left;">
State
</th>
<th style="text-align:left;">
Population
</th>
<th style="text-align:left;">
Median_Income
</th>
<th style="text-align:right;">
pct_bachelors
</th>
<th style="text-align:right;">
pct_age_20_34
</th>
<th style="text-align:right;">
pct_urban
</th>
<th style="text-align:right;">
pct_poverty
</th>
<th style="text-align:left;">
Predicted_Revenue
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:left;">
39,431,263
</td>
<td style="text-align:left;">
$100,149
</td>
<td style="text-align:right;">
0.3812365
</td>
<td style="text-align:right;">
0.0652504
</td>
<td style="text-align:right;">
0.9423663
</td>
<td style="text-align:right;">
0.1180257
</td>
<td style="text-align:left;">
$3,611,645,904
</td>
</tr>
<tr>
<td style="text-align:left;">
Texas
</td>
<td style="text-align:left;">
31,290,831
</td>
<td style="text-align:left;">
$79,721
</td>
<td style="text-align:right;">
0.3516383
</td>
<td style="text-align:right;">
0.0694787
</td>
<td style="text-align:right;">
0.8372028
</td>
<td style="text-align:right;">
0.1340909
</td>
<td style="text-align:left;">
$2,765,125,447
</td>
</tr>
<tr>
<td style="text-align:left;">
Florida
</td>
<td style="text-align:left;">
23,372,215
</td>
<td style="text-align:left;">
$77,735
</td>
<td style="text-align:right;">
0.3583638
</td>
<td style="text-align:right;">
0.0582353
</td>
<td style="text-align:right;">
0.9153419
</td>
<td style="text-align:right;">
0.1204723
</td>
<td style="text-align:left;">
$2,135,268,431
</td>
</tr>
<tr>
<td style="text-align:left;">
Georgia
</td>
<td style="text-align:left;">
11,180,878
</td>
<td style="text-align:left;">
$79,991
</td>
<td style="text-align:right;">
0.3631028
</td>
<td style="text-align:right;">
0.0673810
</td>
<td style="text-align:right;">
0.7406697
</td>
<td style="text-align:right;">
0.1258716
</td>
<td style="text-align:left;">
$922,707,171
</td>
</tr>
<tr>
<td style="text-align:left;">
Washington
</td>
<td style="text-align:left;">
7,958,180
</td>
<td style="text-align:left;">
$99,389
</td>
<td style="text-align:right;">
0.4101713
</td>
<td style="text-align:right;">
0.0616117
</td>
<td style="text-align:right;">
0.8337185
</td>
<td style="text-align:right;">
0.0993223
</td>
<td style="text-align:left;">
$736,907,744
</td>
</tr>
<tr>
<td style="text-align:left;">
Minnesota
</td>
<td style="text-align:left;">
5,793,151
</td>
<td style="text-align:left;">
$87,117
</td>
<td style="text-align:right;">
0.4003043
</td>
<td style="text-align:right;">
0.0634185
</td>
<td style="text-align:right;">
0.7187871
</td>
<td style="text-align:right;">
0.0933292
</td>
<td style="text-align:left;">
$471,813,698
</td>
</tr>
<tr>
<td style="text-align:left;">
Missouri
</td>
<td style="text-align:left;">
6,245,466
</td>
<td style="text-align:left;">
$71,589
</td>
<td style="text-align:right;">
0.3347161
</td>
<td style="text-align:right;">
0.0670586
</td>
<td style="text-align:right;">
0.6946748
</td>
<td style="text-align:right;">
0.1226321
</td>
<td style="text-align:left;">
$443,937,391
</td>
</tr>
<tr>
<td style="text-align:left;">
Wisconsin
</td>
<td style="text-align:left;">
5,960,975
</td>
<td style="text-align:left;">
$77,488
</td>
<td style="text-align:right;">
0.3455598
</td>
<td style="text-align:right;">
0.0673242
</td>
<td style="text-align:right;">
0.6708314
</td>
<td style="text-align:right;">
0.1032844
</td>
<td style="text-align:left;">
$425,197,336
</td>
</tr>
<tr>
<td style="text-align:left;">
South Carolina
</td>
<td style="text-align:left;">
5,478,831
</td>
<td style="text-align:left;">
$72,350
</td>
<td style="text-align:right;">
0.3333325
</td>
<td style="text-align:right;">
0.0634482
</td>
<td style="text-align:right;">
0.6794803
</td>
<td style="text-align:right;">
0.1325996
</td>
<td style="text-align:left;">
$398,844,164
</td>
</tr>
<tr>
<td style="text-align:left;">
Alabama
</td>
<td style="text-align:left;">
5,157,699
</td>
<td style="text-align:left;">
$66,659
</td>
<td style="text-align:right;">
0.2985358
</td>
<td style="text-align:right;">
0.0643101
</td>
<td style="text-align:right;">
0.5773724
</td>
<td style="text-align:right;">
0.1518804
</td>
<td style="text-align:left;">
$327,792,352
</td>
</tr>
<tr>
<td style="text-align:left;">
Oklahoma
</td>
<td style="text-align:left;">
4,095,393
</td>
<td style="text-align:left;">
$66,148
</td>
<td style="text-align:right;">
0.2931934
</td>
<td style="text-align:right;">
0.0701015
</td>
<td style="text-align:right;">
0.6462195
</td>
<td style="text-align:right;">
0.1490811
</td>
<td style="text-align:left;">
$201,795,708
</td>
</tr>
<tr>
<td style="text-align:left;">
Hawaii
</td>
<td style="text-align:left;">
1,446,146
</td>
<td style="text-align:left;">
$100,745
</td>
<td style="text-align:right;">
0.3775749
</td>
<td style="text-align:right;">
0.0586905
</td>
<td style="text-align:right;">
0.8606301
</td>
<td style="text-align:right;">
0.0998640
</td>
<td style="text-align:left;">
$172,063,243
</td>
</tr>
<tr>
<td style="text-align:left;">
Utah
</td>
<td style="text-align:left;">
3,503,613
</td>
<td style="text-align:left;">
$96,658
</td>
<td style="text-align:right;">
0.3911757
</td>
<td style="text-align:right;">
0.0874363
</td>
<td style="text-align:right;">
0.8978141
</td>
<td style="text-align:right;">
0.0832570
</td>
<td style="text-align:left;">
$148,267,944
</td>
</tr>
<tr>
<td style="text-align:left;">
Puerto Rico
</td>
<td style="text-align:left;">
3,203,295
</td>
<td style="text-align:left;">
$27,213
</td>
<td style="text-align:right;">
0.2969966
</td>
<td style="text-align:right;">
0.0663738
</td>
<td style="text-align:right;">
0.9187534
</td>
<td style="text-align:right;">
0.3730844
</td>
<td style="text-align:left;">
$111,180,446
</td>
</tr>
<tr>
<td style="text-align:left;">
Arkansas
</td>
<td style="text-align:left;">
3,088,354
</td>
<td style="text-align:left;">
$62,106
</td>
<td style="text-align:right;">
0.2711732
</td>
<td style="text-align:right;">
0.0664785
</td>
<td style="text-align:right;">
0.5547613
</td>
<td style="text-align:right;">
0.1553574
</td>
<td style="text-align:left;">
$107,040,120
</td>
</tr>
<tr>
<td style="text-align:left;">
New Mexico
</td>
<td style="text-align:left;">
2,130,256
</td>
<td style="text-align:left;">
$67,816
</td>
<td style="text-align:right;">
0.3178310
</td>
<td style="text-align:right;">
0.0681773
</td>
<td style="text-align:right;">
0.7454714
</td>
<td style="text-align:right;">
0.1641940
</td>
<td style="text-align:left;">
$61,324,867
</td>
</tr>
<tr>
<td style="text-align:left;">
Idaho
</td>
<td style="text-align:left;">
2,001,619
</td>
<td style="text-align:left;">
$81,166
</td>
<td style="text-align:right;">
0.3302656
</td>
<td style="text-align:right;">
0.0708042
</td>
<td style="text-align:right;">
0.6924218
</td>
<td style="text-align:right;">
0.1046070
</td>
<td style="text-align:left;">
$51,404,787
</td>
</tr>
<tr>
<td style="text-align:left;">
District of Columbia
</td>
<td style="text-align:left;">
702,250
</td>
<td style="text-align:left;">
$109,707
</td>
<td style="text-align:right;">
0.6546496
</td>
<td style="text-align:right;">
0.0729740
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
0.1731169
</td>
<td style="text-align:left;">
$51,027,257
</td>
</tr>
<tr>
<td style="text-align:left;">
Nebraska
</td>
<td style="text-align:left;">
2,005,466
</td>
<td style="text-align:left;">
$76,376
</td>
<td style="text-align:right;">
0.3535887
</td>
<td style="text-align:right;">
0.0714562
</td>
<td style="text-align:right;">
0.7300536
</td>
<td style="text-align:right;">
0.1087362
</td>
<td style="text-align:left;">
$43,401,693
</td>
</tr>
<tr>
<td style="text-align:left;">
Alaska
</td>
<td style="text-align:left;">
740,133
</td>
<td style="text-align:left;">
$95,665
</td>
<td style="text-align:right;">
0.3275460
</td>
<td style="text-align:right;">
0.0682283
</td>
<td style="text-align:right;">
0.6489949
</td>
<td style="text-align:right;">
0.1016680
</td>
<td style="text-align:left;">
$0
</td>
</tr>
<tr>
<td style="text-align:left;">
North Dakota
</td>
<td style="text-align:left;">
796,568
</td>
<td style="text-align:left;">
$77,871
</td>
<td style="text-align:right;">
0.3395173
</td>
<td style="text-align:right;">
0.0773305
</td>
<td style="text-align:right;">
0.6096684
</td>
<td style="text-align:right;">
0.1112829
</td>
<td style="text-align:left;">
$0
</td>
</tr>
</tbody>
</table>
<p><em>This table presents the predicted gambling revenue for each state
that has not yet legalized sports betting. Using the LASSO model, we
estimated annual revenue based on demographic characteristics, including
population size, educational attainment, urbanization, and poverty
rates. The table shows that states like California, Texas, and Florida
have demographic profiles similar to those of current high-revenue
states, suggesting substantial untapped market potential if legalization
were pursued.</em></p>
</div>
<div id="visualizing-predictions" class="section level2">
<h2>Visualizing Predictions</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>pred_illegal_lasso_plot <span class="ot">&lt;-</span> pred_illegal_lasso <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">State =</span> <span class="fu">factor</span>(State, <span class="at">levels =</span> State)) <span class="co"># Maintain sorted order</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="fu">ggplot</span>(pred_illegal_lasso_plot, <span class="fu">aes</span>(<span class="at">x =</span> State, <span class="at">y =</span> predicted_revenue_lasso)) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Predicted Annual Gambling Revenue (if legalized)&quot;</span>,</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;LASSO model predictions for states without legal sports gambling&quot;</span>,</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Predicted Revenue&quot;</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="analysis_files/figure-html/visualizing-predictions-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>This bar chart visualizes predicted gambling revenue for each
non-legal state, ranked from highest to lowest. Large states with urban
populations and strong young-adult demographics (such as California,
Texas, and Florida) show the highest predicted revenue, reinforcing the
idea that demographic scale influences potential market size. Smaller or
more rural states are projected to generate minimal revenue.</em></p>
</div>
<div id="distribution-of-predictions" class="section level2">
<h2>Distribution of Predictions</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>compare_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Actual Revenue (Legal States)&quot;</span>, <span class="fu">nrow</span>(training_data)),</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="st">&quot;Predicted Revenue (Non-Legal States)&quot;</span>, <span class="fu">nrow</span>(pred_illegal_lasso))),</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="at">revenue =</span> <span class="fu">c</span>(training_data<span class="sc">$</span>Revenue,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>              pred_illegal_lasso<span class="sc">$</span>predicted_revenue_lasso)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">ggplot</span>(compare_df, <span class="fu">aes</span>(<span class="at">x =</span> revenue, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Distribution of Actual vs Predicted Gambling Revenue&quot;</span>,</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>    <span class="co"># Set the x-axis title </span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Revenue&quot;</span>,</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="analysis_files/figure-html/distribution-predictions-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>This density plot compares the distribution of observed gambling
revenue in legalized states with the predicted revenue for non-legal
states. The predicted values span a wider range, with some states
projecting higher revenue than current legal markets. This suggests that
expansion into a few large states could dramatically reshape the
national gambling landscape.</em></p>
</div>
<div id="population-vs-revenue-comparison" class="section level2">
<h2>Population vs Revenue Comparison</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>scatter_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  training_data <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">&quot;Actual Revenue&quot;</span>),</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  pred_illegal_lasso <span class="sc">|&gt;</span> </span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Revenue =</span> predicted_revenue_lasso,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">&quot;Predicted Revenue&quot;</span>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="fu">ggplot</span>(scatter_df, <span class="fu">aes</span>(<span class="at">x =</span> total_pop, <span class="at">y =</span> Revenue, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Population vs Gambling Revenue&quot;</span>,</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Comparing actual and predicted states&quot;</span>,</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Total Population&quot;</span>,</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Revenue&quot;</span>,</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="analysis_files/figure-html/population-revenue-comparison-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>Here we compare how population relates to revenue in both actual
and predicted markets. Larger states show higher revenue but the plot
also shows that population alone does not fully explain gambling
revenue.</em></p>
</div>
<div id="distribution-statistics" class="section level2">
<h2>Distribution Statistics</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">&quot;Min&quot;</span>, <span class="st">&quot;1st Quartile&quot;</span>, <span class="st">&quot;Median&quot;</span>, <span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;3rd Quartile&quot;</span>, <span class="st">&quot;Max&quot;</span>),</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="at">Actual_Revenue =</span> <span class="fu">summary</span>(training_data<span class="sc">$</span>Revenue)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)],</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="at">Predicted_Revenue =</span> <span class="fu">summary</span>(pred_illegal_lasso<span class="sc">$</span>predicted_revenue_lasso)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="fu">kable</span>(summary_table, <span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Distribution Comparison: Actual vs Predicted Revenue&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>))</span></code></pre></div>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Distribution Comparison: Actual vs Predicted Revenue
</caption>
<thead>
<tr>
<th style="text-align:left;">
Metric
</th>
<th style="text-align:right;">
Actual_Revenue
</th>
<th style="text-align:right;">
Predicted_Revenue
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Min
</td>
<td style="text-align:right;">
920918
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
1st Quartile
</td>
<td style="text-align:right;">
60627294
</td>
<td style="text-align:right;">
61324867
</td>
</tr>
<tr>
<td style="text-align:left;">
Median
</td>
<td style="text-align:right;">
427397087
</td>
<td style="text-align:right;">
201795708
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean
</td>
<td style="text-align:right;">
443822044
</td>
<td style="text-align:right;">
627940272
</td>
</tr>
<tr>
<td style="text-align:left;">
3rd Quartile
</td>
<td style="text-align:right;">
599344939
</td>
<td style="text-align:right;">
471813698
</td>
</tr>
<tr>
<td style="text-align:left;">
Max
</td>
<td style="text-align:right;">
2059297238
</td>
<td style="text-align:right;">
3611645904
</td>
</tr>
</tbody>
</table>
<p><em>This table summarizes the distribution of actual versus predicted
revenue using key statistics (min, median, mean, and quartiles). The
predicted values show a higher mean and larger upper tail, reflecting
how several non-legal states exceed the revenue observed in legalized
states.</em></p>
</div>
</div>
<div id="model-diagnostics" class="section level1 tabset">
<h1 class="tabset">Model Diagnostics</h1>
<div id="lasso-cross-validation" class="section level2">
<h2>LASSO Cross-Validation</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">plot</span>(lasso_cv)</span></code></pre></div>
<p><img src="analysis_files/figure-html/lasso-cv-plot-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>This figure shows the LASSO modelâ€™s cross-validation process.
Each point represents the modelâ€™s prediction error at a given penalty
value (lambda). The selected Î» minimizes mean-squared error, balancing
model simplicity and predictive accuracy. The curve illustrates how
adding too many predictors increases variance, while stronger
penalization improves stability.</em></p>
</div>
<div id="actual-vs-predicted" class="section level2">
<h2>Actual vs Predicted</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>pred_lasso_train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(lasso_model, <span class="at">newx =</span> X_train))</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>training_data_lasso <span class="ot">&lt;-</span> training_data <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred_lasso =</span> pred_lasso_train)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="fu">ggplot</span>(training_data_lasso, <span class="fu">aes</span>(<span class="at">x =</span> Revenue, <span class="at">y =</span> pred_lasso)) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Actual vs Predicted Revenue (LASSO)&quot;</span>,</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Actual Revenue&quot;</span>,</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Predicted Revenue&quot;</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="analysis_files/figure-html/actual-vs-predicted-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>This scatterplot compares predicted revenue to actual revenue in
legalized states. The points generally follow an upward trend,
indicating strong model performance.</em></p>
</div>
<div id="correlation-map" class="section level2">
<h2>Correlation Map</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>predictor_mat <span class="ot">&lt;-</span> training_data <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">select</span>(total_pop, median_income, pct_bachelors, pct_age_20_34,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>         pct_urban, pct_poverty) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>corr_mat <span class="ot">&lt;-</span> <span class="fu">cor</span>(predictor_mat)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="fu">corrplot</span>(</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  corr_mat,</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;color&quot;</span>,</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;upper&quot;</span>,</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">200</span>),</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>  <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Predictor Correlations&quot;</span>,</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>  <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="analysis_files/figure-html/correlation-map-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>This heatmap displays correlations among demographic predictors
used in the modeling process. Strong correlations across income,
education, population size, and poverty show multicollinearity.</em></p>
</div>
<div id="predictor-relationships" class="section level2">
<h2>Predictor Relationships</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> training_data <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">select</span>(Revenue, total_pop, median_income, pct_bachelors,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>         pct_age_20_34, pct_urban, pct_poverty) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Revenue, <span class="at">names_to =</span> <span class="st">&quot;predictor&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> Revenue)) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> predictor, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Revenue vs Key Demographic Predictors (Legal States)&quot;</span>,</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>    <span class="co"># Set x to NULL so the facet titles serve as the x-axis labels</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>, </span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Revenue&quot;</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="analysis_files/figure-html/predictor-relationships-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><em>These scatterplots show the relationship between individual
demographic predictors and observed gambling revenue. While population
and urbanization show clearer positive associations, other variables,
such as poverty or median income, exhibit weak or inconsistent
relationships. This reinforces the idea that gambling revenue is driven
by a combination of demographic scale and specific high-engagement age
groups rather than socioeconomic factors alone.</em></p>
</div>
<div id="feature-importance" class="section level2">
<h2>Feature Importance</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>coef_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">coef</span>(lasso_cv, <span class="at">s =</span> <span class="st">&quot;lambda.min&quot;</span>))</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>coef_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">rownames</span>(coef_mat),</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="at">coefficient =</span> coef_mat[, <span class="st">&quot;lambda.min&quot;</span>]</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(coefficient)))</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="fu">ggplot</span>(coef_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable, <span class="fu">abs</span>(coefficient)), </span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>                    <span class="at">y =</span> coefficient, </span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>                    <span class="at">fill =</span> coefficient <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;#1b9e77&quot;</span>, <span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;#d95f02&quot;</span>), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;LASSO Coefficients at Î»_min&quot;</span>,</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Positive (Green) vs Negative (Orange) Impact&quot;</span>,</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Coefficient Estimate&quot;</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>)</span></code></pre></div>
<p><img src="analysis_files/figure-html/feature-importance-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="model-performance" class="section level2">
<h2>Model Performance</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># --- Linear Model Predictions ---</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_lm)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co"># --- LASSO Predictions ---</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>lasso_pred <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(lasso_model, <span class="at">newx =</span> X_train))</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co"># --- True values ---</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>y_true <span class="ot">&lt;-</span> training_data<span class="sc">$</span>Revenue</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co"># --- Comparison Metrics ---</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>model_metrics <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;Linear Model&quot;</span>, <span class="st">&quot;LASSO Model&quot;</span>),</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>  <span class="at">RMSE  =</span> <span class="fu">c</span>(<span class="fu">rmse</span>(y_true, lm_pred),</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>            <span class="fu">rmse</span>(y_true, lasso_pred)),</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>  <span class="at">MAE   =</span> <span class="fu">c</span>(<span class="fu">mae</span>(y_true, lm_pred),</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>            <span class="fu">mae</span>(y_true, lasso_pred)),</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>  <span class="at">MAPE  =</span> <span class="fu">c</span>(<span class="fu">mape</span>(y_true, lm_pred),</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>            <span class="fu">mape</span>(y_true, lasso_pred))</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>)</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>model_metrics <span class="sc">%&gt;%</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>    <span class="at">RMSE =</span> scales<span class="sc">::</span><span class="fu">dollar</span>(RMSE),</span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>    <span class="at">MAE  =</span> scales<span class="sc">::</span><span class="fu">dollar</span>(MAE),</span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a>    <span class="at">MAPE =</span> scales<span class="sc">::</span><span class="fu">percent</span>(MAPE)</span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Model Performance Comparison: Linear Model vs LASSO&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>))</span></code></pre></div>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Model Performance Comparison: Linear Model vs LASSO
</caption>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
RMSE
</th>
<th style="text-align:left;">
MAE
</th>
<th style="text-align:left;">
MAPE
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Linear Model
</td>
<td style="text-align:left;">
$200,127,907
</td>
<td style="text-align:left;">
$133,430,779
</td>
<td style="text-align:left;">
344%
</td>
</tr>
<tr>
<td style="text-align:left;">
LASSO Model
</td>
<td style="text-align:left;">
$202,606,893
</td>
<td style="text-align:left;">
$132,201,269
</td>
<td style="text-align:left;">
191%
</td>
</tr>
</tbody>
</table>
<p><em>This table compares model performance metrics across the linear
regression and LASSO model. LASSO performs similarly in RMSE but
substantially better in MAPE, indicating higher stability for
lower-revenue states. The comparison highlights the value of
penalization when predictors show strong collinearity.</em></p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>We compared a standard linear regression to a LASSO regularized
model. Both models have sizeable error due to the extreme variability in
state gambling revenues. While the linear model slightly outperforms
LASSO in RMSE, the LASSO model achieves a much better MAPE (191% vs
344%), indicating more stable performance for low-revenue states.</p>
<p>LASSO also provides valuable model simplification: only two
predictors retain nonzero coefficientsâ€”pct_age_20_34 and pct_urban,
while income, population, poverty, and education are shrunk to zero.
This suggests strong multicollinearity among socioeconomic indicators,
with LASSO consolidating their predictive signal into a smaller set of
variables. The results highlight that demographic structure
(pct_age_20_34) and urbanization are the strongest predictors of sports
gambling markets.</p>
</div>

<footer class="site-footer">
  <div class="footer-content">
    
    <p class="footer-team">
      Team: Zakari, Kimia, Lawrence & Sukhman
    </p>
    
    <p class="footer-links">
      <a href="https://github.com/zakbillo/sports-betting" target="_blank">
        <i class="fa fa-github fa-lg"></i> View Our Source Code
      </a>
    </p>
    
    <p class="footer-quote">
      "The house always wins... usually."
    </p>
    
    <div class="footer-copyright">
      2025 Data Science I (P8105) Final Project
    </div>

  </div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
